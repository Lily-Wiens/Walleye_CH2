library(vegan)
# An R script to analyze a panel of metabolites using linear models
library(tidyverse)
library(sjstats)
library(performance)
library(forestmodel)
library(emmeans)
library(pwr)
library(ggplot2)
#### Chapter 2 Walleye RDA ####
# Setting the document directory
# loading set of data
setwd("C:/Users/user/Desktop/Chapter 2 Analysis") 
Data_2018 <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/2018_MET_FM.csv", quote="")
   View(Data_2018) 
Factors18 <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Factors18.csv", quote="")
View(Factors18)
dim(Factors18)
Factors18T <- decostand(Factors18[,2:7], "normalize")
# factors only FL, , W,SEX, Age
FactorsT4 <- Factors18T[,c(2,3,5,6)]
Metabolites18 <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Metabolites18.csv", quote="")
View(Metabolites18) 
Metabolites18T <- decostand(Metabolites18[,2:164], "normalize")
# factors FL SEX AGE SITE
# read factors
Factors <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Factors_site.csv", quote="")
# rename
Factors4 <- Factors
Factors4 <- Factors[,c(1,2,4,5)]
head(Factors4)

# normalize
Factors4_transformed <- decostand(Factors4[,c(2,4)], "normalize")

dim(Factors18)
library(vegan)



#### Correspondence analysis trying the second time ####
met.ca1 <- cca(Metabolites18T)
met.ca1
 # Call: cca(X = Metabolites18T)
# 
# Inertia Rank
# Total          0.1571     
# Unconstrained  0.1571   53
# Inertia is scaled Chi-square 
# 
# Eigenvalues for unconstrained axes:
#   CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8 
# 0.04578 0.02777 0.01092 0.01034 0.00822 0.00733 0.00601 0.00546 
# (Showing 8 of 53 unconstrained eigenvalues)
plot(met.ca1)
chisq.test(Metabolites18T/sum(Metabolites18T))
# Pearson's Chi-squared test
# 
# data:  Metabolites18T/sum(Metabolites18T)
# X-squared = 0.1571, df = 8586, p-value = 1
summary(met.ca1)
# Call:
#   cca(X = Metabolites18T) 
# 
# Partitioning of scaled Chi-square:
#   Inertia Proportion
# Total          0.1571          1
# Unconstrained  0.1571          1
# 
# Eigenvalues, and their contribution to the scaled Chi-square 
# 
# Importance of components:
#   CA1     CA2     CA3     CA4      CA5      CA6      CA7
# Eigenvalue            0.04578 0.02777 0.01092 0.01034 0.008223 0.007328 0.006014
# Proportion Explained  0.29139 0.17673 0.06952 0.06582 0.052340 0.046642 0.038278
# Cumulative Proportion 0.29139 0.46812 0.53764 0.60346 0.655796 0.702438 0.740717
# CA8      CA9     CA10     CA11    CA12     CA13     CA14
# Eigenvalue            0.005458 0.004943 0.004126 0.004021 0.00315 0.002298 0.002144
# Proportion Explained  0.034739 0.031466 0.026260 0.025594 0.02005 0.014629 0.013646
# Cumulative Proportion 0.775456 0.806922 0.833182 0.858776 0.87883 0.893457 0.907103
# CA15     CA16     CA17     CA18     CA19     CA20
# Eigenvalue            0.001617 0.001456 0.001302 0.001191 0.001090 0.000828
# Proportion Explained  0.010292 0.009269 0.008291 0.007584 0.006938 0.005271
# Cumulative Proportion 0.917395 0.926665 0.934955 0.942539 0.949477 0.954747
# CA21      CA22      CA23      CA24      CA25      CA26
# Eigenvalue            0.0007905 0.0007545 0.0006316 0.0005854 0.0004745 0.0004507
# Proportion Explained  0.0050315 0.0048029 0.0040200 0.0037260 0.0030204 0.0028690
# Cumulative Proportion 0.9597790 0.9645818 0.9686018 0.9723278 0.9753482 0.9782172
# CA27      CA28      CA29      CA30      CA31      CA32
# Eigenvalue            0.0004097 0.0003756 0.0003384 0.0002706 0.0002373 0.0002038
# Proportion Explained  0.0026078 0.0023908 0.0021538 0.0017222 0.0015102 0.0012974
# Cumulative Proportion 0.9808250 0.9832158 0.9853696 0.9870918 0.9886020 0.9898994
# CA33      CA34      CA35      CA36      CA37      CA38
# Eigenvalue            0.0001838 0.0001732 0.0001598 0.0001262 0.0001053 0.0001006
# Proportion Explained  0.0011698 0.0011025 0.0010169 0.0008035 0.0006703 0.0006403
# Cumulative Proportion 0.9910692 0.9921717 0.9931886 0.9939921 0.9946624 0.9953026
# CA39      CA40      CA41      CA42      CA43      CA44
# Eigenvalue            0.0000962 9.046e-05 8.176e-05 7.939e-05 6.605e-05 5.677e-05
# Proportion Explained  0.0006123 5.758e-04 5.204e-04 5.053e-04 4.204e-04 3.614e-04
# Cumulative Proportion 0.9959150 9.965e-01 9.970e-01 9.975e-01 9.979e-01 9.983e-01
# CA45      CA46      CA47      CA48      CA49      CA50
# Eigenvalue            5.357e-05 4.605e-05 3.573e-05 0.0000316 2.891e-05 2.589e-05
# Proportion Explained  3.410e-04 2.931e-04 2.274e-04 0.0002012 1.840e-04 1.648e-04
# Cumulative Proportion 9.986e-01 9.989e-01 9.992e-01 0.9993610 9.995e-01 9.997e-01
# CA51      CA52      CA53
# Eigenvalue            1.793e-05 1.536e-05 1.229e-05
# Proportion Explained  1.141e-04 9.779e-05 7.825e-05
# Cumulative Proportion 9.998e-01 9.999e-01 1.000e+00
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# 
# 
# Species scores
# 
#                             CA1       CA2       CA3        CA4        CA5
# Serine                       0.0967397  0.052393  0.310439 -0.1742606 -0.0238522
# Putrescine                   0.0355548  0.219836  0.002091  0.0935224 -0.0709961
# Trans_Hydroxyproline         0.0292712  0.821531 -0.253126  0.3001469  0.4789198
# Asparagine                   0.0999309  0.911633 -0.251545  0.3630591  0.5980611
# Glutamine                    0.2557184  0.225763  0.339926 -0.0941769  0.1414952
# Alpha_Aminoadipic_Acid       0.0947599  0.281518  0.242143  0.0063124  0.1101060
# Methionine_Sulfoxide         0.0932774  0.086334  0.254346 -0.0744599  0.0888317
# Acetyl_Ornithine             0.0199430  0.159427 -0.071286 -0.1519220  0.0508791
# Citrulline                  -0.2109760 -0.717876 -1.038218 -0.5692277  0.2258002
# Asymmetric_Dimethylarginine  0.0767200  0.396426  0.107575  0.0317355  0.0544738
# Total_Dimethylarginine      -0.0182678  0.343961  0.147355 -0.0396172  0.0318361
# Tryptophan                   0.0028466  0.317961 -0.007405 -0.0581741  0.1231360
# Kynurenine                   0.6087974  0.414672  0.185314  0.0787062  0.4248685
# Ornithine                    0.3538278 -0.044441  0.877233 -0.2998724 -0.0150891
# Lysine                       0.2173980 -0.085923  0.888930 -0.2477217  0.0241870
# Spermidine                  -0.0021507  0.313293 -0.033591  0.1165477 -0.0036568
# Spermine                    -0.0575992  0.122737 -0.050066 -0.0040732 -0.0157431
# Sarcosine                    0.1205318  0.065225  0.442490 -0.2493164  0.0204687
# Methylhistidine             -0.0798349 -0.065782  0.301815 -0.2176487 -0.3845827
# Beta_Hydroxybutyric_Acid    -0.4798924  0.585949 -0.007488 -0.3149998 -0.0535343
# Alpha_Ketoglutaric_Acid     -0.0383129  0.028286  0.032591 -0.0872876 -0.0391121
# Butyric_acid                -0.1089342  0.160332 -0.056226  0.0113675 -0.1043304
# Propionic_Acid              -0.0081444 -0.041551  0.001626 -0.0202864 -0.1565747
# Fumaric_Acid                -0.0414061  0.066648  0.063765 -0.1125514  0.0486518
# Isobutyric_Acid             -0.1708913  0.340440 -0.125323  0.0809999  0.0113691
# Hippuric_Acid               -0.1314879  0.024525 -0.100576  0.1049937 -0.0569860
# Methylmalonic_Acid           0.1050491  0.184443 -0.088223  0.0403050  0.0606597
# LYSOC14_0                   -0.0074613 -0.044965 -0.128546 -0.1771007 -0.0517803
# LYSOC16_1                    0.0018353 -0.058724 -0.223682 -0.2553383  0.0169626
# LYSOC16_0                   -0.0187546 -0.142453 -0.236051 -0.2489686 -0.0217094
# LYSOC17_0                    0.0269897 -0.082345 -0.201225 -0.2173857 -0.0326166
# LYSOC18_2                    0.0223572  0.077917 -0.075046 -0.1595200 -0.0651090
# LYSOC18_1                    0.0029783  0.064556 -0.038435 -0.1571500 -0.0272365
# LYSOC18_0                    0.0353130  0.055635  0.061922 -0.1197939 -0.0422366
# LYSOC20_4                    0.0067221  0.303604 -0.132443  0.0081644  0.0338068
# LYSOC20_3                   -0.0212917 -0.029759 -0.016703 -0.0643134 -0.0563293
# LYSOC24_0                   -0.0401468 -0.048576 -0.048113 -0.1277884 -0.0870762
# LYSOC26_1                   -0.0179203  0.016179 -0.054483 -0.0908808 -0.0821978
# LYSOC26_0                   -0.0195184 -0.056942 -0.060267 -0.1243058 -0.0836519
# LYSOC28_1                   -0.0326616  0.030455 -0.072135 -0.0888131 -0.0574251
# LYSOC28_0                   -0.0199498 -0.002411 -0.049106 -0.0790318 -0.0948913
# X14_1SMOH                   -0.0406517  0.063527 -0.171576 -0.0847918 -0.0573518
# X16_1SM                     -0.0955737  0.252670 -0.168151 -0.0512190 -0.0568535
# X16_0SM                     -0.0865797  0.206323 -0.178117 -0.0238539 -0.0123428
# X16_1SMOH                   -0.0546913  0.099486 -0.285984  0.0107623  0.0713526
# X18_1SM                      0.0370178  0.086206  0.006207 -0.1343408 -0.0127025
# PC32_2AA                     0.0840715 -0.048894  0.057307 -0.2166701 -0.0268436
# X18_0SM                      0.0523993 -0.029384  0.081570 -0.2039045 -0.0234750
# X20_2SM                      0.1002662  0.042339  0.037919 -0.1585903 -0.0428589
# PC36_0AE                    -0.0266221  0.145048 -0.198208 -0.0385988  0.0419231
# PC36_6AA                     0.0935358  0.037380 -0.130846 -0.1539228 -0.0350927
# PC36_0AA                     0.0093210  0.177096 -0.303310  0.0652857  0.1087532
# X22_2SMOH                   -0.0695341  0.213810 -0.230900 -0.0849083  0.0111696
# X22_1SMOH                   -0.0226260  0.147669 -0.151456 -0.1039383 -0.0058848
# PC38_6AA                     0.0488183  0.039047 -0.111254 -0.1239078 -0.0495034
# PC38_0AA                     0.0086432  0.200546 -0.225791 -0.0803935 -0.0146485
# PC40_6AE                     0.0526025  0.091163 -0.115877 -0.1185980 -0.0466883
# X24_1SMOH                    0.0154857  0.031430 -0.113512 -0.1622518 -0.0331475
# PC40_6AA                     0.0710760  0.121761  0.109666 -0.0854635 -0.0989434
# PC40_2AA                    -0.0087928  0.049449 -0.108160 -0.1025525 -0.0539336
# PC401AA                     -0.0008724  0.046705 -0.054158 -0.1263876 -0.0693264
# C2                           0.0054270  0.187238 -0.044226 -0.1231256 -0.1760318
# C3_1                        -0.1059793  0.223623 -0.103215 -0.0774286 -0.0618078
# C3                           0.0117768  0.362768 -0.128347  0.0426322  0.1225573
# C4_1                         0.0107771  0.136903 -0.141198 -0.0282531 -0.0369259
# C4                          -0.1557016  0.526390 -0.160291 -0.0781036  0.0522192
# C3OH                         0.0383689  0.007712 -0.070423 -0.0798884 -0.0490983
# C5_1                        -0.0633108  0.111569 -0.009586 -0.0120799 -0.0140747
# C5                           0.0361263  0.591781 -0.154034  0.1896819  0.1698315
# C4OH                        -0.3574034  0.537918 -0.113946 -0.1455239 -0.2325473
# C6_1                        -0.1112617  0.025442 -0.145442 -0.0793933 -0.0413488
# C6                          -0.1253754  0.103800 -0.068897 -0.1344606 -0.0887081
# C5OH                         0.0206988  0.087395  0.035918 -0.1183036 -0.0760154
# C5_1DC                      -0.0865466  0.170487 -0.085614 -0.0708011 -0.0392053
# C5DC                        -0.0669154  0.201398 -0.053664 -0.0828737 -0.1174857
# C8                          -0.1139229  0.167223 -0.027300 -0.2371788 -0.0953430
# C5MDC                       -0.0941407 -0.017046 -0.007175 -0.1062055 -0.0485593
# C9                          -0.1352370  0.094202 -0.007980 -0.1917942 -0.0789348
# C7DC                         0.1788297 -0.103315 -0.186936 -0.3021697 -0.0137700
# C10_2                       -0.1403415 -0.008303 -0.007241 -0.2037372 -0.1244394
# C10_1                       -0.0813417 -0.003937 -0.059746 -0.0722226 -0.0753711
# C10                         -0.0930244 -0.018762 -0.016311 -0.0987171 -0.0597965
# C12_1                       -0.1573481  0.147302 -0.072394 -0.1691642 -0.1278484
# C12                         -0.2034539  0.110581 -0.023332 -0.2627645 -0.0894248
# C14_2                       -0.1399352  0.090538 -0.082755 -0.2406783 -0.0625101
# C14_1                       -0.2270431  0.312403 -0.020225 -0.3414756 -0.1347839
# C14                         -0.4157375  0.450636 -0.056505 -0.5210841 -0.1660660
# C12DC                       -0.1421641 -0.006585  0.037261 -0.2421260 -0.0852688
# C14_2OH                     -0.2500180  0.167146  0.017709 -0.4184017 -0.1327360
# C14_1OH                     -0.4092106  0.395244 -0.113142 -0.5151642 -0.1430270
# C16_2                       -0.1681770  0.095381  0.045475 -0.3018523 -0.1146599
# C16_1                       -0.3234350  0.245226  0.022508 -0.5211530 -0.1626252
# C16                         -0.3488071  0.279475 -0.151384 -0.4709894 -0.1823736
# C16_2OH                     -0.2855011  0.253252 -0.118392 -0.4381377 -0.1490915
# C16_1OH                     -0.2713497  0.268296 -0.159890 -0.4405951 -0.1236167
# C16OH                       -0.2822576  0.249918 -0.026516 -0.2940852 -0.1334501
# C18_2                       -0.2672744  0.272280  0.034838 -0.4474319 -0.1500420
# C18_1                       -0.3107635  0.257780 -0.054099 -0.5032186 -0.1747627
# C18                         -0.2532126  0.155036 -0.129245 -0.4199365 -0.1160311
# C18_1OH                     -0.2517560  0.185857 -0.075995 -0.3226257 -0.1138546
# Arginine_Average             0.1568754 -0.021583  0.420273 -0.1327441 -0.0336527
# Betaine_Average             -0.0676446 -0.165437 -0.110054 -0.2787666  0.0310524
# C0_Average                  -0.0873159  0.128873  0.038418 -0.1821680 -0.1147841
# Choline_Average              0.1217307 -0.118644  0.085998 -0.2767183 -0.0075324
# Citrate_Average             -0.2024656  0.497904 -0.092776 -0.0232392  0.0671561
# Creatine_Average            -0.1757658  0.437257 -0.203294 -0.0972860 -0.0398647
# Creatinine_Average          -0.0953563  0.397150 -0.138483  0.0009956 -0.1269990
# Glucose_Average              0.3343673 -0.081364 -0.014949  0.0389447  0.0173714
# Glutamate_Average            0.0348477  0.106124  0.147557 -0.0877140  0.0358506
# Glycine_Average              0.0315007  0.136669  0.172753 -0.1397785 -0.0045028
# Histidine_Average            0.1016775  0.138842  0.055939 -0.0749883  0.0112120
# Isoleucine_Average          -0.0087854  0.454108  0.092655 -0.0379969  0.2311044
# Lactate_Average             -0.0033442  0.130660 -0.031810 -0.0168418 -0.0334421
# Leucine                     -0.0060658  0.292626  0.380296 -0.1112766  0.2138981
# Methionine                   0.0710413  0.174916  0.302424 -0.0626341  0.0732833
# Phenylalanine_Average        0.0889674  0.160733  0.194871 -0.0981049  0.0567922
# Proline                      0.0472704  0.455987  0.065177  0.1299695  0.2398243
# Pyruvate_Average             0.0264805  0.011097  0.210912 -0.1351791 -0.1364083
# Succinate_Average           -0.0412117 -0.013269  0.061413 -0.2152823  0.0376627
# Threonine_Average            0.1220927  0.199716  0.171598 -0.0305382 -0.0681990
# Tyrosine_Average             0.0231114  0.347770  0.245896 -0.1564289  0.1782514
# Valine_Average              -0.0095755  0.452741  0.065345 -0.0122976  0.2246356
# X1_Methylhistidine          -0.0529640 -0.064522 -0.017599 -0.0972712 -0.0209940
# X2_Hydroxybutyrate          -0.2672270  0.393948 -0.104210  0.0866480  0.1580543
# X2_Hydroxyisovaleric_Acid   -0.4422151 -0.081194 -0.272557 -0.2389726  0.0008258
# X3_Hydroxybutyrate          -0.5046745  0.586411  0.018971 -0.3403244 -0.0927312
# ADP                         -0.2382300 -0.717456 -0.101233 -0.3164175  0.1553537
# AMP                         -0.0706162 -0.096270 -0.052476  0.0141815 -0.1067193
# ATP                         -0.8613712 -1.565173 -0.870645 -0.8065292 -0.0474034
# Acetamide                   -0.1465171 -0.390425  0.006286 -0.1684641 -0.1198180
# Acetate                     -0.2270746  0.024467 -0.017687 -0.0552361 -0.0130908
# Acetoacetate                -0.1666249  0.481331 -0.101629  0.1659198 -0.3606366
# Acetone                     -0.3558293  0.165344 -0.024081 -0.1374558 -0.1063124
# Adenosine                   -0.2825323 -0.127054  0.118244 -0.3312537  0.0737505
# Alanine                     -0.0339360 -0.023707  0.110574  0.0212542 -0.0006298
# Aspartate                   -0.1914458  0.245325  0.057960  0.2411616 -0.0786833
# Creatine_Phosphate          -0.0722473 -0.261203  0.059907 -0.0463534 -0.1080127
# Cytidine                    -0.1450667 -0.043079  0.083953  0.1117065 -0.0713363
# Dimethyl_Sulfone            -0.1633071  0.061025 -0.101226  0.0749815 -0.0488091
# Ethanol                     -0.0716642 -0.154607 -0.053758  0.0861724  0.0109267
# Ethanolamine                -0.1837139 -0.427485 -0.073083 -0.2133579 -0.0132057
# Formate                     -0.0998463 -0.105058 -0.018490  0.0458757 -0.0426797
# Glycerol                    -0.1807028 -0.116559  0.096522 -0.2184035  0.3647071
# Guanidoacetate              -0.1011321 -0.159106 -0.003337 -0.0831628 -0.0937983
# Guanosine                   -0.1871849 -0.265568  0.107372 -0.2461574  0.2697406
# Hypoxanthine                -0.1648275 -0.199743 -0.007222 -0.1633950  0.0010624
# IMP                         -0.1597708  0.266275  0.086809  0.1747709 -0.1248725
# Inosine                     -0.1864196  0.136312 -0.136304  0.4748573  0.0160314
# Isopropanol                 -0.0943459 -0.195784 -0.006160 -0.0875685 -0.0168428
# Malate                      -0.3783052  0.066144  0.216368 -0.0764244 -0.0569917
# Malonate                    -0.1942528 -0.007025 -0.068190 -0.0176107 -0.0189792
# Mannose                      0.0516807  0.075926  0.180114  0.1273173 -0.1191539
# Methanol                    -0.0422188  0.011699  0.037496  0.0023504 -0.0880462
# N_N_Dimethylglycine         -0.1274056 -0.128897  0.089910 -0.0577205 -0.0418494
# Nicotinurate                -0.1607213  0.005015  0.017732 -0.0491504  0.0412913
# O_Acetylcarnitine           -0.0323738  0.194556 -0.040822 -0.1003281 -0.1912831
# O_Phosphocholine            -0.1271803 -0.044784  0.016264  0.0595103 -0.0154944
# Propylene_Glycol            -0.4040264  0.432130 -0.136886  0.0533186 -0.1599446
# Taurine                     -0.2311127 -0.103943  0.019635  0.0702416  0.0186655
# Uridine                     -0.1139183  0.107263  0.103695  0.0519843 -0.0209091
# Xanthine                    -0.3913160 -0.124395  0.047750  0.3060578 -0.1407489
# sn_Glycero_3_Phosphocholine -0.0195312 -0.379492  0.149284 -0.2272321  0.0892750
# Beta.Alanine                -0.0853987 -0.137332  0.097278 -0.0421506 -0.5962855
# CA6
# Serine                       0.0283725
# Putrescine                  -0.0493131
# Trans_Hydroxyproline         0.4582814
# Asparagine                   0.5066311
# Glutamine                    0.2029024
# Alpha_Aminoadipic_Acid       0.1407706
# Methionine_Sulfoxide         0.0237584
# Acetyl_Ornithine             0.0882621
# Citrulline                   0.1577116
# Asymmetric_Dimethylarginine  0.0370091
# Total_Dimethylarginine       0.0253530
# Tryptophan                   0.1216815
# Kynurenine                   0.2687605
# Ornithine                    0.0235091
# Lysine                      -0.0638154
# Spermidine                  -0.0029372
# Spermine                     0.0010733
# Sarcosine                    0.2298390
# Methylhistidine             -0.2775958
# Beta_Hydroxybutyric_Acid    -0.0827769
# Alpha_Ketoglutaric_Acid      0.0334916
# Butyric_acid                 0.0111835
# Propionic_Acid              -0.0213227
# Fumaric_Acid                 0.0318155
# Isobutyric_Acid              0.1312071
# Hippuric_Acid                0.0263543
# Methylmalonic_Acid           0.0112958
# LYSOC14_0                   -0.0031589
# LYSOC16_1                    0.0697097
# LYSOC16_0                    0.0599942
# LYSOC17_0                    0.0082977
# LYSOC18_2                   -0.0102263
# LYSOC18_1                    0.0086800
# LYSOC18_0                    0.0164442
# LYSOC20_4                    0.0689246
# LYSOC20_3                   -0.0223116
# LYSOC24_0                   -0.0594755
# LYSOC26_1                   -0.0581654
# LYSOC26_0                   -0.0490686
# LYSOC28_1                   -0.0362213
# LYSOC28_0                   -0.0615932
# X14_1SMOH                   -0.0096912
# X16_1SM                      0.0650772
# X16_0SM                      0.0563372
# X16_1SMOH                    0.0621652
# X18_1SM                      0.0211357
# PC32_2AA                    -0.0348941
# X18_0SM                      0.0025179
# X20_2SM                     -0.0523036
# PC36_0AE                     0.0486932
# PC36_6AA                    -0.0278463
# PC36_0AA                     0.0858687
# X22_2SMOH                    0.0159120
# X22_1SMOH                   -0.0020914
# PC38_6AA                    -0.0344058
# PC38_0AA                    -0.0008580
# PC40_6AE                    -0.0518394
# X24_1SMOH                   -0.0933728
# PC40_6AA                    -0.0499515
# PC40_2AA                    -0.0520374
# PC401AA                     -0.0658555
# C2                          -0.1738711
# C3_1                        -0.1857372
# C3                           0.0375479
# C4_1                         0.0129720
# C4                           0.0337955
# C3OH                         0.0333124
# C5_1                        -0.0236248
# C5                           0.1089313
# C4OH                        -0.0768138
# C6_1                        -0.0008066
# C6                          -0.0446868
# C5OH                        -0.0456723
# C5_1DC                       0.0484439
# C5DC                        -0.0771717
# C8                          -0.0657856
# C5MDC                       -0.0031926
# C9                          -0.0380382
# C7DC                        -0.0269051
# C10_2                       -0.0749819
# C10_1                        0.0338339
# C10                          0.0198626
# C12_1                        0.0315200
# C12                         -0.0108133
# C14_2                       -0.0471050
# C14_1                       -0.0403687
# C14                         -0.0915415
# C12DC                       -0.0320293
# C14_2OH                     -0.0640988
# C14_1OH                     -0.0788363
# C16_2                       -0.0084524
# C16_1                       -0.0497068
# C16                         -0.1363996
# C16_2OH                     -0.0886735
# C16_1OH                     -0.0915071
# C16OH                       -0.0782736
# C18_2                       -0.0757601
# C18_1                       -0.1301206
# C18                         -0.1134798
# C18_1OH                     -0.0908092
# Arginine_Average            -0.1020695
# Betaine_Average              0.0785667
# C0_Average                  -0.1200088
# Choline_Average             -0.0178996
# Citrate_Average              0.1408802
# Creatine_Average            -0.3394160
# Creatinine_Average          -0.1983562
# Glucose_Average             -0.0134571
# Glutamate_Average            0.1173926
# Glycine_Average              0.0319026
# Histidine_Average           -0.0582765
# Isoleucine_Average           0.1532755
# Lactate_Average              0.0362085
# Leucine                      0.0110293
# Methionine                   0.0501501
# Phenylalanine_Average        0.1334346
# Proline                      0.2286319
# Pyruvate_Average            -0.0990285
# Succinate_Average            0.0365327
# Threonine_Average           -0.0321928
# Tyrosine_Average             0.2483495
# Valine_Average               0.2006529
# X1_Methylhistidine          -0.0469937
# X2_Hydroxybutyrate           0.3123887
# X2_Hydroxyisovaleric_Acid    0.4426370
# X3_Hydroxybutyrate          -0.1005129
# ADP                          0.0899881
# AMP                         -0.0257462
# ATP                          1.7473984
# Acetamide                    0.0460167
# Acetate                      0.0208305
# Acetoacetate                -0.0346461
# Acetone                      0.0375060
# Adenosine                   -0.0021935
# Alanine                      0.0616129
# Aspartate                    0.1749688
# Creatine_Phosphate           0.0334224
# Cytidine                     0.0380111
# Dimethyl_Sulfone             0.1337291
# Ethanol                     -0.0819978
# Ethanolamine                 0.0814386
# Formate                     -0.0479048
# Glycerol                    -0.3007690
# Guanidoacetate               0.0995361
# Guanosine                   -0.0593715
# Hypoxanthine                -0.0811353
# IMP                          0.1433417
# Inosine                      0.0047038
# Isopropanol                  0.0184316
# Malate                       0.2452746
# Malonate                    -0.0202103
# Mannose                      0.0599352
# Methanol                    -0.0112668
# N_N_Dimethylglycine         -0.0976627
# Nicotinurate                 0.1706938
# O_Acetylcarnitine           -0.1874456
# O_Phosphocholine             0.0623429
# Propylene_Glycol             0.0361042
# Taurine                     -0.0162384
# Uridine                      0.0773399
# Xanthine                     0.1516579
# sn_Glycero_3_Phosphocholine -0.1132764
# Beta.Alanine                 0.1023266
# 
# 
# Site scores (weighted averages of species scores)
# 
# CA1      CA2      CA3      CA4      CA5      CA6
# sit1   1.51388 -0.20074  1.38780 -1.70238  0.15112  0.32836
# sit2   0.58049 -0.57710 -1.77183 -1.58052 -0.48566 -1.33431
# sit3  -1.15770 -1.51286 -0.84859 -0.56201  0.94037 -0.80603
# sit4   1.03281 -0.60145  0.49941  0.34123  0.08566 -0.38164
# sit5   1.82634 -0.12593  1.43915 -0.25790  0.92174  0.10212
# sit6   0.33755 -0.65457  1.15882  0.11070  0.17918  0.36779
# sit7   1.11411 -0.07036  0.27159 -0.76427 -0.78034  0.48131
# sit8   0.47157 -0.23942  1.31176 -0.86684 -0.62457  0.32152
# sit9  -0.66049 -0.50836  1.44614 -0.21268  0.20407  0.27194
# sit10 -1.72261  0.11897  1.35968 -0.89861 -0.38484  0.69566
# sit11  0.22187 -0.33711  0.97852 -0.62390 -0.45634 -0.37673
# sit12 -1.08132 -1.65094 -0.87721 -0.31724  0.21366 -0.41154
# sit13  0.48581 -0.16367 -1.82742 -2.04507  0.16401 -0.12357
# sit14 -1.05910 -0.70387 -0.44518  0.17657  0.59191  0.03673
# sit15 -1.64692 -2.36664 -1.24699 -0.76199 -0.60956  2.80102
# sit16  0.28836  0.25757  0.91693 -0.82466  0.18391  0.39283
# sit17 -0.79792 -2.10597 -1.48374 -1.88659  0.54086  2.11352
# sit18  0.43748 -1.19090 -0.79337 -0.45081  0.68840 -1.09383
# sit19 -1.45287 -2.08217 -0.36103  1.14226  0.97058 -0.23941
# sit20  1.86179 -0.08109 -2.54333 -0.97474 -0.20539 -0.16399
# sit21  0.48752  0.13720  2.83079 -1.26275 -0.29982  0.51138
# sit22  0.33473 -0.79104  1.37829  0.07356  0.15431 -0.39129
# sit23 -1.03788 -0.23538  1.18293 -1.05957  3.04527 -2.54604
# sit24 -0.65437 -0.85959  1.36211 -0.06832  0.65314 -0.34171
# sit25 -0.04154 -0.28807  0.25961  1.20748 -1.10612  0.75360
# sit26 -0.74702 -0.66729  0.25372  2.44944  0.00986 -0.84907
# sit27  1.06099  0.10754 -0.72127 -0.17300 -1.75801 -1.13627
# sit28  1.26414 -0.02716 -0.45231  0.53805  0.13160 -0.31521
# sit29  0.47019  0.10005  0.14524  0.79474 -0.34906 -0.67583
# sit30 -0.15548 -0.39644  0.44047  1.49774 -0.96012 -0.06364
# sit31  1.40261  0.78851 -0.51719 -0.26316 -0.48984 -0.95502
# sit32  1.04533 -0.06018 -0.34776  0.75879  0.01523 -0.51900
# sit33 -1.39893  1.29012 -0.12113 -1.26586 -1.06660 -2.85752
# sit34  0.34023  0.14418  0.27778 -0.18235 -0.02690  0.40055
# sit35 -0.68797  1.23634 -0.25931 -0.27984 -1.74533 -0.65916
# sit36  0.11938 -0.33387 -0.09941  0.59954 -0.66449 -0.69021
# sit37 -1.32530 -0.14933  0.14233  1.71777 -0.99071 -1.10294
# sit38 -1.24029 -0.01590  0.03168  0.81446 -0.39014 -1.39076
# sit39 -0.20402 -0.47171  0.48016  1.13782 -0.36240 -0.39975
# sit40  1.26218  0.06316 -0.49005  1.38591  1.08045  0.30606
# sit41  0.95360  0.51865 -0.42461  0.57699  0.31579  0.24443
# sit42  0.70317  1.33257 -0.71905  0.36472  1.30470  0.26464
# sit43 -1.69780  2.95234 -0.80209 -1.74502 -0.22493 -0.11512
# sit44  0.59764  0.30154 -0.65630  1.33371  0.57433  0.30433
# sit45 -0.55539 -0.44036 -0.58308  1.20994 -0.34081  0.85628
# sit46 -1.43852  2.11552 -0.51338  0.47578  0.54280  0.85540
# sit47 -0.05882 -0.02887  0.29646  0.28215 -3.89695  1.06804
# sit48 -0.64440  0.76600  0.39330  0.18800 -0.40565  0.89434
# sit49  0.72315  0.39729 -0.23677  1.10437  1.08276  0.94723
# sit50 -1.37208  1.45130 -1.06322  1.22291  0.96731  0.19082
# sit51  0.20001  1.19279 -0.65191  0.02896  0.21672  1.72573
# sit52  1.87688  0.10956 -0.74618  1.09313  0.50812 -0.45879
# sit53 -0.61389  1.82352  0.68824 -0.16492  1.45590  1.60425
# sit54  0.55229  0.96995 -0.01687  0.20748  1.16602  1.13277
plot(met.ca1, scaling = 1)
plot(met.ca1, scaling = 2)
plot(met.ca1, scaling = 3)
plot(met.ca1, type="n")

points(met.ca1, col="red")
text(met.ca1, "species",  cex=0.7, col="blue")


ef <- envfit(met.ca1, Factors, permu = 999)
ef
# **VECTORS
# 
#         CA1      CA2     r2 Pr(>r)
# FL   0.62872  0.77763 0.0259  0.539
# W    0.96056  0.27808 0.0134  0.722
# Age  0.99715 -0.07541 0.0458  0.303
# Permutation: free
# Number of permutations: 999

# ***FACTORS:
#   
#   Centroids:
#                     CA1     CA2
# SiteDauphin River -0.0033  0.9352
# SiteMatheson      -0.0090  0.1031
# SiteRed River      0.0425 -0.6168
# SiteSandy Bar     -0.0496 -0.7421
# SexF               0.1978  0.1134
# SexM              -0.2530 -1.1035
# SexUN             -0.4564  1.0761
# 
# Goodness of fit:
#   r2 Pr(>r)    
# Site 0.2247  0.001 ***
#   Sex  0.2595  0.001 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# Permutation: free
# Number of permutations: 999

plot(met.ca1, display = "species")
plot(ef, p.max = 0.1)

plot(met.ca1, type="n")
text(met.ca1,display="species")
points(met.ca1,col="red")
plot(ef, p.max = 0.1)

#### RDA with factors variables as qualitative #####
#data normalized
Factors <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Factors_qual18.csv", quote="")
View(Factors)
# redundancy analysis constraint by the factor variables
RDA_met18factors <- rda(Metabolites18T~.,Factors)
summary(RDA_met18factors)

# rda(formula = Metabolites18T ~ Site + FL + W + Sex + Age, data = Factors) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         0.07382     1.0000
# Constrained   0.01289     0.1746
# Unconstrained 0.06093     0.8254
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#   RDA1     RDA2      RDA3      RDA4      RDA5      RDA6
# Eigenvalue            0.007263 0.004701 0.0003167 0.0002213 0.0001524 0.0001258
# Proportion Explained  0.098388 0.063680 0.0042899 0.0029980 0.0020642 0.0017038
# Cumulative Proportion 0.098388 0.162067 0.1663573 0.1693553 0.1714195 0.1731233
# RDA7      RDA8     PC1      PC2      PC3       PC4
# Eigenvalue            6.117e-05 4.657e-05 0.04877 0.008793 0.001238 0.0004952
# Proportion Explained  8.287e-04 6.309e-04 0.66074 0.119123 0.016775 0.0067085
# Cumulative Proportion 1.740e-01 1.746e-01 0.83532 0.954445 0.971219 0.9779278
# PC5       PC6       PC7       PC8       PC9      PC10
# Eigenvalue            0.0003709 0.0002465 0.0002069 0.0001439 0.0001275 0.0001062
# Proportion Explained  0.0050241 0.0033400 0.0028027 0.0019499 0.0017278 0.0014388
# Cumulative Proportion 0.9829519 0.9862919 0.9890946 0.9910445 0.9927723 0.9942111
# PC11      PC12      PC13      PC14      PC15      PC16
# Eigenvalue            8.526e-05 5.771e-05 0.0000490 3.611e-05 2.864e-05 2.623e-05
# Proportion Explained  1.155e-03 7.818e-04 0.0006638 4.891e-04 3.880e-04 3.553e-04
# Cumulative Proportion 9.954e-01 9.961e-01 0.9968117 9.973e-01 9.977e-01 9.980e-01
# PC17      PC18      PC19      PC20      PC21      PC22
# Eigenvalue            2.357e-05 2.072e-05 1.644e-05 1.402e-05 1.189e-05 9.423e-06
# Proportion Explained  3.193e-04 2.807e-04 2.226e-04 1.899e-04 1.611e-04 1.276e-04
# Cumulative Proportion 9.984e-01 9.986e-01 9.989e-01 9.991e-01 9.992e-01 9.993e-01
# PC23      PC24      PC25      PC26      PC27      PC28
# Eigenvalue            8.608e-06 6.415e-06 5.769e-06 4.906e-06 3.630e-06 3.271e-06
# Proportion Explained  1.166e-04 8.691e-05 7.815e-05 6.646e-05 4.917e-05 4.432e-05
# Cumulative Proportion 9.995e-01 9.995e-01 9.996e-01 9.997e-01 9.997e-01 9.998e-01
# PC29      PC30      PC31      PC32      PC33      PC34
# Eigenvalue            2.783e-06 2.391e-06 1.706e-06 1.549e-06 1.268e-06 1.231e-06
# Proportion Explained  3.770e-05 3.239e-05 2.311e-05 2.099e-05 1.718e-05 1.668e-05
# Cumulative Proportion 9.998e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01
# PC35      PC36      PC37      PC38      PC39      PC40
# Eigenvalue            9.658e-07 7.277e-07 5.931e-07 5.539e-07 5.270e-07 4.542e-07
# Proportion Explained  1.308e-05 9.858e-06 8.035e-06 7.503e-06 7.139e-06 6.153e-06
# Cumulative Proportion 9.999e-01 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# PC41      PC42      PC43      PC44      PC45
# Eigenvalue            2.754e-07 2.409e-07 1.788e-07 1.418e-07 1.274e-07
# Proportion Explained  3.731e-06 3.263e-06 2.423e-06 1.921e-06 1.726e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#   RDA1     RDA2      RDA3      RDA4      RDA5      RDA6
# Eigenvalue            0.007263 0.004701 0.0003167 0.0002213 0.0001524 0.0001258
# Proportion Explained  0.563558 0.364753 0.0245723 0.0171722 0.0118235 0.0097594
# Cumulative Proportion 0.563558 0.928312 0.9528840 0.9700563 0.9818798 0.9916392
# RDA7      RDA8
# Eigenvalue            6.117e-05 4.657e-05
# Proportion Explained  4.747e-03 3.614e-03
# Cumulative Proportion 9.964e-01 1.000e+00
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  1.4064 
# 
# 
# Species scores
# 
#                               RDA1       RDA2       RDA3       RDA4       RDA5
# Serine                      -5.374e-03 -2.028e-03  1.124e-02 -1.295e-02 -5.309e-04
# Putrescine                  -5.524e-04  1.574e-03 -1.142e-03 -7.568e-04  1.946e-03
# Trans_Hydroxyproline        -1.861e-03  6.784e-03 -1.230e-03  2.126e-03  4.384e-03
# Asparagine                  -2.256e-03  5.640e-03 -1.324e-03  1.868e-03  4.348e-03
# Glutamine                   -2.583e-03  8.546e-04  1.664e-03 -1.938e-03  1.090e-03
# Alpha_Aminoadipic_Acid       7.540e-06  4.535e-04  5.036e-04  4.161e-05  7.779e-04
# Methionine_Sulfoxide        -8.505e-04  1.828e-06  4.567e-04 -7.904e-04  1.364e-04
# Acetyl_Ornithine             3.026e-06  7.855e-05  6.297e-05  4.339e-05  5.901e-05
# Citrulline                   1.170e-02 -1.456e-02  1.795e-03  2.428e-02 -1.332e-02
# Asymmetric_Dimethylarginine -5.141e-05  7.904e-05 -1.971e-07 -3.702e-05  5.015e-05
# Total_Dimethylarginine      -7.511e-05  1.295e-04  1.933e-05 -8.943e-05  8.367e-05
# Tryptophan                  -1.285e-03  2.503e-03  8.258e-04  5.090e-04  9.862e-04
# Kynurenine                  -6.991e-05  5.212e-05  4.573e-05  1.617e-05  6.064e-06
# Ornithine                   -5.684e-04 -7.861e-04  1.434e-03 -1.787e-03  2.540e-04
# Lysine                      -3.004e-03 -4.832e-03  5.804e-03 -7.583e-03  2.504e-03
# Spermidine                  -2.794e-04  1.782e-03 -4.687e-04  1.099e-04  2.340e-03
# Spermine                     5.979e-04  2.680e-03  3.163e-04  9.143e-04  3.122e-03
# Sarcosine                   -1.465e-03 -2.510e-04  4.073e-03 -3.704e-03  3.592e-04
# Methylhistidine              1.408e-03  3.099e-04  1.156e-03 -4.969e-03 -3.167e-03
# Beta_Hydroxybutyric_Acid     3.149e-04  1.838e-03  5.007e-04 -5.001e-04 -1.196e-05
# Alpha_Ketoglutaric_Acid      9.931e-04  1.014e-03  1.838e-03 -8.847e-04  2.033e-04
# Butyric_acid                 5.952e-05  2.193e-04 -9.056e-05 -3.051e-05  1.060e-04
# Propionic_Acid               1.732e-03 -4.305e-04 -1.214e-03 -1.275e-03  4.717e-04
# Fumaric_Acid                -5.242e-04  2.067e-04  3.446e-03 -1.295e-03 -1.482e-04
# Isobutyric_Acid              4.509e-05  5.647e-04 -5.708e-05  1.273e-04  2.631e-04
# Hippuric_Acid                4.552e-07  1.156e-06 -2.970e-06  1.543e-07  1.985e-07
# Methylmalonic_Acid          -2.255e-06  2.366e-06 -2.144e-06 -7.456e-07  8.172e-06
# LYSOC14_0                    1.508e-04 -7.437e-05  1.146e-04  1.735e-04  1.938e-05
# LYSOC16_1                    5.822e-04 -2.328e-04  6.577e-04  1.083e-03 -1.441e-04
# LYSOC16_0                    2.636e-03 -2.337e-03  2.573e-03  4.064e-03 -1.224e-03
# LYSOC17_0                    1.494e-04 -1.323e-04  9.335e-05  1.959e-04 -3.990e-05
# LYSOC18_2                    2.121e-05  5.636e-05  4.619e-05 -4.722e-06 -2.459e-05
# LYSOC18_1                    8.055e-05  3.056e-04  4.386e-04 -9.890e-05 -3.141e-05
# LYSOC18_0                   -6.622e-05  9.868e-05  2.091e-04 -1.680e-04  1.777e-05
# LYSOC20_4                   -5.152e-07  9.184e-04  7.838e-05  1.838e-04  3.318e-04
# LYSOC20_3                    2.459e-04 -1.384e-04  9.372e-05 -3.834e-05  1.392e-04
# LYSOC24_0                    8.495e-05 -1.118e-04  2.904e-05 -8.846e-06 -4.921e-05
# LYSOC26_1                    4.073e-05  5.190e-06 -6.002e-06 -6.849e-06 -6.318e-06
# LYSOC26_0                    4.676e-05 -5.371e-05  7.380e-06  1.393e-05 -2.845e-05
# LYSOC28_1                    4.389e-05  8.392e-06 -9.491e-06  1.819e-05  3.004e-05
# LYSOC28_0                    2.723e-05 -1.009e-05 -1.522e-05  8.159e-08 -1.158e-05
# X14_1SMOH                    2.133e-04  1.183e-04 -4.857e-05  2.144e-04  1.818e-04
# X16_1SM                      1.761e-04  1.121e-03 -2.425e-05  4.282e-04  4.358e-04
# X16_0SM                      1.893e-04  7.968e-04 -9.101e-05  4.386e-04  4.443e-04
# X16_1SMOH                    2.818e-04  3.916e-04 -1.076e-04  9.656e-04  6.162e-04
# X18_1SM                      3.465e-05  8.282e-05  1.338e-04 -1.501e-05  1.297e-04
# PC32_2AA                     4.940e-04 -1.615e-03  2.977e-03 -3.802e-04  5.711e-05
# X18_0SM                      1.372e-04 -5.339e-04  1.216e-03 -3.176e-04  2.609e-04
# X20_2SM                      1.979e-04  4.813e-05  5.486e-04 -3.220e-04  1.498e-04
# PC36_0AE                     2.659e-04  1.017e-03  3.271e-05  1.288e-03  7.635e-04
# PC36_6AA                     3.335e-03  9.562e-04  2.975e-03  3.406e-03  2.467e-03
# PC36_0AA                     8.848e-04  7.996e-03 -2.727e-03  1.290e-02  8.591e-03
# X22_2SMOH                    3.781e-04  7.905e-04 -1.405e-04  8.106e-04  6.918e-04
# X22_1SMOH                    1.504e-04  2.685e-04  2.469e-05  2.185e-04  1.665e-04
# PC38_6AA                     2.816e-02  1.170e-02  3.059e-02  2.256e-02  2.027e-02
# PC38_0AA                     2.326e-03  5.026e-03  1.207e-04  4.394e-03  3.280e-03
# PC40_6AE                     3.307e-03  1.931e-03  1.971e-03  1.737e-03  2.603e-03
# X24_1SMOH                    6.211e-04  3.551e-05  2.880e-04  1.032e-04 -5.986e-05
# PC40_6AA                    -7.793e-04  7.072e-03  6.415e-03 -9.321e-03  1.358e-05
# PC40_2AA                     9.150e-05  5.470e-05  1.419e-05  6.988e-05  3.079e-05
# PC401AA                      8.105e-05  4.690e-05  5.032e-05 -1.623e-05 -2.304e-05
# C2                           3.056e-04  1.006e-03 -7.977e-04 -1.166e-03 -1.403e-03
# C3_1                         5.787e-07  3.858e-06 -3.072e-06 -2.319e-07 -7.322e-07
# C3                          -4.122e-05  2.376e-04 -3.605e-05  5.294e-05  1.369e-04
# C4_1                         1.946e-07  4.007e-06 -1.707e-06  2.967e-06  3.536e-06
# C4                          -6.102e-06  3.979e-05 -6.692e-06  1.217e-05  1.697e-05
# C3OH                         5.209e-07  2.441e-09  5.913e-07  6.153e-07  5.134e-07
# C5_1                         1.845e-07  8.396e-07 -6.227e-07 -3.235e-07  1.462e-06
# C5                          -2.024e-05  4.978e-05 -1.802e-05  1.477e-05  4.472e-05
# C4OH                         7.738e-06  1.563e-05 -2.055e-06  4.328e-06  3.995e-06
# C6_1                         1.248e-05  2.990e-06 -6.308e-07  1.002e-05  3.416e-06
# C6                           2.545e-05  1.878e-05 -4.144e-06  9.282e-06 -1.759e-05
# C5OH                         1.277e-07 -1.422e-07 -1.431e-09 -7.270e-06  6.346e-06
# C5_1DC                       2.375e-06  7.129e-06  1.211e-06  3.648e-06  5.397e-06
# C5DC                        -3.053e-06  1.337e-05 -1.038e-05 -3.591e-06  4.899e-06
# C8                           3.459e-06  6.649e-06  9.689e-06 -9.267e-07 -7.532e-06
# C5MDC                        8.586e-07  1.119e-08  8.216e-07 -1.573e-07  2.827e-08
# C9                           7.938e-07  5.693e-07  1.012e-06 -2.555e-07 -5.355e-07
# C7DC                         2.761e-06 -4.386e-06  1.386e-06  1.391e-06 -2.139e-06
# C10_2                        3.611e-06 -4.106e-06  2.912e-06 -4.367e-06 -4.121e-06
# C10_1                        4.144e-06  2.675e-06  1.156e-06  2.474e-06 -7.586e-07
# C10                          4.593e-06 -1.092e-07  3.624e-06  8.189e-07 -7.140e-07
# C12_1                        1.374e-06  3.922e-06  1.214e-06  4.960e-07 -1.455e-07
# C12                          1.928e-06  1.072e-06  1.882e-06 -1.086e-07 -1.239e-06
# C14_2                        7.495e-07  1.902e-07  5.678e-07  5.050e-07 -3.414e-07
# C14_1                        4.508e-06  9.130e-06  7.903e-06 -1.893e-06 -1.225e-06
# C14                          5.148e-06  7.850e-06  7.513e-06  4.030e-07 -2.443e-06
# C12DC                        1.286e-06 -2.833e-07  1.537e-06 -7.222e-07 -7.663e-07
# C14_2OH                      1.827e-06  3.109e-07  2.642e-06 -1.059e-06 -1.259e-06
# C14_1OH                      3.476e-06  4.165e-06  4.567e-06  1.338e-06 -1.543e-06
# C16_2                        5.669e-07  1.813e-07  1.294e-06 -5.857e-07 -8.934e-07
# C16_1                        9.078e-06  6.263e-06  2.244e-05 -2.959e-06 -1.339e-05
# C16                          1.355e-05  8.091e-06  1.201e-05  4.827e-06 -7.948e-06
# C16_2OH                      2.360e-06  1.038e-06  2.186e-06  5.432e-07 -1.322e-06
# C16_1OH                      4.091e-06  2.280e-06  4.056e-06  2.337e-06 -1.277e-06
# C16OH                        7.279e-07  8.552e-07  7.161e-07 -1.040e-07 -5.551e-08
# C18_2                        1.291e-06  1.485e-06  3.419e-06 -1.188e-06 -2.028e-06
# C18_1                        1.396e-05  7.349e-06  2.288e-05  4.370e-07 -1.644e-05
# C18                          4.292e-06  1.384e-07  4.828e-06  2.103e-06 -1.594e-06
# C18_1OH                      1.273e-06  6.669e-07  1.236e-06  2.505e-07 -9.752e-07
# Arginine_Average            -4.324e-03 -4.324e-03  5.166e-03 -1.116e-02  1.387e-03
# Betaine_Average              1.010e-02 -1.464e-02  1.433e-02  8.520e-03 -1.311e-02
# C0_Average                   7.409e-04  2.406e-04 -2.887e-04 -2.822e-03 -5.212e-04
# Choline_Average              8.881e-04 -4.740e-03  6.823e-03 -1.811e-03  3.176e-04
# Citrate_Average              5.578e-03  5.321e-02  1.671e-02  8.141e-03  1.635e-02
# Creatine_Average             1.161e-02  6.359e-02 -5.847e-02 -6.142e-03  8.199e-03
# Creatinine_Average           2.714e-05  1.391e-03 -1.063e-03 -3.049e-04  2.664e-04
# Glucose_Average             -3.055e-01 -1.529e-01 -1.121e-02 -1.799e-02  6.729e-03
# Glutamate_Average           -4.854e-03  3.777e-03  7.045e-03 -4.413e-03  1.092e-03
# Glycine_Average             -2.183e-02  1.375e-02  2.943e-02 -3.520e-02  3.187e-03
# Histidine_Average           -2.158e-03  1.032e-03 -6.980e-04 -1.685e-03  1.246e-03
# Isoleucine_Average          -6.001e-03  1.782e-02  7.322e-03  3.110e-04  1.204e-02
# Lactate_Average             -5.556e-02  2.830e-01  2.933e-03 -1.565e-02 -6.770e-03
# Leucine                     -1.116e-02  4.295e-03  1.110e-02 -1.401e-02  1.693e-02
# Methionine                  -2.288e-03  1.296e-03  2.410e-03 -3.316e-03  1.250e-03
# Phenylalanine_Average       -5.458e-03  4.013e-03  5.836e-03 -3.016e-03  1.866e-03
# Proline                     -3.694e-03  1.436e-02  2.157e-03  1.248e-03  1.292e-02
# Pyruvate_Average            -4.392e-04 -3.799e-03  9.058e-03 -1.670e-02 -3.128e-03
# Succinate_Average           -1.138e-04 -2.745e-04  1.067e-03 -3.627e-04 -6.288e-04
# Threonine_Average           -8.217e-03  6.117e-03 -1.545e-03 -1.296e-02  3.809e-03
# Tyrosine_Average            -7.563e-03  5.626e-03  5.554e-03 -4.501e-03 -5.896e-04
# Valine_Average              -1.229e-02  3.201e-02  1.082e-02  6.246e-04  2.040e-02
# X1_Methylhistidine           1.088e-04 -2.365e-04  1.111e-04  9.785e-05 -7.696e-05
# X2_Hydroxybutyrate          -3.406e-04  2.876e-03  5.985e-04  5.556e-04  5.168e-04
# X2_Hydroxyisovaleric_Acid    3.241e-04 -2.226e-05  2.864e-05  1.249e-04  2.391e-04
# X3_Hydroxybutyrate           2.393e-04  1.745e-03  4.661e-04 -6.247e-04 -8.772e-05
# ADP                          5.419e-03 -1.620e-02  8.660e-03  5.882e-03 -7.015e-03
# AMP                          3.564e-03  3.716e-03 -1.563e-03  2.283e-03 -1.701e-02
# ATP                          5.237e-03 -4.626e-03  1.055e-03  2.425e-03 -1.657e-03
# Acetamide                    1.100e-03 -1.350e-03  9.627e-04 -3.920e-06 -8.243e-04
# Acetate                      3.391e-03  2.796e-03  2.491e-03 -1.980e-05 -1.296e-03
# Acetoacetate                -8.757e-04  4.079e-03 -2.804e-03 -8.380e-04 -1.490e-03
# Acetone                      1.485e-04  1.834e-04  7.272e-05 -4.379e-05 -1.147e-04
# Adenosine                   -4.345e-03 -1.262e-02  1.418e-02 -4.206e-03 -1.256e-02
# Alanine                      4.621e-03  1.983e-03  9.698e-03 -2.140e-03  7.350e-04
# Aspartate                   -4.036e-04  2.131e-03 -5.291e-04 -3.965e-04  9.696e-04
# Creatine_Phosphate           6.647e-05 -3.185e-04  1.966e-04 -3.168e-04 -9.234e-04
# Cytidine                    -6.875e-05  2.906e-04 -1.138e-04 -3.928e-04  2.106e-04
# Dimethyl_Sulfone             5.309e-04  1.091e-03 -2.678e-04  1.990e-04  1.569e-04
# Ethanol                      1.692e-04 -3.640e-04 -4.898e-04  1.180e-04  4.277e-04
# Ethanolamine                 8.526e-03 -1.282e-02  1.095e-02  4.016e-03 -1.366e-02
# Formate                      7.128e-04 -1.157e-03 -1.120e-03  1.699e-04  1.813e-03
# Glycerol                     1.111e-03 -1.987e-02  1.274e-02  4.148e-03  1.707e-02
# Guanidoacetate               7.810e-03 -2.730e-03  6.263e-03 -1.060e-03 -9.957e-03
# Guanosine                   -9.871e-04 -1.477e-02  2.090e-02  4.680e-03 -8.484e-03
# Hypoxanthine                 7.855e-04 -2.667e-03  2.115e-03  3.135e-04 -2.465e-03
# IMP                         -2.515e-03  1.907e-02 -4.924e-04 -4.225e-03  5.300e-03
# Inosine                      2.481e-03  2.458e-02 -1.853e-02  6.381e-03  1.091e-02
# Isopropanol                  5.802e-05 -8.336e-05  3.513e-05  2.164e-05  3.036e-05
# Malate                       3.370e-04 -1.837e-04  1.543e-03 -2.206e-03 -5.559e-04
# Malonate                     1.179e-03  9.146e-04 -1.610e-03 -1.708e-04 -1.860e-03
# Mannose                     -1.612e-03  1.610e-03 -6.800e-04 -2.252e-03 -5.522e-04
# Methanol                     3.422e-03  1.765e-03 -5.476e-03 -3.806e-03  6.883e-03
# N_N_Dimethylglycine          1.682e-03 -7.215e-04  6.101e-04 -1.095e-03 -1.266e-03
# Nicotinurate                 3.041e-04  6.980e-04  1.994e-03 -2.624e-04  4.900e-04
# O_Acetylcarnitine            2.536e-04  1.014e-03 -1.152e-03 -1.253e-03 -1.336e-03
# O_Phosphocholine             3.494e-04  8.792e-04 -7.732e-05 -1.362e-03  1.068e-04
# Propylene_Glycol             7.465e-05  1.840e-03 -8.596e-04 -3.101e-04 -3.380e-04
# Taurine                      3.080e-01 -1.011e-01 -9.081e-03 -2.652e-02  7.976e-03
# Uridine                     -6.555e-04  1.146e-03  5.186e-04 -7.801e-04  4.252e-04
# Xanthine                     8.595e-05  3.691e-05 -6.387e-05  2.466e-05  1.228e-04
# sn_Glycero_3_Phosphocholine  6.019e-03 -1.269e-02  1.235e-02 -1.713e-03  1.573e-03
# Beta.Alanine                 2.569e-02  1.305e-02  1.536e-03 -2.206e-02 -1.494e-02
# RDA6
# Serine                       3.249e-03
# Putrescine                  -8.126e-04
# Trans_Hydroxyproline        -9.498e-04
# Asparagine                  -1.187e-03
# Glutamine                   -1.603e-03
# Alpha_Aminoadipic_Acid      -1.106e-04
# Methionine_Sulfoxide         2.735e-04
# Acetyl_Ornithine            -7.938e-05
# Citrulline                  -1.687e-03
# Asymmetric_Dimethylarginine -2.563e-05
# Total_Dimethylarginine      -3.058e-05
# Tryptophan                  -3.012e-04
# Kynurenine                  -4.304e-05
# Ornithine                    2.591e-04
# Lysine                       2.781e-03
# Spermidine                  -4.518e-04
# Spermine                     1.084e-03
# Sarcosine                    2.173e-04
# Methylhistidine              2.738e-03
# Beta_Hydroxybutyric_Acid     1.121e-04
# Alpha_Ketoglutaric_Acid      1.608e-03
# Butyric_acid                 3.969e-05
# Propionic_Acid               2.157e-03
# Fumaric_Acid                -6.499e-04
# Isobutyric_Acid              5.211e-05
# Hippuric_Acid                4.994e-07
# Methylmalonic_Acid          -4.620e-06
# LYSOC14_0                    1.125e-04
# LYSOC16_1                    2.132e-04
# LYSOC16_0                    1.545e-03
# LYSOC17_0                    7.648e-05
# LYSOC18_2                    1.713e-05
# LYSOC18_1                    2.262e-04
# LYSOC18_0                    1.055e-04
# LYSOC20_4                   -1.710e-04
# LYSOC20_3                    3.967e-04
# LYSOC24_0                    1.919e-04
# LYSOC26_1                    6.685e-05
# LYSOC26_0                    9.577e-05
# LYSOC28_1                    4.382e-05
# LYSOC28_0                    5.685e-05
# X14_1SMOH                    1.335e-05
# X16_1SM                     -9.125e-05
# X16_0SM                     -9.988e-05
# X16_1SMOH                   -5.544e-05
# X18_1SM                      1.605e-05
# PC32_2AA                     1.332e-03
# X18_0SM                      2.591e-04
# X20_2SM                      8.677e-06
# PC36_0AE                    -5.658e-05
# PC36_6AA                    -7.433e-05
# PC36_0AA                    -2.813e-03
# X22_2SMOH                   -1.665e-05
# X22_1SMOH                   -2.367e-05
# PC38_6AA                     1.301e-02
# PC38_0AA                    -5.102e-04
# PC40_6AE                     7.426e-04
# X24_1SMOH                    1.631e-04
# PC40_6AA                     1.700e-03
# PC40_2AA                     7.985e-05
# PC401AA                      6.970e-05
# C2                           2.176e-04
# C3_1                         2.719e-06
# C3                          -4.688e-05
# C4_1                         8.922e-07
# C4                          -8.141e-06
# C3OH                         8.872e-07
# C5_1                         8.149e-07
# C5                          -1.845e-05
# C4OH                         6.808e-08
# C6_1                         7.363e-06
# C6                           4.259e-05
# C5OH                         4.263e-06
# C5_1DC                       2.468e-06
# C5DC                         1.325e-05
# C8                           1.222e-05
# C5MDC                        1.783e-06
# C9                           4.244e-07
# C7DC                        -4.140e-06
# C10_2                        6.148e-06
# C10_1                        6.746e-06
# C10                          6.863e-06
# C12_1                        1.394e-06
# C12                          1.906e-06
# C14_2                        6.748e-07
# C14_1                        5.126e-07
# C14                          1.440e-06
# C12DC                        8.102e-07
# C14_2OH                      5.978e-07
# C14_1OH                      7.358e-07
# C16_2                        5.617e-07
# C16_1                        5.687e-06
# C16                          6.844e-06
# C16_2OH                      1.138e-06
# C16_1OH                      1.485e-06
# C16OH                        2.346e-07
# C18_2                        4.083e-07
# C18_1                        7.155e-06
# C18                          2.043e-06
# C18_1OH                      7.896e-07
# Arginine_Average             2.129e-03
# Betaine_Average              9.812e-04
# C0_Average                   5.965e-04
# Choline_Average              1.556e-03
# Citrate_Average             -1.498e-02
# Creatine_Average             2.739e-02
# Creatinine_Average          -1.308e-04
# Glucose_Average             -1.354e-02
# Glutamate_Average           -2.333e-03
# Glycine_Average              2.500e-02
# Histidine_Average           -1.008e-03
# Isoleucine_Average          -9.455e-04
# Lactate_Average             -1.415e-02
# Leucine                      2.147e-03
# Methionine                  -6.186e-04
# Phenylalanine_Average        3.024e-04
# Proline                     -1.407e-03
# Pyruvate_Average             7.497e-03
# Succinate_Average            3.551e-04
# Threonine_Average            2.011e-03
# Tyrosine_Average            -3.834e-03
# Valine_Average              -4.582e-03
# X1_Methylhistidine           4.150e-04
# X2_Hydroxybutyrate           3.415e-05
# X2_Hydroxyisovaleric_Acid   -1.519e-04
# X3_Hydroxybutyrate           2.042e-04
# ADP                          1.473e-03
# AMP                          1.097e-02
# ATP                         -7.510e-04
# Acetamide                    1.039e-03
# Acetate                      6.012e-04
# Acetoacetate                 3.633e-03
# Acetone                      3.337e-05
# Adenosine                   -3.686e-04
# Alanine                     -9.092e-03
# Aspartate                   -7.390e-04
# Creatine_Phosphate           1.136e-04
# Cytidine                     1.324e-04
# Dimethyl_Sulfone            -1.535e-04
# Ethanol                      3.565e-04
# Ethanolamine                 4.766e-03
# Formate                      1.056e-03
# Glycerol                     1.145e-02
# Guanidoacetate               1.734e-03
# Guanosine                    9.097e-03
# Hypoxanthine                 2.302e-03
# IMP                         -1.079e-02
# Inosine                     -2.902e-03
# Isopropanol                  6.426e-05
# Malate                      -2.596e-03
# Malonate                     7.414e-04
# Mannose                     -3.470e-04
# Methanol                     9.021e-03
# N_N_Dimethylglycine          1.707e-04
# Nicotinurate                -1.115e-03
# O_Acetylcarnitine            2.972e-04
# O_Phosphocholine             5.716e-05
# Propylene_Glycol             6.894e-04
# Taurine                     -1.609e-02
# Uridine                     -3.414e-04
# Xanthine                     4.485e-05
# sn_Glycero_3_Phosphocholine  5.329e-03
# Beta.Alanine                -8.309e-03
# 
# 
# Site scores (weighted sums of species scores)
# 
# RDA1     RDA2      RDA3     RDA4     RDA5       RDA6
# row1  -0.84374 -0.21228  0.412451  0.26490 -0.04057  0.4882801
# row2  -0.50030 -0.20221 -0.321506  0.28752 -0.15045  0.7609251
# row3   0.61850 -0.27886 -0.072137  0.09189 -0.19828  0.0907240
# row4  -0.46216 -0.26357 -0.071477  0.06912 -0.02513 -0.3400232
# row5  -0.84720 -0.44312  0.049210  0.26656  0.19352  0.3914371
# row6  -0.10734 -0.27113  0.037037 -0.32712  0.02460 -0.3911766
# row7  -0.66294  0.15941  0.328443  0.22557 -0.49066  0.0242886
# row8  -0.21495 -0.03717  0.269523 -0.34863 -0.18380 -0.2563857
# row9   0.40230 -0.03964  0.235173 -0.39640 -0.20168 -0.3641448
# row10  0.82212  0.38742  0.539746 -0.08378 -0.52312 -0.0188507
# row11 -0.16595  0.03504 -0.007822 -0.48447 -0.45450 -0.2011634
# row12  0.62865 -0.29157 -0.027449  0.09709 -0.12432 -0.0003604
# row13 -0.38215  0.28476  0.172742  0.21358 -0.58640  0.1646918
# row14  0.53160  0.20263  0.100857 -0.01326 -0.52217 -0.3435563
# row15  0.81332 -0.31556  0.048563  0.06587 -0.22485 -0.0219726
# row16 -0.13590  0.26097  0.393378 -0.13364 -0.15133 -0.2988940
# row17  0.34699 -0.23453  0.284535  0.13204 -0.30292 -0.2292159
# row18 -0.14928 -0.49904 -0.080674  0.26215  0.45201  0.1096455
# row19  0.79316 -0.53794 -0.046017  0.32823  0.23334  0.0746181
# row20 -0.93728  0.02600  0.263226  1.24569 -0.01399  0.4919231
# row21 -0.18156 -0.14767  0.519643 -0.82511  0.34533  0.5334918
# row22 -0.03886 -0.42888 -0.020016 -0.31748  0.36338 -0.1382009
# row23  0.54710 -0.08585  0.145781 -0.13078  0.75623  0.6471222
# row24  0.48947 -0.29128  0.227638 -0.21827  0.33763  0.0701444
# row25  0.10412 -0.04509  0.057352 -0.20910 -0.01911 -0.8162634
# row26  0.49495 -0.30071 -0.399260 -0.13821  0.27859 -0.3360038
# row27 -0.55626 -0.20229 -0.356227  0.20459  0.21888  0.4114673
# row28 -0.62697 -0.07551 -0.102927  0.37291  0.03068 -0.1058929
# row29 -0.24140 -0.04895 -0.326419 -0.29821 -0.10306 -0.2038125
# row30  0.16916 -0.18658 -0.256900 -0.44726  0.08541 -0.4727685
# row31 -0.81512  0.11108 -0.417395  0.27939 -0.21369  0.5889828
# row32 -0.50125 -0.20155 -0.341595  0.14954  0.08763 -0.2161344
# row33  0.70897  0.39115 -0.559810 -0.17587  0.08795  1.3878721
# row34 -0.22054  0.29904  0.182367 -0.02229 -0.26946 -0.6221917
# row35  0.22360  0.78906  0.099322 -0.34933 -0.61431  0.8107825
# row36  0.02976 -0.13820 -0.128676 -0.10332  0.11554 -0.3014497
# row37  0.69930 -0.03254 -0.430637 -0.25467 -0.01282  0.2593825
# row38  0.67135 -0.04660 -0.336793 -0.12355  0.08314  0.1553810
# row39  0.21271 -0.21025 -0.111346 -0.31039  0.10100 -0.3979508
# row40 -0.59991 -0.22494 -0.273079  0.29056  0.12171 -0.3032323
# row41 -0.48781  0.02487 -0.042538  0.12442  0.06126 -0.2038163
# row42 -0.43083  0.07652 -0.212402  0.18841  0.57463 -0.0556774
# row43  0.77072  1.10410  0.513981  0.60386  0.18393  1.5702067
# row44 -0.30253 -0.11079 -0.279762  0.05732  0.36412 -0.3807768
# row45  0.31003  0.06112  0.075594 -0.05303 -0.16931 -0.8751698
# row46  0.64927  0.79841  0.127068  0.20498 -0.04359  0.3631610
# row47 -0.01156  0.17941  0.183878 -0.39516 -0.48036 -0.7648831
# row48  0.36663  0.28876  0.247261 -0.28711  0.02822 -0.2771947
# row49 -0.38477 -0.03811 -0.038115 -0.04506  0.12190 -0.2414266
# row50  0.64993  0.42052 -0.119639  0.19223  0.36195  0.1284257
# row51 -0.23278  0.52364  0.385379  0.17542 -0.22351 -0.3450306
# row52 -0.88784 -0.40048 -0.363531  0.65769  0.29621  0.3340881
# row53  0.24078  0.45136  0.039094 -0.38341  0.22261 -0.2628409
# row54 -0.36534 -0.03241 -0.195093 -0.17664  0.21198 -0.0705812
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# RDA1      RDA2      RDA3      RDA4      RDA5      RDA6
# row1  -0.193480 -0.068091  0.299904 -0.209850 -0.198532 -0.239496
# row2   0.166896 -0.066892  0.007167  0.106436 -0.389580  0.114633
# row3  -0.014184 -0.122188  0.009861  0.317814 -0.306002  0.053864
# row4   0.071139 -0.075467  0.002944  0.211763 -0.365249  0.134812
# row5  -0.263692 -0.030811  0.220961 -0.085683 -0.180515  0.023366
# row6  -0.202902 -0.098434  0.307550 -0.190277 -0.167781 -0.312186
# row7  -0.471711  0.133627  0.193734  0.055698 -0.324675  0.461744
# row8   0.192048 -0.107816  0.177338 -0.459372 -0.119966 -0.164259
# row9  -0.289353 -0.164164  0.319584 -0.077081 -0.090069 -0.440765
# row10  0.037850 -0.073973  0.157517 -0.304642 -0.126594 -0.011137
# row11  0.119336 -0.016074  0.051369 -0.319259 -0.132855  0.306454
# row12  0.218724 -0.177269 -0.023060  0.145880 -0.250121 -0.049680
# row13 -0.025495 -0.120175  0.008535  0.329310 -0.306037  0.063906
# row14 -0.032405 -0.129618  0.010642  0.339666 -0.295798  0.043024
# row15  0.317016 -0.168492 -0.050690  0.068044 -0.254042 -0.001568
# row16 -0.070704 -0.120388  0.284946 -0.134064  0.220853  0.236285
# row17  0.224034 -0.295176  0.131712  0.216720  0.146923 -0.033044
# row18  0.157807 -0.298333  0.128034  0.288699  0.161084 -0.012068
# row19  0.130384 -0.236472  0.141221  0.268511  0.085194  0.087639
# row20  0.211088 -0.277930  0.126112  0.225213  0.132519  0.016276
# row21  0.007858 -0.112369  0.256171 -0.190513  0.220975  0.291108
# row22  0.165073 -0.159556  0.279845 -0.344312  0.239925  0.102884
# row23 -0.012277 -0.257731  0.166627 -0.002464  0.448215  0.207486
# row24 -0.079413 -0.180265  0.172826  0.015047  0.363995  0.364069
# row25  0.268038  0.158048 -0.089614  0.164177  0.123350 -0.031410
# row26  0.021371 -0.058612 -0.314725 -0.085319  0.056293  0.063052
# row27 -0.058699 -0.059959 -0.287876 -0.029335  0.050010  0.025780
# row28 -0.153075 -0.066645 -0.292519  0.073921  0.072293  0.050136
# row29 -0.084591 -0.025467 -0.299076 -0.012349  0.021202  0.124421
# row30  0.140532 -0.126124 -0.320077 -0.161707  0.122204 -0.091090
# row31  0.003277 -0.074604 -0.311595 -0.060929  0.074706  0.030485
# row32  0.053067 -0.123368 -0.326827 -0.068808  0.134248 -0.045852
# row33  0.085537  0.026856 -0.269738 -0.241327 -0.078707  0.113568
# row34 -0.229641 -0.075319 -0.039629 -0.083456 -0.074741 -0.489432
# row35 -0.047848  0.121861 -0.240903 -0.188545 -0.189688  0.274643
# row36  0.541768  0.318053  0.013316 -0.300292 -0.160569 -0.021652
# row37 -0.086317  0.072555 -0.198095 -0.162184 -0.156856  0.097764
# row38 -0.073683  0.018900 -0.278481 -0.068164 -0.044310  0.163076
# row39 -0.027370 -0.004107 -0.173105 -0.201439 -0.093063 -0.122088
# row40 -0.474200  0.097840 -0.071059  0.278981  0.161359 -0.027835
# row41 -0.117362  0.034166 -0.125106  0.007151  0.225710 -0.138452
# row42  0.063403  0.359439  0.129749  0.232841  0.157368 -0.066912
# row43  0.061641  0.383233  0.123126  0.227301  0.134791 -0.005907
# row44 -0.094488  0.013019 -0.117758 -0.010767  0.242196 -0.201991
# row45  0.186085 -0.080745 -0.166220  0.208823  0.008638 -0.535566
# row46  0.212866  0.321341  0.086466  0.145056  0.210942 -0.090961
# row47  0.149395  0.437583  0.242176 -0.004819 -0.016317 -0.182260
# row48 -0.048900  0.096042 -0.105348 -0.115827  0.133697 -0.080651
# row49 -0.190831  0.196837 -0.078681 -0.055691  0.018586  0.098820
# row50  0.236064  0.411964  0.127235  0.031354  0.077868 -0.009474
# row51 -0.004538  0.529665  0.174488  0.161714 -0.057947  0.187066
# row52 -0.231920  0.114722 -0.091031  0.044263  0.125457 -0.022192
# row53 -0.211724  0.122405  0.004168 -0.070596  0.051590 -0.218242
# row54 -0.251495  0.084479 -0.084109  0.074689  0.157819 -0.090189
# 
# 
# Biplot scores for constraining variables
# 
#                  RDA1     RDA2     RDA3     RDA4     RDA5      RDA6
# SiteMatheson   0.07612  0.02205 -0.74075 -0.30800 -0.03103  0.030546
# SiteRed River -0.07998 -0.27778  0.36581 -0.01546 -0.75779 -0.003734
# SiteSandy Bar  0.19053 -0.50323  0.43813  0.08901  0.52438  0.327303
# FL            -0.26480  0.16604  0.34170 -0.76669 -0.27223 -0.140547
# W             -0.26747  0.04598  0.48199 -0.68402 -0.25273 -0.315251
# SexM           0.37497 -0.47683  0.07593  0.63466 -0.37994 -0.027410
# SexUN          0.41636  0.79515  0.21979  0.17904  0.12788 -0.060334
# Age           -0.56655 -0.02302  0.36199 -0.47535 -0.41204 -0.152635
# 
# 
# Centroids for factor constraints
# 
#                     RDA1      RDA2      RDA3     RDA4      RDA5      RDA6
# SiteDauphin River -0.04773  0.208133  0.003206  0.07696  0.108784 -0.092317
# SiteMatheson       0.02349  0.006805 -0.228596 -0.09505 -0.009575  0.009427
# SiteRed River     -0.02468 -0.085723  0.112890 -0.00477 -0.233854 -0.001152
# SiteSandy Bar      0.08154 -0.215358  0.187499  0.03809  0.224409  0.140070
# SexF              -0.09234 -0.025605 -0.033329 -0.09954  0.034205  0.009979
# SexM               0.13426 -0.170730  0.027188  0.22724 -0.136039 -0.009814
# SexUN              0.19108  0.364916  0.100868  0.08217  0.058686 -0.027689

coef(RDA_met18factors)
#                  RDA1         RDA2          RDA3         RDA4         RDA5
# SiteMatheson   0.16219359 -0.105650455 -0.1423575910 -0.099960135 -0.078038207
# SiteRed River  0.12437193 -0.075545804  0.0878844858 -0.129518488 -0.179383908
# SiteSandy Bar  0.11009743 -0.159205029  0.1966473718 -0.059855112  0.105791277
# FL             0.00098274  0.001342894 -0.0002995794 -0.001472739 -0.001456047
# W              0.08222129 -0.136052408  0.0428157515 -0.045661978  0.116976143
# SexM           0.17133376 -0.046944219 -0.0190461510  0.158644993 -0.195251247
# SexUN          0.14809464  0.264225603  0.1735493395  0.129215132 -0.083550583
# Age           -0.07623521  0.016137179  0.0130957568  0.055160722 -0.017658043
# RDA6          RDA7         RDA8
# SiteMatheson   0.064006550 -0.1488425578 -0.227464065
# SiteRed River  0.332711055  0.1960978880 -0.242042415
# SiteSandy Bar  0.352881085 -0.1247254231 -0.154658956
# FL             0.002969624 -0.0002272553  0.002713262
# W             -0.380379372  0.0419183993 -0.129690682
# SexM          -0.223911807 -0.2376243943  0.225252089
# SexUN          0.125708991 -0.1657106037 -0.184758456
# Age            0.025216630 -0.0520108032 -0.019029326
# rdA biplot
plot(RDA_met18factors, scaling=0)
plot(RDA_met18factors, scaling=1)
plot(RDA_met18factors, scaling=2) # this one good

anova(RDA_met18factors)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ Site + FL + W + Sex + Age, data = Factors)
# Df Variance      F Pr(>F)
# Model     8 0.012887 1.1897  0.316
# Residual 45 0.060930   
plot(RDA_met18factors, scaling=0)
plot(RDA_met18factors, scaling=1)
plot(RDA_met18factors, scaling=2)
plot(RDA_met18factors, scaling=3)
plot(RDA_met18factors, scaling=3, points(scrs$sites),
     with(scrs, text(species, labels = rownames(species),
                     col = "darkcyan", cex = 0.8)))
# didnt work
plot(RDA_met18factors, scaling=3, type="t") # yeah
#plot with all variables is pixelate dtho
plot(RDA_met18factors, type="n")
text(RDA_met18factors,display="cn")
points(RDA_met18factors,col="red")
text(RDA_met18factors, "species",  cex=0.8, col="blue")

anova(RDA_met18factors, by="term", permutations=199)
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ Site + FL + W + Sex + Age, data = Factors)
# Df Variance      F Pr(>F)  
# Site      3 0.003612 0.8892  0.525  
# FL        1 0.000893 0.6592  0.530  
# W         1 0.000247 0.1826  0.870  
# Sex       2 0.004792 1.7696  0.145  
# Age       1 0.003343 2.4692  0.090 .
# Residual 45 0.060930                
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

anova(RDA_met18factors, by="mar", permutations=199)
# Permutation test for rda under reduced model
# Marginal effects of terms
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ Site + FL + W + Sex + Age, data = Factors)
# Df Variance      F Pr(>F)  
# Site      3 0.002293 0.5644  0.705  
# FL        1 0.000760 0.5616  0.585  
# W         1 0.000768 0.5672  0.580  
# Sex       2 0.003194 1.1794  0.325  
# Age       1 0.003343 2.4692  0.085 .
# Residual 45 0.060930                
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

#### smaller model redundancy analysis constraint by the factor variables transformed ####
RDA_met18factors_small <- rda(Metabolites18T~.,Factors4_transformed)
summary(RDA_met18factors_small)
# Call:
#   rda(formula = Metabolites18T ~ FL + Age, data = Factors4_transformed) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         0.07382    1.00000
# Constrained   0.00516    0.06991
# Unconstrained 0.06866    0.93009
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#   RDA1      RDA2     PC1     PC2     PC3       PC4
# Eigenvalue            0.004812 0.0003487 0.05121 0.01308 0.00131 0.0006084
# Proportion Explained  0.065182 0.0047236 0.69374 0.17714 0.01775 0.0082416
# Cumulative Proportion 0.065182 0.0699060 0.76365 0.94079 0.95854 0.9667795
# PC5      PC6       PC7       PC8       PC9      PC10
# Eigenvalue            0.0004673 0.000384 0.0003192 0.0002509 0.0002169 0.0001669
# Proportion Explained  0.0063301 0.005202 0.0043245 0.0033989 0.0029387 0.0022605
# Cumulative Proportion 0.9731096 0.978311 0.9826357 0.9860346 0.9889733 0.9912338
# PC11      PC12      PC13      PC14      PC15      PC16
# Eigenvalue            0.0001376 0.0001147 6.847e-05 0.0000465 4.428e-05 3.537e-05
# Proportion Explained  0.0018647 0.0015532 9.275e-04 0.0006299 5.998e-04 4.792e-04
# Cumulative Proportion 0.9930985 0.9946517 9.956e-01 0.9962091 9.968e-01 9.973e-01
# PC17      PC18      PC19      PC20      PC21      PC22
# Eigenvalue            3.276e-05 2.643e-05 2.387e-05 1.855e-05 1.721e-05 1.255e-05
# Proportion Explained  4.437e-04 3.581e-04 3.233e-04 2.513e-04 2.332e-04 1.700e-04
# Cumulative Proportion 9.977e-01 9.981e-01 9.984e-01 9.987e-01 9.989e-01 9.991e-01
# PC23      PC24      PC25      PC26      PC27      PC28
# Eigenvalue            9.872e-06 8.923e-06 8.235e-06 6.371e-06 5.733e-06 4.861e-06
# Proportion Explained  1.337e-04 1.209e-04 1.116e-04 8.631e-05 7.767e-05 6.585e-05
# Cumulative Proportion 9.992e-01 9.993e-01 9.994e-01 9.995e-01 9.996e-01 9.997e-01
# PC29      PC30      PC31      PC32      PC33      PC34
# Eigenvalue            3.377e-06 3.257e-06 2.885e-06 2.542e-06 1.916e-06 1.681e-06
# Proportion Explained  4.575e-05 4.412e-05 3.908e-05 3.443e-05 2.595e-05 2.278e-05
# Cumulative Proportion 9.997e-01 9.998e-01 9.998e-01 9.998e-01 9.999e-01 9.999e-01
# PC35      PC36      PC37      PC38      PC39      PC40
# Eigenvalue            1.524e-06 1.270e-06 9.439e-07 9.061e-07 6.967e-07 6.840e-07
# Proportion Explained  2.064e-05 1.721e-05 1.279e-05 1.227e-05 9.439e-06 9.266e-06
# Cumulative Proportion 9.999e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01 1.000e+00
# PC41      PC42      PC43      PC44      PC45      PC46
# Eigenvalue            6.050e-07 4.683e-07 4.432e-07 3.743e-07 3.135e-07 2.675e-07
# Proportion Explained  8.196e-06 6.344e-06 6.004e-06 5.071e-06 4.247e-06 3.623e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# PC47      PC48      PC49      PC50      PC51
# Eigenvalue            2.120e-07 1.735e-07 1.140e-07 1.052e-07 6.537e-08
# Proportion Explained  2.871e-06 2.351e-06 1.545e-06 1.426e-06 8.855e-07
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#   RDA1      RDA2
# Eigenvalue            0.004812 0.0003487
# Proportion Explained  0.932429 0.0675708
# Cumulative Proportion 0.932429 1.0000000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  1.4064 
# 
# 
# Species scores
# 
# RDA1       RDA2        PC1        PC2        PC3
# Serine                      -8.269e-03  3.290e-03 -2.307e-03  4.233e-03 -1.272e-03
# Putrescine                   9.294e-04 -4.648e-05 -5.495e-04  1.721e-03  4.488e-04
# Trans_Hydroxyproline         3.502e-03 -9.989e-04 -1.535e-03  4.804e-03 -4.503e-04
# Asparagine                   3.120e-03 -7.914e-04 -1.840e-03  3.917e-03 -3.318e-04
# Glutamine                   -1.186e-03  8.128e-04 -2.072e-03  1.127e-03 -1.356e-04
# Alpha_Aminoadipic_Acid       2.194e-04 -2.809e-06 -2.228e-04  3.010e-04 -1.336e-04
# Methionine_Sulfoxide        -7.052e-04  3.045e-05 -1.810e-04  3.566e-04 -2.953e-04
# Acetyl_Ornithine             1.075e-04  1.336e-05 -6.660e-05  2.380e-04 -3.218e-05
# Citrulline                   3.239e-03 -3.598e-03  2.117e-03 -6.271e-03  4.144e-03
# Asymmetric_Dimethylarginine  6.617e-06  1.693e-05 -2.331e-05  9.231e-05  1.352e-05
# Total_Dimethylarginine       2.374e-06  3.271e-06  1.622e-05  1.547e-04  5.577e-05
# Tryptophan                   3.772e-04  3.362e-04 -2.046e-04  2.719e-03  8.373e-04
# Kynurenine                  -1.073e-05  6.590e-05 -7.349e-05  1.637e-05  4.122e-05
# Ornithine                   -8.794e-04  5.252e-04 -6.396e-04 -3.725e-04 -2.055e-04
# Lysine                      -4.930e-03  1.377e-03 -7.809e-04 -1.965e-03 -1.654e-03
# Spermidine                   1.640e-03  1.647e-05 -3.611e-04  1.620e-03  8.286e-04
# Spermine                     2.517e-03 -3.544e-04  7.423e-04  3.469e-03  1.397e-03
# Sarcosine                   -1.536e-03  9.790e-04 -7.309e-04  8.637e-04 -1.208e-03
# Methylhistidine             -1.785e-03 -7.437e-04  1.338e-03  3.193e-05  7.208e-04
# Beta_Hydroxybutyric_Acid     6.549e-04  1.980e-04  2.011e-03  2.941e-03  1.908e-03
# Alpha_Ketoglutaric_Acid      1.489e-04 -1.124e-03  1.066e-03  2.822e-03 -6.116e-04
# Butyric_acid                 6.784e-05 -1.801e-04  1.216e-04  2.663e-04  4.009e-05
# Propionic_Acid              -4.321e-04 -3.920e-03  2.857e-04  1.310e-03 -1.314e-03
# Fumaric_Acid                -5.140e-04  1.010e-03  1.281e-03  3.206e-03 -2.035e-04
# Isobutyric_Acid              2.710e-04 -2.043e-04  1.729e-04  4.980e-04  6.705e-05
# Hippuric_Acid                6.086e-07 -2.501e-06  2.290e-06  1.574e-06  1.812e-07
# Methylmalonic_Acid           7.035e-06  4.889e-08 -5.976e-06  8.132e-06 -2.488e-06
# LYSOC14_0                    1.145e-05 -1.308e-04 -8.260e-06  1.437e-04  8.057e-05
# LYSOC16_1                    8.520e-05 -2.362e-04 -1.451e-04  6.051e-04  1.841e-04
# LYSOC16_0                    1.672e-04 -7.701e-04 -1.242e-04  9.148e-04  9.375e-04
# LYSOC17_0                   -7.315e-06 -9.993e-05 -5.810e-05  1.142e-04  8.151e-05
# LYSOC18_2                   -2.201e-05 -1.485e-05 -1.038e-05  1.028e-04  3.907e-05
# LYSOC18_1                   -2.081e-04 -9.972e-05  2.612e-05  7.600e-04  2.057e-04
# LYSOC18_0                   -1.386e-04 -6.326e-06 -2.609e-05  2.323e-04  3.141e-05
# LYSOC20_4                    3.047e-04 -2.713e-06 -1.075e-04  7.637e-04  2.570e-04
# LYSOC20_3                    1.506e-05 -3.529e-04  9.449e-05  2.567e-04  3.691e-05
# LYSOC24_0                   -1.111e-04 -2.089e-04  8.867e-05  1.505e-04  2.223e-05
# LYSOC26_1                   -2.102e-05 -8.922e-05  1.630e-05  8.925e-05  1.396e-05
# LYSOC26_0                   -5.507e-05 -1.076e-04  2.755e-05  6.792e-05  2.713e-06
# LYSOC28_1                    1.407e-05 -7.889e-05  2.045e-05  1.024e-04  4.078e-05
# LYSOC28_0                   -2.917e-05 -7.403e-05  1.812e-05  6.586e-05  1.390e-05
# X14_1SMOH                    2.239e-04 -1.206e-04  8.492e-06  3.132e-04  2.230e-04
# X16_1SM                      5.810e-04 -1.689e-04  1.939e-04  1.256e-03  4.286e-04
# X16_0SM                      5.704e-04 -2.028e-04  1.174e-04  8.397e-04  4.364e-04
# X16_1SMOH                    7.272e-04 -2.431e-04 -7.032e-05  4.606e-04  3.500e-04
# X18_1SM                      6.935e-06 -7.565e-05 -6.341e-05  1.943e-04  9.504e-05
# PC32_2AA                    -1.355e-03  6.406e-05 -1.082e-03  6.794e-04  1.092e-03
# X18_0SM                     -4.941e-04  5.381e-05 -1.968e-04  3.790e-04  3.176e-04
# X20_2SM                     -1.412e-04 -5.508e-05 -4.181e-04  3.983e-04  4.188e-04
# PC36_0AE                     8.712e-04 -5.022e-04 -1.349e-04  1.186e-03  7.974e-04
# PC36_6AA                     2.147e-03 -1.842e-03 -4.923e-03  3.961e-03  4.629e-03
# PC36_0AA                     9.928e-03 -3.356e-03 -3.903e-03  6.859e-03  4.757e-03
# X22_2SMOH                    8.440e-04 -3.473e-04  3.049e-05  1.155e-03  7.988e-04
# X22_1SMOH                    2.045e-04 -1.339e-04 -2.542e-05  4.294e-04  3.086e-04
# PC38_6AA                     1.815e-02 -1.019e-02 -2.464e-02  3.620e-02  4.130e-02
# PC38_0AA                     4.128e-03 -1.895e-03 -1.719e-03  6.553e-03  4.822e-03
# PC40_6AE                     2.603e-03 -1.391e-03 -2.713e-03  5.104e-03  5.378e-03
# X24_1SMOH                    8.487e-05 -3.367e-04 -1.257e-04  6.917e-04  7.083e-04
# PC40_6AA                    -3.674e-03  1.118e-03 -2.532e-03  7.839e-03  4.594e-03
# PC40_2AA                     2.310e-05 -1.298e-04 -1.356e-06  1.755e-04  1.382e-04
# PC401AA                     -2.386e-05 -9.406e-05  3.214e-06  1.650e-04  1.333e-04
# C2                          -7.998e-04 -3.056e-04  1.522e-04  2.495e-03  9.954e-04
# C3_1                         4.437e-07 -2.900e-06  2.296e-06  6.439e-06  4.321e-06
# C3                           1.218e-04 -4.967e-05 -4.957e-05  2.301e-04  9.349e-05
# C4_1                         2.554e-06 -2.186e-06 -1.471e-06  6.967e-06  1.929e-06
# C4                           1.926e-05 -1.532e-06  1.158e-05  5.673e-05  2.871e-05
# C3OH                         3.639e-07 -7.457e-07 -7.133e-07  1.216e-06  2.855e-07
# C5_1                         7.188e-07 -1.306e-06  5.695e-07  1.767e-06  5.132e-07
# C5                           3.768e-05  5.732e-06 -1.537e-05  4.862e-05  1.468e-05
# C4OH                         8.697e-06 -1.037e-06  1.005e-05  1.848e-05  1.166e-05
# C6_1                         6.837e-06 -1.141e-05  8.432e-06  1.425e-05  2.069e-06
# C6                          -3.777e-06 -4.161e-05  5.141e-05  9.635e-05  4.692e-05
# C5OH                         1.037e-06 -3.666e-06 -2.878e-06  1.197e-05  6.400e-06
# C5_1DC                       5.565e-06 -3.909e-06  2.915e-06  1.328e-05  5.045e-06
# C5DC                        -2.024e-06 -1.016e-05  7.787e-06  3.190e-05  9.513e-06
# C8                          -5.643e-06 -5.783e-06  1.537e-05  3.698e-05  2.517e-05
# C5MDC                        1.165e-07 -9.071e-07  1.397e-06  1.373e-06  2.831e-07
# C9                          -1.456e-07 -1.100e-07  1.825e-06  2.548e-06  1.962e-06
# C7DC                        -7.605e-07  1.544e-06 -4.195e-06  8.670e-07  7.538e-07
# C10_2                       -4.049e-06 -5.153e-06  7.759e-06  7.698e-06  7.363e-06
# C10_1                       -3.456e-07 -6.611e-06  7.391e-06  1.031e-05  6.173e-08
# C10                         -2.325e-07 -4.944e-06  6.471e-06  6.640e-06  1.281e-06
# C12_1                        3.958e-07 -1.618e-06  4.443e-06  7.897e-06  4.003e-06
# C12                         -2.759e-07 -1.723e-06  3.872e-06  4.772e-06  3.848e-06
# C14_2                        1.982e-07 -4.789e-07  1.168e-06  1.901e-06  1.773e-06
# C14_1                        7.341e-07 -1.329e-06  1.178e-05  2.185e-05  1.824e-05
# C14                          1.212e-06 -8.540e-07  1.317e-05  1.900e-05  1.885e-05
# C12DC                       -2.914e-07 -4.208e-07  1.555e-06  1.043e-06  1.642e-06
# C14_2OH                     -4.033e-07 -2.068e-07  3.542e-06  4.279e-06  4.567e-06
# C14_1OH                      1.134e-06 -2.758e-07  8.299e-06  1.141e-05  1.233e-05
# C16_2                       -5.143e-07 -1.751e-07  1.553e-06  2.005e-06  1.494e-06
# C16_1                       -6.679e-06  1.321e-06  2.985e-05  3.774e-05  3.595e-05
# C16                          2.454e-06 -1.551e-06  2.511e-05  3.289e-05  3.958e-05
# C16_2OH                      2.871e-07 -9.122e-07  3.947e-06  6.043e-06  6.166e-06
# C16_1OH                      1.249e-06 -8.890e-07  5.960e-06  9.776e-06  1.118e-05
# C16OH                        5.026e-07  7.256e-08  1.705e-06  2.029e-06  2.320e-06
# C18_2                       -1.075e-06  1.461e-07  4.500e-06  6.531e-06  6.197e-06
# C18_1                       -5.498e-06 -3.275e-07  3.424e-05  4.517e-05  5.219e-05
# C18                          4.356e-07 -8.049e-07  6.218e-06  7.840e-06  1.095e-05
# C18_1OH                      4.061e-08 -2.303e-07  2.814e-06  3.604e-06  3.625e-06
# Arginine_Average            -5.802e-03  3.152e-03 -2.612e-03 -1.197e-03 -1.417e-04
# Betaine_Average             -3.128e-03  1.786e-03  5.812e-03 -2.760e-04  8.320e-04
# C0_Average                  -5.895e-04 -1.259e-03  1.662e-03  3.274e-03  2.655e-03
# Choline_Average             -2.859e-03 -5.645e-04 -2.538e-03 -7.744e-04  2.934e-03
# Citrate_Average              2.959e-02  1.431e-02  1.593e-02  5.354e-02  1.821e-02
# Creatine_Average             3.141e-02 -3.438e-02  2.948e-02  9.136e-02  9.814e-02
# Creatinine_Average           6.893e-04 -2.112e-04  2.515e-04  1.952e-03  1.023e-03
# Glucose_Average             -2.889e-01 -2.821e-02 -8.977e-01 -2.035e-01 -7.066e-02
# Glutamate_Average           -3.605e-03  2.104e-03 -8.347e-04  4.888e-03  3.106e-04
# Glycine_Average             -1.650e-02  3.939e-03 -2.397e-03  4.027e-02  4.748e-03
# Histidine_Average           -3.234e-04  5.725e-04 -2.563e-03  3.139e-03  1.701e-03
# Isoleucine_Average           4.473e-03 -1.940e-04 -1.078e-03  1.627e-02  3.455e-03
# Lactate_Average              3.038e-02  6.705e-02 -6.156e-03  4.827e-01 -9.858e-02
# Leucine                     -2.693e-03  1.320e-03  2.527e-03  1.137e-02  3.351e-03
# Methionine                  -8.241e-04  1.624e-03 -6.519e-04  1.463e-03 -3.022e-05
# Phenylalanine_Average       -2.526e-03  2.338e-03 -2.175e-03  5.108e-03 -8.660e-04
# Proline                      8.449e-03 -1.251e-04 -4.083e-03  9.331e-03 -6.865e-04
# Pyruvate_Average            -9.800e-03 -2.520e-04  1.079e-03  7.840e-03 -5.419e-03
# Succinate_Average           -6.516e-04 -8.851e-05  3.819e-04  6.707e-04 -2.403e-04
# Threonine_Average           -3.519e-03  1.828e-03 -6.137e-03  1.110e-02  3.296e-03
# Tyrosine_Average            -4.669e-03  3.005e-03  6.069e-04  8.749e-03  1.003e-03
# Valine_Average               7.586e-03 -1.070e-03 -1.686e-03  3.064e-02  3.870e-03
# X1_Methylhistidine          -2.232e-04 -3.444e-04  2.178e-04  1.308e-04  3.319e-04
# X2_Hydroxybutyrate           6.601e-04 -4.071e-04  1.244e-03  2.152e-03  1.763e-04
# X2_Hydroxyisovaleric_Acid    3.770e-04 -3.138e-05  2.884e-04  8.505e-05 -4.414e-05
# X3_Hydroxybutyrate           5.006e-04  1.598e-04  2.202e-03  3.101e-03  1.953e-03
# ADP                         -3.805e-03  2.661e-03  7.553e-03 -1.251e-02  1.679e-04
# AMP                         -5.310e-03 -2.229e-03  8.159e-03 -8.384e-04 -3.121e-03
# ATP                          5.162e-03  1.928e-03  2.806e-03 -5.634e-03 -1.563e-04
# Acetamide                   -5.029e-04 -4.586e-04  9.606e-04 -1.097e-03 -6.052e-04
# Acetate                      3.101e-03  8.912e-04  8.652e-03  4.397e-03  1.791e-03
# Acetoacetate                -1.496e-03 -2.543e-03  1.389e-03  5.094e-03 -2.136e-03
# Acetone                      1.270e-04  1.261e-05  3.159e-04  2.727e-04  1.432e-04
# Adenosine                   -1.287e-02  3.023e-03  2.442e-02  8.529e-04  3.068e-03
# Alanine                      3.423e-03  8.167e-03  4.867e-03 -2.730e-04 -1.249e-02
# Aspartate                    1.083e-03  1.432e-04  9.337e-04  1.098e-03 -5.460e-04
# Creatine_Phosphate          -1.221e-04  3.553e-04  2.410e-04 -2.767e-04 -3.080e-04
# Cytidine                    -1.323e-05 -3.198e-04  9.442e-04  2.354e-05 -8.457e-04
# Dimethyl_Sulfone             1.116e-03 -1.983e-05  6.550e-04  6.465e-04 -1.016e-04
# Ethanol                      1.487e-04 -4.222e-04  1.140e-04 -2.369e-04 -1.537e-05
# Ethanolamine                -2.740e-03  1.329e-03  9.302e-03 -1.245e-02  1.501e-03
# Formate                      7.520e-04 -1.387e-03  1.140e-03 -7.999e-04  3.321e-04
# Glycerol                     1.440e-03 -2.499e-03  1.506e-02 -3.530e-03  5.709e-03
# Guanidoacetate              -1.315e-03 -1.981e-04  7.781e-03 -1.411e-03 -8.193e-03
# Guanosine                   -1.206e-02 -1.263e-03  1.520e-02 -8.512e-03 -3.920e-04
# Hypoxanthine                -2.010e-03 -1.261e-03  3.110e-03 -7.774e-04  2.262e-04
# IMP                          3.301e-03 -8.015e-04  8.613e-03  1.231e-02 -4.668e-03
# Inosine                      2.111e-02  1.568e-03  1.221e-02  5.243e-03 -2.116e-03
# Isopropanol                  5.615e-06 -5.799e-05  5.331e-05 -5.641e-05  4.431e-06
# Malate                       1.468e-04  2.292e-03  3.253e-03  1.464e-03 -8.141e-04
# Malonate                     8.331e-04 -1.504e-03  3.758e-03  4.898e-04  2.818e-03
# Mannose                     -1.496e-03 -7.742e-07 -9.441e-05  1.320e-03 -2.107e-03
# Methanol                     1.044e-03 -9.142e-03  3.188e-03  5.214e-03 -3.052e-03
# N_N_Dimethylglycine         -4.838e-04 -4.433e-04  1.705e-03 -5.863e-04 -5.354e-04
# Nicotinurate                 1.637e-03  1.540e-03  1.722e-03  6.441e-04 -3.940e-04
# O_Acetylcarnitine           -6.618e-04 -4.153e-04  4.212e-04  2.456e-03  9.557e-04
# O_Phosphocholine             9.309e-04 -6.018e-04  2.548e-03 -5.360e-04 -8.565e-04
# Propylene_Glycol             4.794e-04 -5.015e-04  1.632e-03  2.584e-03  1.844e-04
# Taurine                      2.013e-01 -4.530e-02  7.500e-01 -2.425e-01 -8.788e-02
# Uridine                      3.977e-05  3.844e-04  1.097e-03  1.086e-03 -4.719e-04
# Xanthine                     1.452e-04 -4.132e-05  1.193e-04 -5.013e-05 -7.912e-05
# sn_Glycero_3_Phosphocholine -2.313e-03 -4.558e-03  1.438e-03 -1.182e-02  4.864e-04
# Beta.Alanine                 2.796e-03 -1.215e-02  8.501e-03 -9.052e-04 -1.954e-02
# PC4
# Serine                       8.148e-04
# Putrescine                   1.244e-03
# Trans_Hydroxyproline         3.487e-03
# Asparagine                   3.670e-03
# Glutamine                    1.188e-03
# Alpha_Aminoadipic_Acid       2.358e-04
# Methionine_Sulfoxide         5.233e-04
# Acetyl_Ornithine             5.572e-05
# Citrulline                  -1.197e-02
# Asymmetric_Dimethylarginine  4.944e-05
# Total_Dimethylarginine       9.167e-05
# Tryptophan                   7.899e-04
# Kynurenine                   1.324e-05
# Ornithine                    3.362e-05
# Lysine                       4.274e-04
# Spermidine                   7.188e-04
# Spermine                    -1.144e-03
# Sarcosine                   -7.575e-04
# Methylhistidine              2.044e-03
# Beta_Hydroxybutyric_Acid    -2.668e-04
# Alpha_Ketoglutaric_Acid     -7.418e-04
# Butyric_acid                -4.400e-05
# Propionic_Acid              -2.293e-03
# Fumaric_Acid                -3.198e-04
# Isobutyric_Acid              6.939e-05
# Hippuric_Acid                8.545e-08
# Methylmalonic_Acid           4.288e-07
# LYSOC14_0                   -2.615e-04
# LYSOC16_1                   -1.049e-03
# LYSOC16_0                   -4.823e-03
# LYSOC17_0                   -3.065e-04
# LYSOC18_2                   -5.196e-05
# LYSOC18_1                   -3.719e-04
# LYSOC18_0                   -1.476e-04
# LYSOC20_4                   -7.585e-06
# LYSOC20_3                   -4.038e-04
# LYSOC24_0                   -2.281e-04
# LYSOC26_1                   -5.961e-05
# LYSOC26_0                   -1.132e-04
# LYSOC28_1                   -8.649e-05
# LYSOC28_0                   -5.909e-05
# X14_1SMOH                   -2.769e-04
# X16_1SM                     -2.288e-04
# X16_0SM                     -1.675e-04
# X16_1SMOH                   -3.202e-04
# X18_1SM                     -1.199e-04
# PC32_2AA                    -2.564e-03
# X18_0SM                     -1.064e-03
# X20_2SM                     -5.462e-04
# PC36_0AE                    -4.819e-04
# PC36_6AA                    -5.528e-03
# PC36_0AA                    -9.970e-04
# X22_2SMOH                   -4.726e-04
# X22_1SMOH                   -2.203e-04
# PC38_6AA                    -5.317e-02
# PC38_0AA                    -2.821e-03
# PC40_6AE                    -5.499e-03
# X24_1SMOH                   -7.639e-04
# PC40_6AA                    -3.568e-03
# PC40_2AA                    -1.478e-04
# PC401AA                     -1.350e-04
# C2                           4.074e-04
# C3_1                         4.215e-06
# C3                           1.179e-04
# C4_1                        -1.646e-06
# C4                           9.116e-06
# C3OH                        -1.375e-06
# C5_1                         1.527e-07
# C5                           3.486e-05
# C4OH                        -2.533e-06
# C6_1                        -8.595e-06
# C6                          -4.501e-05
# C5OH                        -2.844e-06
# C5_1DC                      -4.618e-06
# C5DC                         1.694e-06
# C8                          -1.773e-05
# C5MDC                       -1.356e-06
# C9                          -1.540e-06
# C7DC                        -1.716e-06
# C10_2                       -9.356e-06
# C10_1                       -7.466e-06
# C10                         -7.452e-06
# C12_1                       -4.195e-06
# C12                         -4.020e-06
# C14_2                       -1.391e-06
# C14_1                       -1.355e-05
# C14                         -1.270e-05
# C12DC                       -1.803e-06
# C14_2OH                     -3.926e-06
# C14_1OH                     -8.467e-06
# C16_2                       -1.758e-06
# C16_1                       -3.184e-05
# C16                         -2.748e-05
# C16_2OH                     -5.119e-06
# C16_1OH                     -8.629e-06
# C16OH                       -1.138e-06
# C18_2                       -5.116e-06
# C18_1                       -3.917e-05
# C18                         -9.187e-06
# C18_1OH                     -2.553e-06
# Arginine_Average             1.679e-03
# Betaine_Average             -8.272e-03
# C0_Average                   8.520e-05
# Choline_Average             -5.442e-03
# Citrate_Average              3.311e-03
# Creatine_Average             9.063e-02
# Creatinine_Average           1.401e-03
# Glucose_Average              3.440e-02
# Glutamate_Average            2.057e-03
# Glycine_Average              8.177e-03
# Histidine_Average            2.749e-03
# Isoleucine_Average           9.963e-03
# Lactate_Average              1.548e-02
# Leucine                      1.170e-02
# Methionine                   1.807e-03
# Phenylalanine_Average        5.678e-04
# Proline                      7.247e-03
# Pyruvate_Average            -5.647e-04
# Succinate_Average           -3.942e-04
# Threonine_Average            4.426e-03
# Tyrosine_Average             4.102e-03
# Valine_Average               1.441e-02
# X1_Methylhistidine          -3.101e-04
# X2_Hydroxybutyrate           3.635e-04
# X2_Hydroxyisovaleric_Acid   -2.064e-04
# X3_Hydroxybutyrate          -4.031e-04
# ADP                         -1.159e-02
# AMP                         -1.011e-03
# ATP                         -4.863e-03
# Acetamide                   -1.479e-03
# Acetate                     -3.087e-03
# Acetoacetate                 1.097e-03
# Acetone                     -1.324e-04
# Adenosine                   -2.592e-03
# Alanine                      7.227e-04
# Aspartate                    8.859e-04
# Creatine_Phosphate          -3.157e-04
# Cytidine                     7.145e-05
# Dimethyl_Sulfone             3.861e-05
# Ethanol                      4.129e-05
# Ethanolamine                -1.287e-02
# Formate                     -7.009e-04
# Glycerol                    -5.815e-03
# Guanidoacetate              -8.757e-03
# Guanosine                   -7.177e-03
# Hypoxanthine                -1.609e-03
# IMP                          7.506e-03
# Inosine                      1.579e-02
# Isopropanol                 -9.039e-05
# Malate                      -9.288e-04
# Malonate                     1.350e-03
# Mannose                      1.423e-03
# Methanol                     7.794e-04
# N_N_Dimethylglycine         -3.265e-04
# Nicotinurate                -3.664e-04
# O_Acetylcarnitine            6.642e-04
# O_Phosphocholine             3.905e-04
# Propylene_Glycol             5.085e-04
# Taurine                      3.679e-02
# Uridine                      2.903e-04
# Xanthine                    -2.337e-05
# sn_Glycero_3_Phosphocholine -4.225e-03
# Beta.Alanine                -2.469e-02
# 
# 
# Site scores (weighted sums of species scores)
# 
# RDA1     RDA2       PC1      PC2       PC3       PC4
# row1  -1.050571  0.33489 -0.246877 -0.04177  0.256708 -0.229530
# row2  -0.650994 -0.47705 -0.189705 -0.03958  0.240484  0.149453
# row3   0.643745 -1.42398  0.278655 -0.21077  0.102617 -0.034520
# row4  -0.617638 -0.23449 -0.149114 -0.07923 -0.077594 -0.035512
# row5  -1.110094 -0.39580 -0.256490 -0.18697  0.332905 -0.001218
# row6  -0.206979 -0.60508  0.027713 -0.17536 -0.091337  0.146451
# row7  -0.738536  1.32469 -0.163520  0.11819  0.008848 -0.153191
# row8  -0.274039  0.19273 -0.065786  0.02866 -0.205766 -0.113328
# row9   0.455306 -0.31773  0.229178 -0.12980 -0.079396  0.117161
# row10  1.072699  0.66898  0.367490  0.17269 -0.006329 -0.370078
# row11 -0.193621  0.32497 -0.087547  0.04355 -0.233265  0.150387
# row12  0.651510 -1.45207  0.188664 -0.24074  0.055007 -0.133006
# row13 -0.374888  1.27561 -0.069391  0.24568 -0.081972 -0.059270
# row14  0.679149  0.32546  0.274945  0.08410 -0.178308 -0.094292
# row15  0.863093 -1.61298  0.184863 -0.32766  0.112061 -0.251164
# row16 -0.091123  1.09779  0.006797  0.20335 -0.235268 -0.131843
# row17  0.330464 -0.88196  0.078080 -0.17404 -0.138998 -0.267256
# row18 -0.318544 -1.47411 -0.101808 -0.27073  0.119155 -0.030608
# row19  0.785793 -2.25838  0.277341 -0.39255  0.226769 -0.285345
# row20 -1.086858  1.08173 -0.394602  0.12788  0.265987 -0.583448
# row21 -0.265327 -0.28513 -0.052454 -0.03975 -0.088349 -0.027715
# row22 -0.170681 -1.28113 -0.037601 -0.23847 -0.053333  0.043477
# row23  0.624866 -0.85230  0.168258 -0.10328  0.085915  0.039399
# row24  0.488838 -1.28305  0.167861 -0.21076 -0.003443 -0.137383
# row25  0.101709 -0.14465 -0.033448 -0.06530 -0.279948 -0.099158
# row26  0.501080 -1.40858  0.155000 -0.23463 -0.024412  0.116761
# row27 -0.715124 -0.43487 -0.201696 -0.03565  0.220242  0.010219
# row28 -0.753536  0.43570 -0.193653  0.05243 -0.008123 -0.100312
# row29 -0.298155  0.04328 -0.066092  0.02040 -0.164937  0.236539
# row30  0.142500 -0.76999 -0.015217 -0.16163 -0.185352  0.140324
# row31 -0.918746  0.95466 -0.309982  0.17132  0.199313  0.178552
# row32 -0.642140 -0.17649 -0.241967 -0.07427 -0.015839  0.122241
# row33  0.945125 -0.08602  0.278503  0.17187  0.427828  0.441184
# row34 -0.176911  1.32071  0.011196  0.17207 -0.207675  0.018736
# row35  0.482400  2.09315  0.159023  0.47927 -0.051823  0.038322
# row36 -0.009879 -0.49997 -0.040247 -0.09308 -0.131347  0.031661
# row37  0.815425 -0.93368  0.315500 -0.08279  0.136051  0.220438
# row38  0.776942 -0.93747  0.280351 -0.07894  0.130122  0.152299
# row39  0.186757 -0.80657  0.123388 -0.12869 -0.133894  0.074464
# row40 -0.757870 -0.02851 -0.165062 -0.05979  0.030418  0.116301
# row41 -0.562165  0.59295 -0.244550  0.04912 -0.102499  0.033658
# row42 -0.473219  0.45174 -0.205794  0.07841  0.030816  0.281224
# row43  1.232353  2.36203  0.286081  0.56795  0.575426 -0.255645
# row44 -0.380229 -0.11108 -0.185014 -0.06005 -0.097194  0.194412
# row45  0.378665  0.06996  0.003412 -0.06209 -0.296086 -0.073292
# row46  1.001923  1.75228  0.096581  0.28209  0.126998  0.125070
# row47  0.014154  0.47144  0.006834  0.12452 -0.284407 -0.326727
# row48  0.507832  0.52199  0.091145  0.11135 -0.178556 -0.072504
# row49 -0.457991  0.31714 -0.139247  0.03502 -0.157353  0.079193
# row50  0.896526  0.50793  0.158892  0.11971  0.110693  0.190031
# row51 -0.125279  1.94965 -0.049212  0.36135 -0.249785 -0.201564
# row52 -1.139534 -0.39444 -0.344150 -0.12390  0.356154 -0.008664
# row53  0.416973  1.01071  0.156045  0.26201 -0.085746  0.321688
# row54 -0.435156  0.08541 -0.121566  0.03927 -0.022183  0.306928
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# RDA1      RDA2       PC1      PC2       PC3       PC4
# row1  -0.253967  0.295362 -0.246877 -0.04177  0.256708 -0.229530
# row2  -0.043453 -0.137755 -0.189705 -0.03958  0.240484  0.149453
# row3  -0.198415 -0.036333  0.278655 -0.21077  0.102617 -0.034520
# row4  -0.120824 -0.125417 -0.149114 -0.07923 -0.077594 -0.035512
# row5  -0.253884  0.291740 -0.256490 -0.18697  0.332905 -0.001218
# row6  -0.254510  0.344676  0.027713 -0.17536 -0.091337  0.146451
# row7  -0.244242  0.595015 -0.163520  0.11819  0.008848 -0.153191
# row8  -0.057814 -0.138779 -0.065786  0.02866 -0.205766 -0.113328
# row9  -0.241538  0.629562  0.229178 -0.12980 -0.079396  0.117161
# row10 -0.129024 -0.120903  0.367490  0.17269 -0.006329 -0.370078
# row11  0.099451 -0.077364 -0.087547  0.04355 -0.233265  0.150387
# row12  0.105179 -0.073534  0.188664 -0.24074  0.055007 -0.133006
# row13 -0.204368 -0.022789 -0.069391  0.24568 -0.081972 -0.059270
# row14 -0.211500 -0.004228  0.274945  0.08410 -0.178308 -0.094292
# row15  0.354462  0.155034  0.184863 -0.32766  0.112061 -0.251164
# row16 -0.151933 -0.103567  0.006797  0.20335 -0.235268 -0.131843
# row17  0.131675 -0.054757  0.078080 -0.17404 -0.138998 -0.267256
# row18  0.059300 -0.101667 -0.101808 -0.27073  0.119155 -0.030608
# row19 -0.017785 -0.133067  0.277341 -0.39255  0.226769 -0.285345
# row20  0.129043 -0.056697 -0.394602  0.12788  0.265987 -0.583448
# row21 -0.071367 -0.138550 -0.052454 -0.03975 -0.088349 -0.027715
# row22  0.006800 -0.125600 -0.037601 -0.23847 -0.053333  0.043477
# row23  0.118477 -0.064323  0.168258 -0.10328  0.085915  0.039399
# row24  0.005265 -0.126143  0.167861 -0.21076 -0.003443 -0.137383
# row25  0.227081  0.025213 -0.033448 -0.06530 -0.279948 -0.099158
# row26  0.055663 -0.103632  0.155000 -0.23463 -0.024412  0.116761
# row27 -0.080672 -0.137651 -0.201696 -0.03565  0.220242  0.010219
# row28 -0.153709 -0.101889 -0.193653  0.05243 -0.008123 -0.100312
# row29 -0.084553 -0.137084 -0.066092  0.02040 -0.164937  0.236539
# row30  0.233201  0.030910 -0.015217 -0.16163 -0.185352  0.140324
# row31  0.030544 -0.116007 -0.309982  0.17132  0.199313  0.178552
# row32  0.147373 -0.042859 -0.241967 -0.07427 -0.015839  0.122241
# row33  0.006417 -0.125737  0.278503  0.17187  0.427828  0.441184
# row34 -0.253329  0.424308  0.011196  0.17207 -0.207675  0.018736
# row35 -0.126425 -0.122420  0.159023  0.47927 -0.051823  0.038322
# row36  0.139870 -0.048614 -0.040247 -0.09308 -0.131347  0.031661
# row37 -0.183425 -0.064346  0.315500 -0.08279  0.136051  0.220438
# row38 -0.104987 -0.132039  0.280351 -0.07894  0.130122  0.152299
# row39 -0.178211 -0.072433  0.123388 -0.12869 -0.133894  0.074464
# row40 -0.227004  0.048470 -0.165062 -0.05979  0.030418  0.116301
# row41  0.211023  0.010561 -0.244550  0.04912 -0.102499  0.033658
# row42  0.155164 -0.036754 -0.205794  0.07841  0.030816  0.281224
# row43  0.168058 -0.026370  0.286081  0.56795  0.575426 -0.255645
# row44  0.220929  0.019548 -0.185014 -0.06005 -0.097194  0.194412
# row45  0.389206  0.194006  0.003412 -0.06209 -0.296086 -0.073292
# row46  0.629352  0.494096  0.096581  0.28209  0.126998  0.125070
# row47 -0.034686 -0.136544  0.006834  0.12452 -0.284407 -0.326727
# row48  0.196016 -0.002727  0.091145  0.11135 -0.178556 -0.072504
# row49 -0.017785 -0.133067 -0.139247  0.03502 -0.157353  0.079193
# row50  0.349002  0.149034  0.158892  0.11971  0.110693  0.190031
# row51 -0.048869 -0.138286 -0.049212  0.36135 -0.249785 -0.201564
# row52 -0.025689 -0.134873 -0.344150 -0.12390  0.356154 -0.008664
# row53 -0.139320 -0.114041  0.156045  0.26201 -0.085746  0.321688
# row54 -0.055261 -0.138689 -0.121566  0.03927 -0.022183  0.306928
# 
# 
# Biplot scores for constraining variables
# 
#       RDA1    RDA2 PC1 PC2 PC3 PC4
# FL   0.8700 -0.4930   0   0   0   0
# Age -0.9293  0.3692   0   0   0   0

coef(RDA_met18factors_small)
# RDA1        RDA2
# FL  -6517.1637 -16404.0431
# Age  -141.3013   -249.3445
plot(RDA_met18factors_small, scaling=0)
plot(RDA_met18factors_small, scaling=1)
plot(RDA_met18factors_small, scaling=2) # this one good

anova(RDA_met18factors_small)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ FL + Age, data = Factors4_transformed)
#              Df Variance      F Pr(>F)
# Model     2 0.005160 1.9166  0.128
# Residual 51 0.068657   
plot(RDA_met18factors_small, scaling=0)
plot(RDA_met18factors_small, scaling=1)
plot(RDA_met18factors_small, scaling=2)
plot(RDA_met18factors_small, scaling=3)
plot(RDA_met18factors_small, scaling=3, points(scrs$sites),
     with(scrs, text(species, labels = rownames(species),
                     col = "darkcyan", cex = 0.8)))
# didnt work
plot(RDA_met18factors_small, scaling=1, type="t") # yeah
#plot with all variables is pixelate dtho
plot(RDA_met18factors_small, type="n")
text(RDA_met18factors_small,display="cn")
points(RDA_met18factors_small,col="red")
text(RDA_met18factors_small, "species",  cex=0.8, col="blue")

plot(RDA_met18factors_small, type="n")
text(RDA_met18factors_small,display="cn")
points(RDA_met18factors_small,col="red")
text(RDA_met18factors_small, "sites",  cex=0.8, col="blue")

anova(RDA_met18factors_small, by="term", permutations=199)
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ FL + Age, data = Factors4_transformed)
# Df Variance      F Pr(>F)  
# FL        1 0.003727 2.7683  0.095 .
# Age       1 0.001434 1.0648  0.285  
# Residual 51 0.068657                
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

anova(RDA_met18factors_small, by="mar", permutations=199)
# Permutation test for rda under reduced model
# Marginal effects of terms
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ FL + Age, data = Factors4_transformed)
# Df Variance      F Pr(>F)
# FL        1 0.000957 0.7109   0.49
# Age       1 0.001434 1.0648   0.27
# Residual 51 0.068657   

####  3 smaller model redundancy analysis constraint by the factor variables not transformed ####

factors3 <- Factors4[, c(1,3,4)]

RDA_met18factors_small3 <- rda(Metabolites18T~.,factors3)
summary(RDA_met18factors_small3)
# Call:
#   rda(formula = Metabolites18T ~ Site + Sex + Age, data = factors3) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         0.073818     1.0000
# Constrained   0.009812     0.1329
# Unconstrained 0.064006     0.8671
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#   RDA1     RDA2      RDA3     RDA4      RDA5      RDA6
# Eigenvalue            0.004906 0.004255 0.0003147 0.000157 0.0001176 0.0000621
# Proportion Explained  0.066462 0.057636 0.0042627 0.002127 0.0015931 0.0008413
# Cumulative Proportion 0.066462 0.124098 0.1283609 0.130488 0.1320812 0.1329224
# PC1      PC2      PC3       PC4       PC5       PC6
# Eigenvalue            0.0511 0.009351 0.001279 0.0005257 0.0004065 0.0002669
# Proportion Explained  0.6922 0.126680 0.017327 0.0071215 0.0055067 0.0036163
# Cumulative Proportion 0.8252 0.951852 0.969179 0.9763005 0.9818072 0.9854234
# PC7       PC8       PC9      PC10      PC11      PC12
# Eigenvalue            0.0002133 0.0001573 0.0001349 0.0001079 8.599e-05 5.999e-05
# Proportion Explained  0.0028896 0.0021313 0.0018280 0.0014615 1.165e-03 8.127e-04
# Cumulative Proportion 0.9883130 0.9904443 0.9922723 0.9937337 9.949e-01 9.957e-01
# PC13      PC14      PC15      PC16      PC17      PC18
# Eigenvalue            5.771e-05 3.889e-05 3.585e-05 2.919e-05 2.479e-05 2.148e-05
# Proportion Explained  7.818e-04 5.268e-04 4.857e-04 3.955e-04 3.359e-04 2.910e-04
# Cumulative Proportion 9.965e-01 9.970e-01 9.975e-01 9.979e-01 9.982e-01 9.985e-01
# PC19      PC20      PC21      PC22      PC23      PC24
# Eigenvalue            1.678e-05 1.475e-05 1.202e-05 1.097e-05 8.740e-06 6.457e-06
# Proportion Explained  2.273e-04 1.999e-04 1.629e-04 1.486e-04 1.184e-04 8.748e-05
# Cumulative Proportion 9.988e-01 9.990e-01 9.991e-01 9.993e-01 9.994e-01 9.995e-01
# PC25      PC26      PC27      PC28      PC29      PC30
# Eigenvalue            6.289e-06 5.358e-06 4.578e-06 3.567e-06 2.931e-06 2.812e-06
# Proportion Explained  8.519e-05 7.259e-05 6.202e-05 4.833e-05 3.971e-05 3.809e-05
# Cumulative Proportion 9.996e-01 9.996e-01 9.997e-01 9.997e-01 9.998e-01 9.998e-01
# PC31      PC32      PC33      PC34      PC35      PC36
# Eigenvalue            2.627e-06 1.583e-06 1.386e-06 1.255e-06 1.225e-06 1.062e-06
# Proportion Explained  3.559e-05 2.145e-05 1.878e-05 1.700e-05 1.659e-05 1.439e-05
# Cumulative Proportion 9.999e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01
# PC37      PC38      PC39      PC40      PC41      PC42
# Eigenvalue            8.354e-07 6.444e-07 5.626e-07 5.105e-07 4.697e-07 3.770e-07
# Proportion Explained  1.132e-05 8.730e-06 7.621e-06 6.915e-06 6.362e-06 5.107e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# PC43      PC44      PC45      PC46      PC47
# Eigenvalue            2.680e-07 2.107e-07 1.518e-07 1.277e-07 1.076e-07
# Proportion Explained  3.631e-06 2.855e-06 2.056e-06 1.730e-06 1.457e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#   RDA1     RDA2      RDA3     RDA4      RDA5      RDA6
# Eigenvalue            0.004906 0.004255 0.0003147 0.000157 0.0001176 0.0000621
# Proportion Explained  0.500006 0.433607 0.0320693 0.016003 0.0119855 0.0063292
# Cumulative Proportion 0.500006 0.933613 0.9656827 0.981685 0.9936708 1.0000000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  1.4064 
# 
# 
# Species scores
# 
# RDA1       RDA2       RDA3       RDA4       RDA5
# Serine                      -9.714e-03  1.252e-03 -1.093e-02  6.214e-03 -8.104e-03
# Putrescine                  -3.707e-04 -1.988e-03  1.312e-03  1.710e-03  2.130e-04
# Trans_Hydroxyproline        -1.898e-04 -7.012e-03  1.354e-03  2.018e-03  4.667e-03
# Asparagine                  -8.098e-04 -6.068e-03  1.482e-03  2.010e-03  4.516e-03
# Glutamine                   -3.141e-03 -1.848e-03 -1.371e-03  1.086e-03 -2.439e-04
# Alpha_Aminoadipic_Acid       2.633e-04 -5.841e-04 -4.609e-04  6.831e-04  1.992e-05
# Methionine_Sulfoxide        -1.057e-03 -6.362e-05 -4.424e-04  4.905e-04 -2.293e-04
# Acetyl_Ornithine            -1.911e-05 -9.719e-05 -5.583e-05 -1.836e-05  1.419e-04
# Citrulline                   1.360e-02  1.743e-02 -3.217e-03 -2.314e-02  1.383e-02
# Asymmetric_Dimethylarginine -4.858e-05 -9.373e-05  5.897e-06  4.689e-05  7.443e-06
# Total_Dimethylarginine      -9.280e-05 -1.483e-04 -1.030e-05  8.856e-05  1.922e-05
# Tryptophan                  -7.323e-04 -2.643e-03 -7.827e-04  3.703e-04  1.250e-03
# Kynurenine                  -4.753e-05 -7.326e-05 -4.116e-05 -1.453e-05  5.886e-06
# Ornithine                   -1.255e-03  5.741e-04 -1.361e-03  1.072e-03 -1.003e-03
# Lysine                      -5.160e-03  4.126e-03 -5.611e-03  6.576e-03 -4.747e-03
# Spermidine                   1.683e-04 -2.044e-03  5.807e-04  1.731e-03  1.123e-03
# Spermine                     1.524e-03 -2.331e-03 -3.687e-04  2.538e-03  2.028e-03
# Sarcosine                   -3.205e-03 -1.853e-04 -3.900e-03  1.722e-03 -1.136e-03
# Methylhistidine             -1.066e-03  7.963e-04 -1.317e-03  1.845e-04 -3.535e-03
# Beta_Hydroxybutyric_Acid     4.327e-04 -1.782e-03 -4.696e-04  3.144e-04 -6.487e-04
# Alpha_Ketoglutaric_Acid      4.641e-04 -3.976e-04 -1.953e-03  9.259e-04  2.108e-04
# Butyric_acid                 5.963e-05 -1.862e-04  8.898e-05  1.011e-04  8.220e-05
# Propionic_Acid               1.015e-03  1.309e-03  1.040e-03  1.536e-03 -9.258e-05
# Fumaric_Acid                -1.968e-03 -4.252e-04 -3.346e-03 -2.352e-04  1.088e-03
# Isobutyric_Acid              1.255e-04 -5.056e-04  5.118e-05  1.440e-04  3.429e-04
# Hippuric_Acid                5.414e-08 -5.298e-07  2.854e-06 -1.584e-07  1.870e-06
# Methylmalonic_Acid          -4.103e-06 -4.161e-06  2.794e-06  4.217e-06  8.400e-06
# LYSOC14_0                    1.994e-04  1.278e-04 -1.328e-04 -1.536e-05  1.016e-04
# LYSOC16_1                    8.629e-04  4.157e-04 -7.316e-04 -5.013e-04  6.063e-04
# LYSOC16_0                    3.385e-03  3.304e-03 -2.951e-03 -2.237e-03  2.126e-03
# LYSOC17_0                    1.895e-04  1.791e-04 -1.113e-04 -8.685e-05  9.340e-05
# LYSOC18_2                    2.319e-05 -4.366e-05 -4.844e-05 -1.145e-05 -1.487e-05
# LYSOC18_1                    9.696e-05 -2.145e-04 -4.573e-04  1.046e-04 -9.573e-05
# LYSOC18_0                   -9.379e-05 -8.266e-05 -2.106e-04  1.252e-04 -1.008e-04
# LYSOC20_4                    2.077e-04 -9.420e-04 -5.794e-05  1.486e-04  2.322e-04
# LYSOC20_3                    1.966e-04  2.800e-04 -1.300e-04  2.484e-04  1.079e-04
# LYSOC24_0                    7.333e-05  1.809e-04 -4.974e-05  2.798e-05 -3.013e-05
# LYSOC26_1                    3.840e-05  2.283e-05 -9.367e-07  1.912e-05 -3.238e-06
# LYSOC26_0                    5.296e-05  8.890e-05 -1.840e-05  5.892e-06 -1.803e-05
# LYSOC28_1                    5.376e-05  9.558e-06  5.108e-06  3.258e-05  2.082e-05
# LYSOC28_0                    3.348e-05  3.165e-05  9.155e-06  1.218e-05 -1.709e-05
# X14_1SMOH                    3.035e-04 -8.481e-05  4.212e-05  7.236e-05  1.843e-04
# X16_1SM                      4.105e-04 -1.052e-03  2.323e-05  1.089e-04  6.260e-04
# X16_0SM                      4.001e-04 -7.557e-04  9.177e-05  1.175e-04  5.916e-04
# X16_1SMOH                    6.596e-04 -3.404e-04  8.637e-05  5.780e-05  9.543e-04
# X18_1SM                      5.273e-05 -8.706e-05 -1.299e-04  1.277e-04  2.277e-05
# PC32_2AA                     5.550e-04  1.796e-03 -3.065e-03  9.274e-04 -1.168e-03
# X18_0SM                      7.296e-05  5.003e-04 -1.212e-03  5.324e-04 -3.860e-04
# X20_2SM                      1.484e-04 -9.848e-05 -5.235e-04  3.348e-04 -3.850e-04
# PC36_0AE                     7.972e-04 -9.170e-04 -6.410e-05  5.632e-06  1.362e-03
# PC36_6AA                     4.726e-03 -8.001e-04 -3.014e-03  8.861e-04  2.075e-03
# PC36_0AA                     5.798e-03 -8.001e-03  2.647e-03 -1.199e-04  1.472e-02
# X22_2SMOH                    8.104e-04 -7.323e-04  1.294e-04  2.372e-04  7.306e-04
# X22_1SMOH                    2.675e-04 -2.518e-04 -2.597e-05  4.662e-05  1.706e-04
# PC38_6AA                     3.780e-02 -5.302e-03 -3.218e-02  1.323e-02  1.800e-02
# PC38_0AA                     4.420e-03 -4.664e-03 -1.681e-04  6.696e-04  4.218e-03
# PC40_6AE                     4.327e-03 -1.510e-03 -2.022e-03  1.968e-03  1.149e-03
# X24_1SMOH                    6.012e-04  8.338e-05 -3.099e-04 -9.189e-06 -5.711e-05
# PC40_6AA                    -2.677e-03 -7.009e-03 -6.120e-03  4.969e-03 -7.005e-03
# PC40_2AA                     1.315e-04 -1.646e-05 -2.413e-05  2.826e-05  3.407e-05
# PC401AA                      8.743e-05 -1.740e-05 -5.638e-05  2.043e-05 -5.602e-05
# C2                          -9.608e-06 -7.407e-04  7.754e-04 -5.359e-04 -1.531e-03
# C3_1                         1.300e-06 -2.560e-06  2.783e-06  3.501e-07 -4.907e-07
# C3                          -2.387e-06 -2.471e-04  4.211e-05  5.972e-05  1.504e-04
# C4_1                         2.086e-06 -3.417e-06  1.562e-06  1.833e-06  3.917e-06
# C4                           5.102e-06 -4.166e-05  7.587e-06  5.814e-06  1.547e-05
# C3OH                         6.994e-07  3.387e-07 -6.940e-07  4.063e-07  8.293e-07
# C5_1                         1.401e-07 -5.627e-07  5.837e-07  1.484e-06  9.825e-07
# C5                          -6.844e-06 -5.711e-05  2.052e-05  2.197e-05  3.784e-05
# C4OH                         1.484e-05 -1.504e-05  2.172e-06  3.970e-06 -5.605e-06
# C6_1                         1.484e-05  1.707e-06 -5.714e-07  5.596e-07  9.843e-06
# C6                           3.351e-05  3.961e-07 -9.519e-07 -3.279e-06 -7.368e-06
# C5OH                        -1.471e-06  4.096e-07  1.159e-07  9.916e-06 -2.322e-06
# C5_1DC                       4.488e-06 -5.864e-06 -1.461e-06  3.461e-06  5.724e-06
# C5DC                         7.958e-07 -8.572e-06  9.256e-06  1.010e-05 -5.438e-07
# C8                           5.834e-06 -2.239e-06 -1.092e-05 -7.681e-07 -8.030e-06
# C5MDC                        7.086e-07  6.575e-07 -9.951e-07  6.095e-07  2.310e-07
# C9                           6.894e-07 -3.177e-07 -1.055e-06 -1.341e-07 -5.642e-07
# C7DC                         1.814e-06  3.486e-06 -1.151e-06 -3.473e-06 -6.285e-07
# C10_2                        6.269e-07  6.419e-06 -3.482e-06  2.547e-07 -3.409e-06
# C10_1                        4.073e-06  9.767e-07 -2.098e-06 -2.198e-07  4.744e-06
# C10                          4.249e-06  3.033e-06 -4.399e-06  1.078e-06  1.456e-06
# C12_1                        2.044e-06 -3.034e-06 -1.384e-06  1.864e-07  1.587e-07
# C12                          1.994e-06 -2.451e-07 -2.076e-06 -2.050e-07 -1.180e-06
# C14_2                        9.702e-07  1.146e-07 -6.564e-07 -2.179e-07 -7.938e-08
# C14_1                        5.516e-06 -8.790e-06 -7.751e-06  9.687e-07 -5.606e-06
# C14                          6.900e-06 -6.984e-06 -7.592e-06 -6.667e-07 -4.952e-06
# C12DC                        7.579e-07  6.284e-07 -1.601e-06 -2.203e-08 -8.625e-07
# C14_2OH                      1.344e-06 -4.843e-08 -2.661e-06 -1.771e-07 -1.982e-06
# C14_1OH                      4.823e-06 -3.603e-06 -4.655e-06 -9.500e-07 -2.405e-06
# C16_2                        2.941e-07  4.217e-08 -1.338e-06 -2.527e-07 -9.296e-07
# C16_1                        1.003e-05 -4.113e-06 -2.291e-05 -5.531e-06 -1.696e-05
# C16                          1.724e-05 -4.304e-06 -1.292e-05 -4.368e-06 -8.243e-06
# C16_2OH                      2.677e-06 -4.332e-07 -2.325e-06 -6.875e-07 -1.272e-06
# C16_1OH                      5.453e-06 -1.397e-06 -4.276e-06 -9.869e-07 -1.325e-06
# C16OH                        8.339e-07 -7.317e-07 -7.225e-07  1.772e-07 -4.781e-07
# C18_2                        1.186e-06 -1.334e-06 -3.411e-06 -6.652e-07 -3.051e-06
# C18_1                        1.658e-05 -3.929e-06 -2.371e-05 -8.348e-06 -1.882e-05
# C18                          5.093e-06  9.023e-07 -5.120e-06 -1.049e-06 -1.170e-06
# C18_1OH                      1.447e-06 -2.400e-07 -1.338e-06 -5.087e-07 -8.140e-07
# Arginine_Average            -7.634e-03  3.153e-03 -4.773e-03  6.994e-03 -7.636e-03
# Betaine_Average              8.477e-03  1.603e-02 -1.508e-02 -1.391e-02 -1.353e-03
# C0_Average                  -6.393e-04  1.618e-05  3.201e-04  8.471e-04 -1.433e-03
# Choline_Average             -8.237e-04  4.830e-03 -6.886e-03  1.510e-03 -4.136e-04
# Citrate_Average              1.136e-02 -5.548e-02 -1.500e-02  4.077e-03  1.704e-02
# Creatine_Average             2.232e-02 -4.985e-02  5.622e-02  1.817e-02 -2.545e-03
# Creatinine_Average          -2.651e-05 -1.302e-03  1.084e-03  2.120e-04  2.950e-04
# Glucose_Average             -2.792e-01  1.090e-01  1.324e-02  6.073e-03  1.677e-03
# Glutamate_Average           -6.506e-03 -5.134e-03 -6.585e-03  1.569e-03 -9.805e-05
# Glycine_Average             -3.120e-02 -9.943e-03 -3.011e-02  2.369e-02 -1.119e-02
# Histidine_Average           -2.026e-03 -1.842e-03  9.382e-04  1.551e-03 -1.143e-03
# Isoleucine_Average          -2.667e-03 -1.890e-02 -6.817e-03  9.104e-03  7.313e-03
# Lactate_Average             -1.645e-02 -2.761e-01 -8.022e-04 -4.430e-03 -9.084e-03
# Leucine                     -1.374e-02 -7.089e-03 -1.012e-02  2.026e-02  9.526e-04
# Methionine                  -3.310e-03 -2.030e-03 -2.146e-03  2.112e-03 -9.227e-04
# Phenylalanine_Average       -5.703e-03 -4.700e-03 -5.641e-03  2.611e-03  3.456e-04
# Proline                     -4.294e-04 -1.563e-02 -1.612e-03  9.400e-03  7.432e-03
# Pyruvate_Average            -4.850e-03  4.238e-03 -8.975e-03  8.250e-03 -1.653e-02
# Succinate_Average           -4.708e-04  3.844e-04 -1.103e-03 -3.354e-04 -1.410e-04
# Threonine_Average           -9.422e-03 -7.327e-03  2.107e-03  9.803e-03 -8.343e-03
# Tyrosine_Average            -9.535e-03 -7.265e-03 -5.025e-03 -7.454e-04  8.624e-04
# Valine_Average              -8.199e-03 -3.432e-02 -9.772e-03  1.332e-02  1.686e-02
# X1_Methylhistidine           9.322e-05  4.005e-04 -1.636e-04  6.452e-06  1.440e-04
# X2_Hydroxybutyrate          -8.247e-05 -2.642e-03 -6.258e-04 -3.846e-05  1.570e-03
# X2_Hydroxyisovaleric_Acid    2.694e-04  5.708e-06 -1.528e-05  7.715e-05  2.684e-04
# X3_Hydroxybutyrate           3.224e-04 -1.672e-03 -4.412e-04  3.370e-04 -7.671e-04
# ADP                          3.538e-03  1.733e-02 -9.336e-03 -7.932e-03  1.627e-03
# AMP                          3.440e-03  2.452e-03 -2.089e-04 -1.212e-02 -3.575e-03
# ATP                          3.668e-03  5.008e-03 -1.159e-03 -2.995e-03  2.135e-03
# Acetamide                    8.580e-04  1.746e-03 -1.086e-03 -2.677e-04 -5.962e-04
# Acetate                      2.942e-03 -2.107e-03 -2.564e-03 -8.851e-04 -4.888e-04
# Acetoacetate                 5.801e-06 -2.512e-03  2.412e-03  3.038e-04 -1.165e-03
# Acetone                      1.277e-04 -1.514e-04 -7.489e-05 -6.153e-05 -1.010e-04
# Adenosine                   -7.644e-03  1.097e-02 -1.411e-02 -8.296e-03 -1.018e-02
# Alanine                      4.956e-03 -5.546e-03 -8.512e-03  4.873e-04 -8.199e-03
# Aspartate                   -4.613e-04 -2.317e-03  6.388e-04  5.788e-04  7.672e-04
# Creatine_Phosphate          -1.443e-04  3.530e-04 -2.105e-04 -5.789e-04 -7.076e-04
# Cytidine                    -2.275e-04 -2.486e-04  1.192e-04  3.319e-04  6.913e-05
# Dimethyl_Sulfone             4.616e-04 -9.782e-04  2.722e-04 -1.163e-04  6.146e-04
# Ethanol                      3.163e-04  4.460e-04  4.609e-04  4.679e-04  6.675e-05
# Ethanolamine                 5.774e-03  1.551e-02 -1.196e-02 -1.150e-02 -3.153e-03
# Formate                      1.026e-03  1.343e-03  1.061e-03  1.902e-03  3.843e-04
# Glycerol                     6.994e-03  1.906e-02 -1.316e-02  1.897e-02 -1.476e-03
# Guanidoacetate               4.476e-03  4.707e-03 -6.699e-03 -7.357e-03 -4.153e-03
# Guanosine                   -2.081e-03  1.699e-02 -2.213e-02 -6.453e-03  1.076e-03
# Hypoxanthine                 3.044e-04  3.477e-03 -2.416e-03 -1.489e-03 -6.289e-04
# IMP                         -4.354e-03 -2.154e-02  1.765e-03  1.413e-03  5.144e-03
# Inosine                      5.577e-03 -2.267e-02  1.857e-02  3.382e-03  1.642e-02
# Isopropanol                  5.424e-05  1.036e-04 -4.177e-05  3.797e-05  2.647e-05
# Malate                      -9.509e-04 -7.771e-04 -1.195e-03 -2.991e-04 -1.796e-03
# Malonate                     5.579e-04 -2.118e-04  1.467e-03 -1.506e-03  8.762e-05
# Mannose                     -2.120e-03 -1.790e-03  7.840e-04  3.312e-04 -1.371e-03
# Methanol                     4.031e-03  1.050e-03  4.894e-03  1.064e-02 -5.057e-04
# N_N_Dimethylglycine          8.450e-04  9.512e-04 -6.216e-04 -4.567e-04 -1.410e-03
# Nicotinurate                -3.850e-04 -1.049e-03 -1.854e-03 -8.283e-05  1.019e-03
# O_Acetylcarnitine           -1.129e-04 -7.135e-04  1.123e-03 -4.513e-04 -1.431e-03
# O_Phosphocholine            -9.089e-04 -6.708e-04  1.024e-04  2.396e-04  1.006e-03
# Propylene_Glycol            -2.339e-05 -1.363e-03  7.739e-04 -1.015e-04  3.740e-04
# Taurine                      2.205e-01  1.205e-01  1.136e-02  1.158e-02 -5.409e-03
# Uridine                     -9.610e-04 -1.294e-03 -4.435e-04  4.361e-04  2.792e-04
# Xanthine                     7.996e-05 -1.010e-05  5.990e-05  9.402e-05  1.205e-04
# sn_Glycero_3_Phosphocholine  2.360e-03  1.372e-02 -1.272e-02  3.617e-03  8.138e-04
# Beta.Alanine                 1.066e-02 -1.176e-02 -3.166e-04 -6.174e-03 -1.742e-02
# RDA6
# Serine                       4.542e-04
# Putrescine                  -1.965e-04
# Trans_Hydroxyproline         2.328e-03
# Asparagine                   2.640e-03
# Glutamine                    1.680e-03
# Alpha_Aminoadipic_Acid      -7.554e-05
# Methionine_Sulfoxide         2.356e-04
# Acetyl_Ornithine             1.211e-04
# Citrulline                   2.992e-03
# Asymmetric_Dimethylarginine  8.616e-06
# Total_Dimethylarginine       1.825e-06
# Tryptophan                   9.502e-04
# Kynurenine                   4.581e-05
# Ornithine                    1.893e-04
# Lysine                      -9.752e-04
# Spermidine                   3.286e-04
# Spermine                    -4.777e-04
# Sarcosine                    1.649e-03
# Methylhistidine             -9.740e-04
# Beta_Hydroxybutyric_Acid     8.354e-04
# Alpha_Ketoglutaric_Acid     -2.204e-04
# Butyric_acid                -9.476e-05
# Propionic_Acid              -1.961e-03
# Fumaric_Acid                 6.664e-04
# Isobutyric_Acid             -3.218e-05
# Hippuric_Acid               -1.597e-06
# Methylmalonic_Acid           4.856e-06
# LYSOC14_0                   -1.058e-04
# LYSOC16_1                   -3.697e-04
# LYSOC16_0                   -1.713e-03
# LYSOC17_0                   -1.135e-04
# LYSOC18_2                   -4.416e-05
# LYSOC18_1                   -3.917e-04
# LYSOC18_0                   -9.199e-05
# LYSOC20_4                   -1.663e-05
# LYSOC20_3                   -2.718e-04
# LYSOC24_0                   -1.190e-04
# LYSOC26_1                   -4.952e-05
# LYSOC26_0                   -5.768e-05
# LYSOC28_1                   -2.673e-05
# LYSOC28_0                   -3.967e-05
# X14_1SMOH                   -1.501e-04
# X16_1SM                     -1.498e-04
# X16_0SM                     -3.941e-05
# X16_1SMOH                    1.733e-05
# X18_1SM                     -6.571e-05
# PC32_2AA                    -1.407e-03
# X18_0SM                     -6.153e-04
# X20_2SM                     -1.595e-04
# PC36_0AE                     1.467e-04
# PC36_6AA                    -8.890e-04
# PC36_0AA                     3.917e-03
# X22_2SMOH                    1.164e-04
# X22_1SMOH                   -1.342e-06
# PC38_6AA                    -2.256e-02
# PC38_0AA                    -3.718e-04
# PC40_6AE                    -1.685e-03
# X24_1SMOH                   -3.242e-04
# PC40_6AA                    -3.551e-03
# PC40_2AA                    -6.584e-05
# PC401AA                     -4.455e-05
# C2                          -1.271e-03
# C3_1                        -2.800e-07
# C3                           9.389e-05
# C4_1                        -1.878e-06
# C4                           1.427e-05
# C3OH                        -3.366e-07
# C5_1                        -5.162e-07
# C5                           2.638e-05
# C4OH                        -2.582e-06
# C6_1                        -9.755e-06
# C6                          -1.414e-05
# C5OH                        -5.229e-07
# C5_1DC                      -1.985e-07
# C5DC                        -1.425e-05
# C8                          -1.505e-06
# C5MDC                       -6.829e-07
# C9                          -7.226e-07
# C7DC                        -5.401e-06
# C10_2                       -3.419e-06
# C10_1                       -9.464e-06
# C10                         -4.672e-06
# C12_1                       -2.403e-06
# C12                         -4.311e-09
# C14_2                        1.662e-07
# C14_1                        1.810e-06
# C14                          1.514e-06
# C12DC                       -4.052e-07
# C14_2OH                     -1.745e-07
# C14_1OH                      6.096e-07
# C16_2                       -1.053e-08
# C16_1                        1.680e-06
# C16                         -3.366e-06
# C16_2OH                      1.379e-07
# C16_1OH                     -4.093e-07
# C16OH                        2.907e-08
# C18_2                        4.490e-07
# C18_1                       -9.557e-07
# C18                         -1.680e-06
# C18_1OH                     -4.205e-07
# Arginine_Average             1.740e-05
# Betaine_Average              4.901e-03
# C0_Average                  -8.487e-04
# Choline_Average             -2.480e-03
# Citrate_Average              8.087e-03
# Creatine_Average             7.975e-03
# Creatinine_Average          -2.314e-04
# Glucose_Average             -9.979e-03
# Glutamate_Average            1.990e-04
# Glycine_Average              6.801e-03
# Histidine_Average            1.777e-03
# Isoleucine_Average           3.511e-03
# Lactate_Average             -1.011e-02
# Leucine                      2.366e-03
# Methionine                   1.469e-03
# Phenylalanine_Average        2.083e-03
# Proline                      6.594e-03
# Pyruvate_Average             2.189e-04
# Succinate_Average            3.821e-04
# Threonine_Average            1.101e-03
# Tyrosine_Average             1.606e-03
# Valine_Average               6.508e-03
# X1_Methylhistidine          -3.656e-04
# X2_Hydroxybutyrate          -6.279e-05
# X2_Hydroxyisovaleric_Acid   -1.021e-04
# X3_Hydroxybutyrate           7.831e-04
# ADP                         -6.323e-03
# AMP                         -3.685e-03
# ATP                          1.770e-03
# Acetamide                   -6.826e-04
# Acetate                      1.240e-03
# Acetoacetate                -2.683e-03
# Acetone                      1.696e-04
# Adenosine                    1.302e-02
# Alanine                     -2.190e-03
# Aspartate                    4.144e-04
# Creatine_Phosphate           8.704e-04
# Cytidine                    -8.718e-05
# Dimethyl_Sulfone             3.908e-04
# Ethanol                     -3.285e-04
# Ethanolamine                 1.448e-03
# Formate                     -7.372e-04
# Glycerol                     6.246e-03
# Guanidoacetate              -2.126e-03
# Guanosine                    5.881e-03
# Hypoxanthine                 8.548e-04
# IMP                         -2.731e-03
# Inosine                     -4.304e-03
# Isopropanol                 -4.754e-05
# Malate                       3.438e-04
# Malonate                     8.985e-04
# Mannose                     -8.251e-04
# Methanol                    -9.203e-03
# N_N_Dimethylglycine         -1.136e-03
# Nicotinurate                 1.612e-03
# O_Acetylcarnitine           -1.251e-03
# O_Phosphocholine             5.700e-04
# Propylene_Glycol            -5.168e-04
# Taurine                     -8.462e-03
# Uridine                      1.932e-04
# Xanthine                    -8.224e-05
# sn_Glycero_3_Phosphocholine -5.476e-04
# Beta.Alanine                -6.400e-03
# 
# 
# Site scores (weighted sums of species scores)
# 
# RDA1      RDA2      RDA3     RDA4       RDA5     RDA6
# row1  -1.031976  0.080013 -0.428254 -0.14862  0.4228815 -0.20016
# row2  -0.617910  0.133819  0.285911 -0.17073  0.4129057 -0.27190
# row3   0.706491  0.397792  0.047339 -0.10819 -0.1936103  0.83038
# row4  -0.587954  0.192460  0.084522 -0.21558  0.2435766 -0.43176
# row5  -1.066821  0.318941 -0.062149 -0.02375  0.7192027  0.49723
# row6  -0.172663  0.259450 -0.016392  0.07159 -0.1426311 -0.13153
# row7  -0.769959 -0.277984 -0.328768 -0.58367  0.0523994 -0.81579
# row8  -0.271275 -0.001161 -0.250112 -0.04430 -0.3377346 -0.55893
# row9   0.466650  0.105895 -0.220176  0.02100 -0.5900341  0.42696
# row10  1.034836 -0.263720 -0.547167 -0.19895 -1.0010860  1.20576
# row11 -0.205843 -0.066498  0.027086 -0.17333 -0.6447995  0.09276
# row12  0.716850  0.411848  0.005798 -0.07290 -0.1355853  0.43139
# row13 -0.417457 -0.358344 -0.181569 -0.59312 -0.0648471 -0.28977
# row14  0.660969 -0.121616 -0.099812 -0.42139 -0.5277000  0.36513
# row15  0.934452  0.467933 -0.072620 -0.10666 -0.3355447  0.88755
# row16 -0.133503 -0.298113 -0.373646 -0.13183 -0.1907882 -0.61195
# row17  0.385096  0.302412 -0.296351 -0.33794 -0.0544128 -0.12392
# row18 -0.237322  0.494416  0.066719  0.21948  0.6269847 -0.58013
# row19  0.886987  0.696502  0.012205  0.11567  0.3035050  0.86095
# row20 -1.092531 -0.180771 -0.302808 -0.68164  1.3361011 -1.24392
# row21 -0.253460  0.123690 -0.512630  0.83662 -0.3434353 -0.35692
# row22 -0.109810  0.436999  0.030533  0.40315  0.1075010 -0.22251
# row23  0.649657  0.184067 -0.162234  1.00379 -0.2958902  1.11146
# row24  0.545082  0.385471 -0.233810  0.48980 -0.1648974  0.04664
# row25  0.112748  0.056988 -0.024003 -0.07875 -0.2873896 -0.89034
# row26  0.550520  0.394729  0.405030  0.25651 -0.0003307  0.26764
# row27 -0.685826  0.119851  0.342550  0.09322  0.4813181 -0.92851
# row28 -0.753676 -0.028587  0.105209 -0.29848  0.5746467 -0.77385
# row29 -0.302330  0.008265  0.344653 -0.01722 -0.2059892 -0.13971
# row30  0.167212  0.218698  0.281344  0.18983 -0.2575749 -0.18188
# row31 -0.952857 -0.248275  0.402374 -0.26889  0.2210469  0.04070
# row32 -0.624344  0.122970  0.351107 -0.15633  0.4296194 -0.35562
# row33  0.906939 -0.273703  0.513324  0.68746 -0.7885644  1.17242
# row34 -0.227565 -0.354334 -0.152080 -0.37031 -0.2301393 -0.71473
# row35  0.367218 -0.774989 -0.115553 -0.01146 -1.0521571  0.03175
# row36  0.014923  0.146411  0.139995  0.07114  0.0163599 -0.80040
# row37  0.829687  0.156631  0.415479  0.27528 -0.4089572  0.74614
# row38  0.798629  0.164635  0.324911  0.28446 -0.4102886  0.76188
# row39  0.219906  0.251168  0.128252  0.16931 -0.2145817 -0.24244
# row40 -0.744492  0.129855  0.283137 -0.26686  0.7338641 -0.06986
# row41 -0.580075 -0.110783  0.055688 -0.15532  0.3872818 -0.47921
# row42 -0.502808 -0.154387  0.225640  0.24692  0.8032217 -0.05414
# row43  1.089258 -1.004932 -0.574981  0.42773 -0.2227183  1.45045
# row44 -0.377446  0.060306  0.299433  0.08362  0.5474587 -0.43015
# row45  0.373843 -0.017548 -0.049086 -0.30990 -0.1177088 -0.39086
# row46  0.888586 -0.716745 -0.140288  0.06505 -0.2901499  1.12206
# row47 -0.002545 -0.194690 -0.148753 -0.36382 -0.5976998 -1.28448
# row48  0.469102 -0.241125 -0.229600  0.15443 -0.3122882 -0.08902
# row49 -0.469789 -0.028125  0.054527 -0.03546  0.3879275 -0.29529
# row50  0.837855 -0.325270  0.111536  0.28532  0.2315463  0.80306
# row51 -0.210319 -0.587209 -0.367581 -0.40277  0.1399381 -0.62487
# row52 -1.101358  0.268924  0.344066 -0.19051  1.1669886  0.25338
# row53  0.336984 -0.432293 -0.009622  0.32005 -0.1511147  0.92198
# row54 -0.446568 -0.029937  0.211673  0.16725  0.2243736  0.25691
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# RDA1       RDA2      RDA3       RDA4     RDA5     RDA6
# row1  -0.286279 -0.0374824 -0.271361 -1.412e-01 -0.24866 -0.04759
# row2   0.111605  0.1638097 -0.036030 -3.550e-01 -0.01579  0.10253
# row3   0.111605  0.1638097 -0.036030 -3.550e-01 -0.01579  0.10253
# row4   0.111605  0.1638097 -0.036030 -3.550e-01 -0.01579  0.10253
# row5  -0.218018 -0.0042500 -0.220074 -7.616e-02 -0.25041  0.08320
# row6  -0.286279 -0.0374824 -0.271361 -1.412e-01 -0.24866 -0.04759
# row7  -0.252148 -0.0208662 -0.245717 -1.087e-01 -0.24954  0.01780
# row8  -0.115627  0.0455986 -0.143143  2.146e-02 -0.25304  0.27940
# row9  -0.286279 -0.0374824 -0.271361 -1.412e-01 -0.24866 -0.04759
# row10 -0.115627  0.0455986 -0.143143  2.146e-02 -0.25304  0.27940
# row11 -0.013237  0.0954472 -0.066212  1.191e-01 -0.25567  0.47560
# row12  0.179865  0.1970421  0.015257 -2.899e-01 -0.01754  0.23332
# row13  0.111605  0.1638097 -0.036030 -3.550e-01 -0.01579  0.10253
# row14  0.111605  0.1638097 -0.036030 -3.550e-01 -0.01579  0.10253
# row15  0.213995  0.2136583  0.040901 -2.573e-01 -0.01842  0.29872
# row16 -0.098120  0.1525261 -0.295784  3.152e-01  0.04349 -0.17667
# row17  0.197373  0.3039696 -0.137384  3.892e-03  0.27899 -0.22274
# row18  0.197373  0.3039696 -0.137384  3.892e-03  0.27899 -0.22274
# row19  0.163243  0.2873534 -0.163027 -2.865e-02  0.27987 -0.28814
# row20  0.197373  0.3039696 -0.137384  3.892e-03  0.27899 -0.22274
# row21 -0.063989  0.1691423 -0.270141  3.478e-01  0.04262 -0.11127
# row22 -0.063989  0.1691423 -0.270141  3.478e-01  0.04262 -0.11127
# row23  0.072532  0.2356071 -0.167567  4.779e-01  0.03911  0.15032
# row24  0.038401  0.2189909 -0.193210  4.454e-01  0.03998  0.08493
# row25  0.512280 -0.1830331  0.098103  1.357e-01 -0.30695 -0.04937
# row26  0.037599  0.0660186  0.314383  1.228e-01 -0.11901  0.01420
# row27  0.003469  0.0494024  0.288740  9.021e-02 -0.11813 -0.05120
# row28  0.003469  0.0494024  0.288740  9.021e-02 -0.11813 -0.05120
# row29  0.003469  0.0494024  0.288740  9.021e-02 -0.11813 -0.05120
# row30  0.071730  0.0826348  0.340027  1.553e-01 -0.11989  0.07959
# row31  0.037599  0.0660186  0.314383  1.228e-01 -0.11901  0.01420
# row32  0.071730  0.0826348  0.340027  1.553e-01 -0.11989  0.07959
# row33 -0.030661  0.0327862  0.263096  5.767e-02 -0.11726 -0.11660
# row34 -0.269573 -0.0835272  0.083591 -1.701e-01 -0.11112 -0.57439
# row35 -0.098922 -0.0004462  0.211809 -7.411e-03 -0.11550 -0.24740
# row36  0.375759 -0.2494979 -0.004471  5.491e-03 -0.30345 -0.31097
# row37 -0.133052 -0.0170624  0.186165 -3.995e-02 -0.11463 -0.31280
# row38 -0.030661  0.0327862  0.263096  5.767e-02 -0.11726 -0.11660
# row39 -0.133052 -0.0170624  0.186165 -3.995e-02 -0.11463 -0.31280
# row40 -0.257093 -0.1449347  0.066661 -4.464e-05  0.25534  0.06629
# row41 -0.154702 -0.0950861  0.143592  9.758e-02  0.25271  0.26248
# row42  0.251718 -0.3773702 -0.123975  4.540e-02  0.06652  0.06811
# row43  0.251718 -0.3773702 -0.123975  4.540e-02  0.06652  0.06811
# row44 -0.154702 -0.0950861  0.143592  9.758e-02  0.25271  0.26248
# row45  0.004270 -0.0101073  0.199418 -3.439e-01  0.49172 -0.04519
# row46  0.319979 -0.3441378 -0.072688  1.105e-01  0.06477  0.19891
# row47  0.115197 -0.4438350 -0.226549 -8.476e-02  0.07003 -0.19348
# row48 -0.188832 -0.1117023  0.117948  6.504e-02  0.25359  0.19708
# row49 -0.257093 -0.1449347  0.066661 -4.464e-05  0.25534  0.06629
# row50  0.251718 -0.3773702 -0.123975  4.540e-02  0.06652  0.06811
# row51  0.149328 -0.4272188 -0.200905 -5.222e-02  0.06915 -0.12808
# row52 -0.222963 -0.1283185  0.092305  3.250e-02  0.25446  0.13168
# row53 -0.325353 -0.1781671  0.015374 -6.513e-02  0.25709 -0.06451
# row54 -0.222963 -0.1283185  0.092305  3.250e-02  0.25446  0.13168
# 
# 
# Biplot scores for constraining variables
# 
# RDA1      RDA2    RDA3     RDA4     RDA5     RDA6
# SiteMatheson   0.09099 -0.008542  0.7480  0.17839 -0.46078 -0.43356
# SiteRed River -0.13428  0.276263 -0.3794 -0.59810 -0.45854  0.44012
# SiteSandy Bar  0.16622  0.556828 -0.4601  0.49774  0.34393 -0.29087
# SexM           0.39834  0.562978 -0.1163 -0.62442  0.34764  0.01004
# SexUN          0.60676 -0.757152 -0.2120  0.06832 -0.05635 -0.07590
# Age           -0.69366 -0.075267 -0.3390 -0.17705 -0.48634 -0.36109
# 
# 
# Centroids for factor constraints
# 
# RDA1      RDA2      RDA3      RDA4     RDA5      RDA6
# SiteDauphin River -0.02932 -0.225597  0.004386  0.001715  0.19539  0.072665
# SiteMatheson       0.02808 -0.002636  0.230840  0.055052 -0.14220 -0.133797
# SiteRed River     -0.04144  0.085255 -0.117091 -0.184574 -0.14151  0.135820
# SiteSandy Bar      0.07113  0.238297 -0.196891  0.213012  0.14719 -0.124481
# SexF              -0.11586  0.010616  0.037594  0.071531 -0.03785  0.006927
# SexM               0.14263  0.201575 -0.041646 -0.223575  0.12447  0.003594
# SexUN              0.27846 -0.347479 -0.097304  0.031354 -0.02586 -0.034831

plot(RDA_met18factors_small3, scaling=0)
plot(RDA_met18factors_small3, scaling=1)
#plot(Rdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAkCAYAAAD7PHgWAAAA00lEQVR42mNgGAWjYBQMUxAauorZLL452TyhZQUtMMhs47QGLrIdaJ7QmtSyeP+5fTc//N98+e1/agGQWSvOvPqfNGHnRbO4lnjyHRjfvHzvzff/Zx5+/r9x60OqORBkFgg3bHnw1yy+ZQkFIdiyAuRbmIHUdiAIg+wYdeCoA0cdOOrAUQdSyYG0wKMOHHUgOQ6kNGOMOhCXpaMOHHXgiHTgSmDva9A6ENRvTejfcYFWDkzs33kBZAfZDvTMncQO6huDup+06rhbhvZxjg6RjILBDgAZYqbbTdtPRgAAAABJRU5ErkJggg==DA_met18factors_small3, scaling=2) # this one good

anova(RDA_met18factors_small3)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ Site + Sex + Age, data = factors3)
# Df Variance      F Pr(>F)
# Model     6 0.009812 1.2008  0.293
# Residual 47 0.064006   
plot(RDA_met18factors_small3, scaling=0)
plot(RDA_met18factors_small3, scaling=1)
plot(RDA_met18factors_small3, scaling=2)
plot(RDA_met18factors_small3, scaling=3)
plot(RDA_met18factors_small3, scaling=3, points(scrs$sites),
     with(scrs, text(species, labels = rownames(species),
                     col = "darkcyan", cex = 0.8)))
# didnt work
plot(RDA_met18factors_small3, scaling=1, type="t") # yeah
#plot with all variables is pixelate dtho
plot(RDA_met18factors_small3, type="n")
text(RDA_met18factors_small3,display="cn")
points(RDA_met18factors_small3,col="red")
text(RDA_met18factors_small3, "species",  cex=0.8, col="blue")

plot(RDA_met18factors_small3, type="n")
text(RDA_met18factors_small3,display="cn")
points(RDA_met18factors_small3,col="red")
text(RDA_met18factors_small3, "sites",  cex=0.8, col="blue")

anova(RDA_met18factors_small3, by="term", permutations=199)
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ Site + Sex + Age, data = factors3)
# Df Variance      F Pr(>F)
# Site      3 0.003612 0.8841  0.495
# Sex       2 0.005188 1.9047  0.145
# Age       1 0.001013 0.7435  0.525
#Residual 47 0.064006 
anova(RDA_met18factors_small3, by="mar", permutations=199)
# Permutation test for rda under reduced model
# Marginal effects of terms
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ Site + Sex + Age, data = factors3)
# Df Variance      F Pr(>F)
# Site      3 0.002446 0.5986  0.750
# Sex       2 0.003306 1.2139  0.320
# Age       1 0.001013 0.7435  0.455
# Residual 47 0.064006     


#### smaller model redundancy analysis constraint by the factor variables not transformed ####
RDA_met18factors_small2 <- rda(Metabolites18T~.,Factors4)
summary(RDA_met18factors_small2)
# :
#   rda(formula = Metabolites18T ~ Site + FL + Sex + Age, data = Factors4) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         0.07382     1.0000
# Constrained   0.01212     0.1642
# Unconstrained 0.06170     0.8358
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#   RDA1     RDA2      RDA3      RDA4      RDA5      RDA6
# Eigenvalue            0.007063 0.004255 0.0003147 0.0002202 0.0001501 6.243e-05
# Proportion Explained  0.095686 0.057641 0.0042634 0.0029825 0.0020337 8.457e-04
# Cumulative Proportion 0.095686 0.153327 0.1575904 0.1605729 0.1626066 1.635e-01
# RDA7     PC1      PC2      PC3       PC4       PC5
# Eigenvalue            5.359e-05 0.04891 0.009339 0.001267 0.0004989 0.0003727
# Proportion Explained  7.259e-04 0.66257 0.126509 0.017170 0.0067586 0.0050485
# Cumulative Proportion 1.642e-01 0.82675 0.953255 0.970425 0.9771837 0.9822322
# PC6      PC7       PC8       PC9      PC10      PC11
# Eigenvalue            0.0002532 0.000212 0.0001498 0.0001344 0.0001076 8.579e-05
# Proportion Explained  0.0034302 0.002871 0.0020287 0.0018210 0.0014574 1.162e-03
# Cumulative Proportion 0.9856624 0.988534 0.9905624 0.9923834 0.9938408 9.950e-01
# PC12      PC13      PC14      PC15      PC16      PC17
# Eigenvalue            5.961e-05 5.771e-05 3.845e-05 3.529e-05 2.859e-05 2.391e-05
# Proportion Explained  8.076e-04 7.818e-04 5.209e-04 4.781e-04 3.873e-04 3.239e-04
# Cumulative Proportion 9.958e-01 9.966e-01 9.971e-01 9.976e-01 9.980e-01 9.983e-01
# PC18      PC19      PC20      PC21      PC22      PC23
# Eigenvalue            2.129e-05 0.0000166 1.416e-05 1.192e-05 9.591e-06 8.657e-06
# Proportion Explained  2.884e-04 0.0002249 1.919e-04 1.615e-04 1.299e-04 1.173e-04
# Cumulative Proportion 9.986e-01 0.9988158 9.990e-01 9.992e-01 9.993e-01 9.994e-01
# PC24      PC25      PC26      PC27      PC28      PC29
# Eigenvalue            6.449e-06 6.238e-06 5.148e-06 4.210e-06 3.492e-06 2.832e-06
# Proportion Explained  8.736e-05 8.450e-05 6.974e-05 5.703e-05 4.731e-05 3.836e-05
# Cumulative Proportion 9.995e-01 9.996e-01 9.997e-01 9.997e-01 9.998e-01 9.998e-01
# PC30      PC31      PC32      PC33      PC34      PC35
# Eigenvalue            2.716e-06 2.277e-06 1.553e-06 1.386e-06 1.235e-06 1.064e-06
# Proportion Explained  3.680e-05 3.084e-05 2.104e-05 1.878e-05 1.673e-05 1.441e-05
# Cumulative Proportion 9.998e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01
# PC36      PC37      PC38      PC39      PC40      PC41
# Eigenvalue            8.887e-07 6.489e-07 5.634e-07 5.535e-07 4.718e-07 4.040e-07
# Proportion Explained  1.204e-05 8.790e-06 7.633e-06 7.498e-06 6.391e-06 5.473e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# PC42      PC43      PC44      PC45      PC46
# Eigenvalue            2.682e-07 2.409e-07 1.783e-07 1.418e-07 1.189e-07
# Proportion Explained  3.633e-06 3.263e-06 2.416e-06 1.920e-06 1.611e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#   RDA1     RDA2      RDA3      RDA4      RDA5      RDA6
# Eigenvalue            0.007063 0.004255 0.0003147 0.0002202 0.0001501 6.243e-05
# Proportion Explained  0.582816 0.351090 0.0259681 0.0181659 0.0123871 5.151e-03
# Cumulative Proportion 0.582816 0.933906 0.9598742 0.9780401 0.9904272 9.956e-01
# RDA7
# Eigenvalue            5.359e-05
# Proportion Explained  4.422e-03
# Cumulative Proportion 1.000e+00
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  1.4064 
# 
# 
# Species scores
# 
# RDA1       RDA2       RDA3       RDA4       RDA5
# Serine                      -5.523e-03  1.493e-03 -1.119e-02 -1.332e-02  6.063e-04
# Putrescine                  -5.305e-04 -1.981e-03  1.307e-03 -5.616e-04  1.618e-03
# Trans_Hydroxyproline        -1.101e-03 -7.013e-03  1.398e-03  2.400e-03  3.908e-03
# Asparagine                  -1.685e-03 -6.055e-03  1.521e-03  2.170e-03  3.803e-03
# Glutamine                   -2.757e-03 -1.777e-03 -1.409e-03 -1.719e-03  5.915e-04
# Alpha_Aminoadipic_Acid      -5.531e-06 -5.917e-04 -4.545e-04  9.018e-05  7.029e-04
# Methionine_Sulfoxide        -8.169e-04 -3.910e-05 -4.594e-04 -8.141e-04  2.231e-04
# Acetyl_Ornithine             3.396e-06 -9.656e-05 -5.557e-05  5.195e-05  3.462e-05
# Citrulline                   1.056e-02  1.711e-02 -2.838e-03  2.352e-02 -1.330e-02
# Asymmetric_Dimethylarginine -4.579e-05 -9.263e-05  5.299e-06 -3.184e-05  4.084e-05
# Total_Dimethylarginine      -6.378e-05 -1.460e-04 -1.205e-05 -8.277e-05  7.296e-05
# Tryptophan                  -9.869e-04 -2.628e-03 -7.745e-04  5.670e-04  8.589e-04
# Kynurenine                  -6.927e-05 -7.240e-05 -4.077e-05  2.092e-05 -7.508e-06
# Ornithine                   -7.045e-04  6.052e-04 -1.396e-03 -1.801e-03  3.385e-04
# Lysine                      -3.631e-03  4.247e-03 -5.743e-03 -7.741e-03  3.276e-03
# Spermidine                  -1.871e-04 -2.050e-03  5.911e-04  2.677e-04  2.098e-03
# Spermine                     1.005e-03 -2.366e-03 -3.422e-04  9.206e-04  3.305e-03
# Sarcosine                   -1.567e-03 -1.034e-04 -3.981e-03 -3.735e-03  4.720e-04
# Methylhistidine              1.888e-03  8.432e-04 -1.433e-03 -5.397e-03 -2.137e-03
# Beta_Hydroxybutyric_Acid     5.230e-04 -1.789e-03 -4.765e-04 -4.970e-04  7.892e-06
# Alpha_Ketoglutaric_Acid      1.329e-03 -4.001e-04 -1.977e-03 -1.077e-03  7.070e-04
# Butyric_acid                 9.518e-05 -1.871e-04  8.831e-05 -3.079e-05  1.155e-04
# Propionic_Acid               1.978e-03  1.295e-03  1.012e-03 -1.486e-03  1.127e-03
# Fumaric_Acid                -5.437e-04 -3.714e-04 -3.390e-03 -1.305e-03 -2.498e-04
# Isobutyric_Acid              1.313e-04 -5.080e-04  5.320e-05  1.290e-04  2.704e-04
# Hippuric_Acid                8.460e-07 -5.243e-07  2.844e-06  8.610e-08  3.913e-07
# Methylmalonic_Acid          -2.632e-06 -4.060e-06  2.765e-06  3.522e-08  6.570e-06
# LYSOC14_0                    1.559e-04  1.231e-04 -1.294e-04  1.591e-04  5.147e-05
# LYSOC16_1                    5.963e-04  3.950e-04 -7.118e-04  1.034e-03 -7.664e-05
# LYSOC16_0                    2.627e-03  3.225e-03 -2.881e-03  3.761e-03 -7.121e-04
# LYSOC17_0                    1.453e-04  1.746e-04 -1.077e-04  1.825e-04 -1.586e-05
# LYSOC18_2                    3.188e-05 -4.406e-05 -4.864e-05 -8.370e-06 -1.781e-05
# LYSOC18_1                    1.510e-04 -2.160e-04 -4.595e-04 -1.305e-04  4.266e-05
# LYSOC18_0                   -4.279e-05 -8.020e-05 -2.139e-04 -1.797e-04  5.113e-05
# LYSOC20_4                    8.870e-05 -9.470e-04 -5.293e-05  2.151e-04  2.648e-04
# LYSOC20_3                    2.792e-04  2.763e-04 -1.312e-04 -7.897e-05  2.557e-04
# LYSOC24_0                    9.849e-05  1.795e-04 -5.020e-05 -3.247e-05  1.077e-05
# LYSOC26_1                    5.140e-05  2.211e-05 -1.161e-06 -1.455e-05  1.428e-05
# LYSOC26_0                    5.360e-05  8.774e-05 -1.818e-05  2.222e-06  1.051e-06
# LYSOC28_1                    4.991e-05  8.378e-06  5.572e-06  1.469e-05  4.158e-05
# LYSOC28_0                    3.403e-05  3.093e-05  9.196e-06 -6.274e-06  5.599e-06
# X14_1SMOH                    2.260e-04 -9.189e-05  4.715e-05  2.191e-04  1.764e-04
# X16_1SM                      3.180e-04 -1.061e-03  3.154e-05  4.484e-04  3.928e-04
# X16_0SM                      2.815e-04 -7.649e-04  1.007e-04  4.625e-04  3.955e-04
# X16_1SMOH                    3.245e-04 -3.571e-04  1.063e-04  9.889e-04  5.670e-04
# X18_1SM                      3.940e-05 -8.825e-05 -1.296e-04 -1.219e-05  1.294e-04
# PC32_2AA                     3.623e-04  1.782e-03 -3.066e-03 -5.355e-04  4.485e-04
# X18_0SM                      5.376e-05  4.984e-04 -1.215e-03 -3.415e-04  3.310e-04
# X20_2SM                      1.673e-04 -1.014e-04 -5.271e-04 -3.143e-04  1.447e-04
# PC36_0AE                     4.001e-04 -9.370e-04 -3.885e-05  1.311e-03  7.086e-04
# PC36_6AA                     3.265e-03 -9.126e-04 -2.932e-03  3.478e-03  2.298e-03
# PC36_0AA                     1.649e-03 -8.156e-03  2.900e-03  1.345e-02  7.321e-03
# X22_2SMOH                    4.613e-04 -7.522e-04  1.481e-04  8.401e-04  6.455e-04
# X22_1SMOH                    1.761e-04 -2.582e-04 -2.085e-05  2.271e-04  1.493e-04
# PC38_6AA                     3.035e-02 -6.167e-03 -3.165e-02  2.147e-02  2.325e-02
# PC38_0AA                     2.866e-03 -4.770e-03 -7.258e-05  4.548e-03  2.955e-03
# PC40_6AE                     3.476e-03 -1.608e-03 -1.972e-03  1.749e-03  2.686e-03
# X24_1SMOH                    6.372e-04  7.085e-05 -3.075e-04  7.880e-05 -8.190e-06
# PC40_6AA                     1.236e-04 -6.925e-03 -6.292e-03 -9.477e-03  6.132e-04
# PC40_2AA                     1.083e-04 -1.945e-05 -2.253e-05  6.208e-05  5.238e-05
# PC401AA                      9.418e-05 -1.919e-05 -5.651e-05 -2.443e-05 -1.847e-06
# C2                           5.230e-04 -7.357e-04  7.504e-04 -1.235e-03 -1.265e-03
# C3_1                         1.556e-06 -2.584e-06  2.776e-06 -5.135e-07  8.636e-08
# C3                          -1.664e-05 -2.470e-04  4.313e-05  6.324e-05  1.173e-04
# C4_1                         8.748e-07 -3.470e-06  1.627e-06  2.994e-06  3.646e-06
# C4                          -2.243e-06 -4.181e-05  7.883e-06  1.387e-05  1.355e-05
# C3OH                         6.398e-07  3.231e-07 -6.833e-07  5.234e-07  7.604e-07
# C5_1                         3.938e-07 -5.634e-07  5.775e-07 -3.531e-07  1.659e-06
# C5                          -1.682e-05 -5.702e-05  2.090e-05  1.876e-05  3.711e-05
# C4OH                         9.125e-06 -1.539e-05  2.361e-06  4.727e-06  3.494e-06
# C6_1                         1.408e-05  1.384e-06 -3.903e-07  9.167e-06  5.519e-06
# C6                           3.449e-05 -3.092e-07 -8.099e-07  4.009e-06 -4.422e-06
# C5OH                         2.490e-07  4.553e-07  9.337e-10 -7.362e-06  7.367e-06
# C5_1DC                       3.563e-06 -5.965e-06 -1.384e-06  3.552e-06  5.897e-06
# C5DC                         8.018e-07 -8.585e-06  9.204e-06 -4.714e-06  8.682e-06
# C8                           5.959e-06 -2.361e-06 -1.094e-05 -2.547e-06 -3.676e-06
# C5MDC                        1.110e-06  6.455e-07 -1.002e-06 -3.658e-07  5.741e-07
# C9                           9.201e-07 -3.303e-07 -1.060e-06 -3.340e-07 -3.783e-07
# C7DC                         1.679e-06  3.445e-06 -1.124e-06  1.673e-06 -3.226e-06
# C10_2                        4.007e-06  6.431e-06 -3.595e-06 -5.249e-06 -2.009e-06
# C10_1                        5.838e-06  9.039e-07 -2.090e-06  1.527e-06  1.455e-06
# C10                          5.614e-06  2.953e-06 -4.403e-06 -5.628e-08  1.436e-06
# C12_1                        2.118e-06 -3.075e-06 -1.376e-06  3.097e-07  2.934e-07
# C12                          2.294e-06 -2.849e-07 -2.079e-06 -3.694e-07 -6.324e-07
# C14_2                        8.561e-07  9.298e-08 -6.464e-07  4.152e-07 -1.388e-07
# C14_1                        5.363e-06 -8.905e-06 -7.760e-06 -1.952e-06 -1.113e-06
# C14                          6.046e-06 -7.134e-06 -7.559e-06  1.790e-07 -2.030e-06
# C12DC                        1.332e-06  6.168e-07 -1.618e-06 -8.537e-07 -4.790e-07
# C14_2OH                      1.864e-06 -7.266e-08 -2.680e-06 -1.179e-06 -1.029e-06
# C14_1OH                      3.943e-06 -3.712e-06 -4.614e-06  1.202e-06 -1.337e-06
# C16_2                        6.548e-07  3.891e-08 -1.352e-06 -6.889e-07 -6.836e-07
# C16_1                        1.013e-05 -4.324e-06 -2.295e-05 -4.116e-06 -1.131e-05
# C16                          1.521e-05 -4.686e-06 -1.279e-05  3.752e-06 -5.783e-06
# C16_2OH                      2.587e-06 -4.908e-07 -2.312e-06  3.632e-07 -9.579e-07
# C16_1OH                      4.451e-06 -1.521e-06 -4.219e-06  2.111e-06 -8.502e-07
# C16OH                        8.288e-07 -7.492e-07 -7.216e-07 -1.276e-07  7.262e-09
# C18_2                        1.440e-06 -1.357e-06 -3.430e-06 -1.306e-06 -1.844e-06
# C18_1                        1.535e-05 -4.290e-06 -2.366e-05 -9.985e-07 -1.388e-05
# C18                          4.479e-06  7.884e-07 -5.073e-06  1.775e-06 -9.552e-07
# C18_1OH                      1.454e-06 -2.706e-07 -1.333e-06  1.189e-07 -7.094e-07
# Arginine_Average            -5.001e-03  3.337e-03 -4.975e-03 -1.125e-02  2.026e-03
# Betaine_Average              8.433e-03  1.584e-02 -1.496e-02  7.650e-03 -1.231e-02
# C0_Average                   8.540e-04  4.220e-05  2.594e-04 -2.899e-03 -2.750e-04
# Choline_Average              3.637e-04  4.855e-03 -6.929e-03 -2.058e-03  8.556e-04
# Citrate_Average              1.004e-02 -5.571e-02 -1.483e-02  1.015e-02  1.129e-02
# Creatine_Average             2.407e-02 -5.029e-02  5.616e-02 -7.799e-03  1.547e-02
# Creatinine_Average           2.228e-04 -1.299e-03  1.076e-03 -2.752e-04  2.272e-04
# Glucose_Average             -3.221e-01  1.146e-01  1.279e-02 -1.628e-02  2.916e-03
# Glutamate_Average           -4.693e-03 -4.978e-03 -6.687e-03 -4.206e-03  4.921e-04
# Glycine_Average             -1.690e-02 -9.156e-03 -3.089e-02 -3.786e-02  1.104e-02
# Histidine_Average           -2.268e-03 -1.800e-03  9.168e-04 -1.468e-03  8.648e-04
# Isoleucine_Average          -4.134e-03 -1.885e-02 -6.790e-03  8.502e-04  1.128e-02
# Lactate_Average             -1.742e-02 -2.757e-01 -1.146e-03 -1.429e-02 -1.043e-02
# Leucine                     -1.115e-02 -6.772e-03 -1.036e-02 -1.352e-02  1.703e-02
# Methionine                  -2.307e-03 -1.950e-03 -2.212e-03 -3.194e-03  1.054e-03
# Phenylalanine_Average       -4.942e-03 -4.570e-03 -5.709e-03 -3.018e-03  1.946e-03
# Proline                     -2.456e-03 -1.563e-02 -1.554e-03  1.966e-03  1.190e-02
# Pyruvate_Average            -5.700e-04  4.376e-03 -9.273e-03 -1.745e-02 -7.627e-04
# Succinate_Average           -8.097e-05  3.975e-04 -1.116e-03 -4.428e-04 -4.811e-04
# Threonine_Average           -7.505e-03 -7.107e-03  1.888e-03 -1.280e-02  4.251e-03
# Tyrosine_Average            -7.135e-03 -7.039e-03 -5.149e-03 -4.225e-03 -1.524e-03
# Valine_Average              -8.971e-03 -3.414e-02 -9.761e-03  1.762e-03  1.837e-02
# X1_Methylhistidine           1.504e-04  3.988e-04 -1.634e-04  4.241e-05  5.582e-05
# X2_Hydroxybutyrate           1.092e-04 -2.637e-03 -6.227e-04  5.386e-04  5.338e-04
# X2_Hydroxyisovaleric_Acid    2.925e-04  1.498e-07 -1.269e-05  1.467e-04  1.871e-04
# X3_Hydroxybutyrate           4.505e-04 -1.677e-03 -4.507e-04 -6.333e-04 -3.633e-05
# ADP                          3.778e-03  1.724e-02 -9.262e-03  5.176e-03 -6.172e-03
# AMP                          6.567e-03  2.403e-03 -2.518e-04  2.838e-04 -1.295e-02
# ATP                          4.555e-03  4.935e-03 -1.130e-03  2.371e-03 -1.790e-03
# Acetamide                    1.058e-03  1.729e-03 -1.088e-03 -1.612e-04 -4.775e-04
# Acetate                      3.794e-03 -2.162e-03 -2.571e-03 -1.599e-04 -1.060e-03
# Acetoacetate                 3.481e-04 -2.508e-03  2.389e-03 -1.266e-03 -3.381e-04
# Acetone                      1.738e-04 -1.537e-04 -7.594e-05 -5.073e-05 -1.017e-04
# Adenosine                   -6.169e-03  1.114e-02 -1.422e-02 -4.689e-03 -1.221e-02
# Alanine                      2.884e-03 -5.666e-03 -8.483e-03 -1.068e-03 -2.113e-03
# Aspartate                   -2.216e-04 -2.305e-03  6.302e-04 -2.767e-04  7.241e-04
# Creatine_Phosphate           4.482e-05  3.576e-04 -2.190e-04 -3.592e-04 -8.583e-04
# Cytidine                    -9.925e-06 -2.419e-04  1.105e-04 -3.989e-04  2.507e-04
# Dimethyl_Sulfone             6.690e-04 -9.859e-04  2.732e-04  2.158e-04  1.112e-04
# Ethanol                      1.522e-04  4.377e-04  4.664e-04  1.056e-04  5.078e-04
# Ethanolamine                 7.778e-03  1.540e-02 -1.194e-02  2.744e-03 -1.163e-02
# Formate                      6.151e-04  1.317e-03  1.075e-03  1.554e-04  2.029e-03
# Glycerol                    -1.641e-03  1.883e-02 -1.293e-02  3.844e-03  1.929e-02
# Guanidoacetate               7.921e-03  4.638e-03 -6.764e-03 -1.785e-03 -8.919e-03
# Guanosine                   -1.534e-03  1.703e-02 -2.211e-02  3.059e-03 -5.370e-03
# Hypoxanthine                 8.116e-04  3.473e-03 -2.424e-03 -6.613e-05 -1.672e-03
# IMP                         -1.314e-03 -2.141e-02  1.663e-03 -2.959e-03  2.123e-03
# Inosine                      5.894e-03 -2.278e-02  1.868e-02  7.096e-03  9.723e-03
# Isopropanol                  5.406e-05  1.024e-04 -4.131e-05  1.515e-05  4.846e-05
# Malate                      -1.299e-04 -7.497e-04 -1.236e-03 -1.946e-03 -1.278e-03
# Malonate                     1.531e-03 -2.156e-04  1.449e-03 -3.301e-04 -1.543e-03
# Mannose                     -1.396e-03 -1.738e-03  7.372e-04 -2.223e-03 -5.993e-04
# Methanol                     4.668e-03  9.688e-04  4.852e-03 -4.402e-03  9.296e-03
# N_N_Dimethylglycine          1.603e-03  9.391e-04 -6.454e-04 -1.171e-03 -1.141e-03
# Nicotinurate                 2.106e-04 -1.035e-03 -1.866e-03 -1.551e-04  1.667e-04
# O_Acetylcarnitine            4.921e-04 -7.057e-04  1.096e-03 -1.327e-03 -1.175e-03
# O_Phosphocholine             5.374e-04 -6.393e-04  6.074e-05 -1.392e-03  1.815e-04
# Propylene_Glycol             4.958e-04 -1.358e-03  7.604e-04 -4.066e-04 -9.479e-05
# Taurine                      2.856e-01  1.163e-01  1.088e-02 -2.460e-02  3.580e-03
# Uridine                     -5.453e-04 -1.270e-03 -4.622e-04 -7.364e-04  3.309e-04
# Xanthine                     9.657e-05 -1.167e-05  6.035e-05  2.381e-05  1.326e-04
# sn_Glycero_3_Phosphocholine  4.710e-03  1.368e-02 -1.277e-02 -2.375e-03  3.197e-03
# Beta.Alanine                 2.618e-02 -1.185e-02 -8.032e-04 -2.178e-02 -1.638e-02
# RDA6
# Serine                       9.397e-04
# Putrescine                  -1.490e-04
# Trans_Hydroxyproline         1.746e-03
# Asparagine                   2.051e-03
# Glutamine                    1.546e-03
# Alpha_Aminoadipic_Acid       6.246e-06
# Methionine_Sulfoxide         2.095e-04
# Acetyl_Ornithine             9.032e-05
# Citrulline                   8.443e-04
# Asymmetric_Dimethylarginine  6.631e-06
# Total_Dimethylarginine      -6.493e-06
# Tryptophan                   7.562e-04
# Kynurenine                   4.518e-05
# Ornithine                    2.541e-04
# Lysine                      -3.437e-04
# Spermidine                   2.760e-04
# Spermine                    -5.471e-04
# Sarcosine                    1.474e-03
# Methylhistidine             -9.366e-04
# Beta_Hydroxybutyric_Acid     9.259e-04
# Alpha_Ketoglutaric_Acid     -3.449e-04
# Butyric_acid                -1.067e-04
# Propionic_Acid              -1.969e-03
# Fumaric_Acid                 1.538e-04
# Isobutyric_Acid             -7.880e-05
# Hippuric_Acid               -2.011e-06
# Methylmalonic_Acid           3.182e-06
# LYSOC14_0                   -1.051e-04
# LYSOC16_1                   -3.998e-04
# LYSOC16_0                   -1.840e-03
# LYSOC17_0                   -1.143e-04
# LYSOC18_2                   -4.226e-05
# LYSOC18_1                   -3.706e-04
# LYSOC18_0                   -8.114e-05
# LYSOC20_4                   -2.300e-05
# LYSOC20_3                   -2.789e-04
# LYSOC24_0                   -1.116e-04
# LYSOC26_1                   -4.801e-05
# LYSOC26_0                   -5.121e-05
# LYSOC28_1                   -2.550e-05
# LYSOC28_0                   -3.443e-05
# X14_1SMOH                   -1.494e-04
# X16_1SM                     -2.157e-04
# X16_0SM                     -9.623e-05
# X16_1SMOH                   -5.163e-05
# X18_1SM                     -5.858e-05
# PC32_2AA                    -1.088e-03
# X18_0SM                     -5.090e-04
# X20_2SM                     -7.891e-05
# PC36_0AE                     2.144e-05
# PC36_6AA                    -7.405e-04
# PC36_0AA                     2.389e-03
# X22_2SMOH                    9.439e-05
# X22_1SMOH                   -2.141e-06
# PC38_6AA                    -2.175e-02
# PC38_0AA                    -5.988e-04
# PC40_6AE                    -1.453e-03
# X24_1SMOH                   -2.935e-04
# PC40_6AA                    -2.767e-03
# PC40_2AA                    -6.008e-05
# PC401AA                     -3.204e-05
# C2                          -1.124e-03
# C3_1                        -1.969e-07
# C3                           7.189e-05
# C4_1                        -2.115e-06
# C4                           1.303e-05
# C3OH                        -4.064e-07
# C5_1                        -6.409e-07
# C5                           2.200e-05
# C4OH                        -2.616e-08
# C6_1                        -1.043e-05
# C6                          -1.183e-05
# C5OH                        -7.160e-08
# C5_1DC                      -6.602e-07
# C5DC                        -1.347e-05
# C8                          -5.099e-08
# C5MDC                       -7.209e-07
# C9                          -6.409e-07
# C7DC                        -5.235e-06
# C10_2                       -3.335e-06
# C10_1                       -1.019e-05
# C10                         -4.833e-06
# C12_1                       -2.326e-06
# C12                          1.921e-07
# C14_2                        2.213e-07
# C14_1                        2.890e-06
# C14                          2.605e-06
# C12DC                       -3.306e-07
# C14_2OH                      9.406e-08
# C14_1OH                      1.249e-06
# C16_2                        7.490e-08
# C16_1                        4.437e-06
# C16                         -1.226e-06
# C16_2OH                      4.172e-07
# C16_1OH                      1.314e-07
# C16OH                        1.392e-07
# C18_2                        8.894e-07
# C18_1                        2.492e-06
# C18                         -1.209e-06
# C18_1OH                     -2.549e-07
# Arginine_Average             8.184e-04
# Betaine_Average              4.819e-03
# C0_Average                  -8.529e-04
# Choline_Average             -2.505e-03
# Citrate_Average              5.780e-03
# Creatine_Average             9.155e-03
# Creatinine_Average          -3.166e-04
# Glucose_Average             -1.148e-02
# Glutamate_Average           -2.837e-04
# Glycine_Average              5.839e-03
# Histidine_Average            1.950e-03
# Isoleucine_Average           2.753e-03
# Lactate_Average             -1.037e-02
# Leucine                      2.080e-03
# Methionine                   1.377e-03
# Phenylalanine_Average        1.750e-03
# Proline                      5.953e-03
# Pyruvate_Average             2.297e-03
# Succinate_Average            3.006e-04
# Threonine_Average            2.117e-03
# Tyrosine_Average             6.228e-04
# Valine_Average               3.973e-03
# X1_Methylhistidine          -3.853e-04
# X2_Hydroxybutyrate          -3.603e-04
# X2_Hydroxyisovaleric_Acid   -1.339e-04
# X3_Hydroxybutyrate           8.843e-04
# ADP                         -6.616e-03
# AMP                         -3.979e-03
# ATP                          1.265e-03
# Acetamide                   -5.813e-04
# Acetate                      1.200e-03
# Acetoacetate                -2.506e-03
# Acetone                      1.753e-04
# Adenosine                    1.355e-02
# Alanine                     -3.046e-04
# Aspartate                    2.391e-04
# Creatine_Phosphate           9.037e-04
# Cytidine                    -1.296e-04
# Dimethyl_Sulfone             2.552e-04
# Ethanol                     -2.710e-04
# Ethanolamine                 1.364e-03
# Formate                     -5.886e-04
# Glycerol                     9.031e-03
# Guanidoacetate              -2.157e-03
# Guanosine                    5.255e-03
# Hypoxanthine                 8.144e-04
# IMP                         -4.220e-03
# Inosine                     -6.665e-03
# Isopropanol                 -4.667e-05
# Malate                       4.290e-04
# Malonate                     6.477e-04
# Mannose                     -7.873e-04
# Methanol                    -8.452e-03
# N_N_Dimethylglycine         -1.008e-03
# Nicotinurate                 1.294e-03
# O_Acetylcarnitine           -1.133e-03
# O_Phosphocholine             1.204e-04
# Propylene_Glycol            -6.693e-04
# Taurine                     -1.012e-02
# Uridine                      5.155e-05
# Xanthine                    -9.588e-05
# sn_Glycero_3_Phosphocholine -7.599e-04
# Beta.Alanine                -6.183e-03
# 
# 
# Site scores (weighted sums of species scores)
# 
# RDA1      RDA2      RDA3     RDA4      RDA5    RDA6
# row1  -0.868408  0.103232 -0.429189  0.23378  0.072269 -0.1232
# row2  -0.519997  0.147679  0.286663  0.24275  0.032785 -0.2534
# row3   0.598169  0.381724  0.051314  0.07209 -0.163442  0.7847
# row4  -0.490328  0.205677  0.082847  0.08931 -0.108751 -0.4372
# row5  -0.893091  0.342891 -0.063198  0.25011  0.276417  0.4708
# row6  -0.133920  0.263370 -0.022004 -0.30795 -0.059964 -0.1885
# row7  -0.652993 -0.260563 -0.329601  0.21268 -0.480277 -0.7226
# row8  -0.220682  0.005059 -0.256628 -0.34265 -0.231616 -0.5496
# row9   0.400611  0.095434 -0.224104 -0.38830 -0.271619  0.3889
# row10  0.863145 -0.287019 -0.543651 -0.10236 -0.515462  1.3366
# row11 -0.164328 -0.061703  0.018617 -0.48331 -0.484710  0.1028
# row12  0.606982  0.395541  0.009979  0.08292 -0.111342  0.3834
# row13 -0.358159 -0.348853 -0.181287  0.19136 -0.539760 -0.2307
# row14  0.553527 -0.136489 -0.097718 -0.01118 -0.589483  0.3636
# row15  0.790715  0.446702 -0.067930  0.04820 -0.213597  0.8513
# row16 -0.114007 -0.294980 -0.376343 -0.12209 -0.217665 -0.5910
# row17  0.327935  0.293637 -0.293672  0.12299 -0.338908 -0.1870
# row18 -0.195698  0.499576  0.069855  0.26208  0.470373 -0.6057
# row19  0.750270  0.676221  0.020726  0.31501  0.255684  0.7508
# row20 -0.940262 -0.156347 -0.289903  1.21967  0.078388 -1.1297
# row21 -0.195878  0.129581 -0.525753 -0.85790  0.492512 -0.4122
# row22 -0.078846  0.439445  0.025600 -0.30663  0.335790 -0.3135
# row23  0.543593  0.169292 -0.158823 -0.14773  0.889607  1.2850
# row24  0.466234  0.373100 -0.234059 -0.22527  0.361507  0.0262
# row25  0.098703  0.054472 -0.026106 -0.16436 -0.210648 -0.8679
# row26  0.470467  0.382226  0.405781 -0.11398  0.198777  0.1722
# row27 -0.577613  0.135242  0.342826  0.19299  0.306388 -0.8687
# row28 -0.638519 -0.011646  0.107251  0.38530 -0.007041 -0.7469
# row29 -0.247957  0.015164  0.338948 -0.28280 -0.148468 -0.1499
# row30  0.152309  0.214981  0.275597 -0.41902 -0.018281 -0.2712
# row31 -0.809263 -0.226779  0.402342  0.25685 -0.087993  0.1804
# row32 -0.523608  0.137005  0.350542  0.17101  0.026117 -0.3770
# row33  0.753078 -0.294147  0.516239 -0.24056  0.410999  1.3977
# row34 -0.196427 -0.349099 -0.153296  0.01112 -0.419859 -0.6430
# row35  0.299288 -0.783017 -0.119147 -0.40437 -0.406384  0.2200
# row36  0.016737  0.146060  0.138744 -0.08447  0.045767 -0.8162
# row37  0.702405  0.137912  0.415397 -0.27070  0.058967  0.6941
# row38  0.672416  0.146560  0.327314 -0.12929  0.120193  0.7961
# row39  0.194107  0.246213  0.124881 -0.28847  0.013459 -0.2926
# row40 -0.625299  0.146586  0.283689  0.31675  0.036914 -0.1654
# row41 -0.489563 -0.097675  0.054806  0.14255  0.004322 -0.5030
# row42 -0.427370 -0.143038  0.226588  0.21586  0.536365 -0.1426
# row43  0.880082 -1.029489 -0.559896  0.52667  0.529833  1.7332
# row44 -0.315740  0.068809  0.298769  0.09374  0.260366 -0.5254
# row45  0.316005 -0.025945 -0.048648 -0.01165 -0.370364 -0.4798
# row46  0.727523 -0.736697 -0.132887  0.19061  0.029498  1.1973
# row47  0.003142 -0.194464 -0.155097 -0.36691 -0.641962 -1.2793
# row48  0.394773 -0.251579 -0.231736 -0.27385 -0.031275 -0.1385
# row49 -0.391583 -0.017472  0.051328 -0.02658  0.062398 -0.4068
# row50  0.693289 -0.344156  0.118359  0.19767  0.377764  0.7211
# row51 -0.187518 -0.582325 -0.366524  0.19167 -0.308508 -0.6354
# row52 -0.929883  0.293571  0.348689  0.65450  0.350925  0.2225
# row53  0.282701 -0.439687 -0.013640 -0.35703  0.154719  0.7944
# row54 -0.371268 -0.019795  0.207153 -0.16079  0.188276  0.1808
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# RDA1       RDA2     RDA3      RDA4       RDA5      RDA6
# row1  -0.234902 -3.094e-02 -0.27578 -0.194239 -2.576e-01 -0.032116
# row2   0.193134  1.620e-01 -0.03618  0.074552 -3.378e-01  0.078148
# row3  -0.009598  1.604e-01 -0.03036  0.298438 -2.829e-01  0.113746
# row4   0.097731  1.612e-01 -0.03344  0.179910 -3.119e-01  0.094900
# row5  -0.265697  9.118e-06 -0.22145 -0.093920 -1.687e-01  0.118941
# row6  -0.261138 -3.116e-02 -0.27503 -0.165266 -2.505e-01 -0.027509
# row7  -0.375516 -1.650e-02 -0.24502 -0.005797 -1.793e-01  0.065400
# row8   0.142469  5.019e-02 -0.15302 -0.445210 -1.584e-01  0.265746
# row9  -0.380392 -3.214e-02 -0.27160 -0.033568 -2.182e-01 -0.006569
# row10  0.016059  4.914e-02 -0.14939 -0.305611 -1.242e-01  0.287942
# row11  0.147556  9.703e-02 -0.07300 -0.351362 -3.896e-02  0.483327
# row12  0.193345  1.932e-01  0.01725  0.140630 -2.573e-01  0.223761
# row13 -0.019138  1.603e-01 -0.03008  0.308974 -2.803e-01  0.115422
# row14 -0.031064  1.602e-01 -0.02974  0.322144 -2.770e-01  0.117516
# row15  0.298395  2.097e-01  0.04096  0.057774 -2.454e-01  0.278140
# row16 -0.064019  1.548e-01 -0.29820 -0.153457  2.859e-01 -0.174778
# row17  0.180049  2.995e-01 -0.13348  0.219032  1.348e-01 -0.250685
# row18  0.115652  2.990e-01 -0.13163  0.290149  1.522e-01 -0.239378
# row19  0.117931  2.834e-01 -0.15841  0.254476  1.113e-01 -0.312603
# row20  0.177664  2.995e-01 -0.13341  0.221666  1.354e-01 -0.250266
# row21  0.021949  1.712e-01 -0.27395 -0.215241  3.029e-01 -0.117048
# row22  0.143588  1.722e-01 -0.27744 -0.349573  2.700e-01 -0.138407
# row23 -0.051566  2.329e-01 -0.16495 -0.001433  4.840e-01  0.187160
# row24 -0.077907  2.171e-01 -0.19091 -0.005499  4.508e-01  0.118960
# row25  0.252259 -1.960e-01  0.10592  0.184027  9.261e-02  0.068581
# row26  0.016400  6.502e-02  0.31388 -0.082779  6.851e-02  0.042967
# row27 -0.067183  4.873e-02  0.28956 -0.023629  5.086e-02 -0.015181
# row28 -0.160201  4.796e-02  0.29224  0.079095  7.605e-02  0.001152
# row29 -0.071953  4.869e-02  0.28970 -0.018361  5.215e-02 -0.014343
# row30  0.097599  8.129e-02  0.33827 -0.139294  8.680e-02  0.101535
# row31 -0.009835  6.481e-02  0.31464 -0.053805  7.561e-02  0.047574
# row32  0.016506  8.062e-02  0.34060 -0.049740  1.088e-01  0.115774
# row33  0.111593  3.461e-02  0.25770 -0.254214 -3.784e-02 -0.119397
# row34 -0.294611 -7.796e-02  0.08233 -0.037713 -2.098e-01 -0.557846
# row35  0.025518  2.694e-03  0.20673 -0.225470 -9.509e-02 -0.249933
# row36  0.573823 -2.557e-01 -0.01021 -0.303713 -1.556e-01 -0.279182
# row37 -0.046140 -1.350e-02  0.18207 -0.179490 -1.160e-01 -0.310176
# row38 -0.043438  3.333e-02  0.26216 -0.083007  4.147e-03 -0.092175
# row39 -0.034214 -1.340e-02  0.18173 -0.192659 -1.192e-01 -0.312270
# row40 -0.455201 -1.410e-01  0.07241  0.287737  1.429e-01  0.049534
# row41 -0.132898 -9.158e-02  0.14331  0.031269  1.765e-01  0.211415
# row42  0.088440 -3.839e-01 -0.11768  0.247800  1.240e-01  0.093929
# row43  0.100365 -3.838e-01 -0.11802  0.234631  1.207e-01  0.091835
# row44 -0.123357 -9.150e-02  0.14303  0.020733  1.739e-01  0.209739
# row45  0.125059 -9.222e-03  0.20074  0.255800 -1.395e-01 -0.158231
# row46  0.222215 -3.516e-01 -0.06808  0.166376  1.683e-01  0.216088
# row47  0.185806 -4.455e-01 -0.22736  0.007653 -6.353e-02 -0.214468
# row48 -0.039985 -1.064e-01  0.11391 -0.104494  1.110e-01  0.122275
# row49 -0.130829 -1.384e-01  0.06308 -0.070481  5.509e-02 -0.007423
# row50  0.281631 -3.823e-01 -0.12323  0.034450  7.165e-02  0.060006
# row51  0.100048 -4.306e-01 -0.19817  0.135514 -2.257e-05 -0.126584
# row52 -0.209431 -1.234e-01  0.09206  0.049478  1.167e-01  0.079204
# row53 -0.207363 -1.702e-01  0.01184 -0.052272 -4.751e-03 -0.139634
# row54 -0.245208 -1.237e-01  0.09309  0.088987  1.263e-01  0.085486
# 
# 
# Biplot scores for constraining variables
# 
#                 RDA1     RDA2    RDA3     RDA4     RDA5     RDA6
# SiteMatheson   0.07909 -0.01055  0.7447 -0.29828 -0.02549 -0.33979
# SiteRed River -0.10559  0.27926 -0.3815 -0.04592 -0.73202  0.47025
# SiteSandy Bar  0.14626  0.55290 -0.4576  0.06754  0.60424 -0.30560
# FL            -0.25229 -0.21374 -0.3232 -0.76709 -0.28536 -0.33723
# SexM           0.33495  0.55372 -0.1065  0.61061 -0.37202 -0.04411
# SexUN          0.49152 -0.77072 -0.2061  0.19250  0.09754 -0.02446
# Age           -0.57335 -0.05945 -0.3495 -0.47934 -0.43008 -0.32950
# 
# 
# Centroids for factor constraints
# 
#                     RDA1      RDA2      RDA3     RDA4      RDA5      RDA6
# SiteDauphin River -0.02938 -0.224890  0.005397  0.08888  0.078618  0.038211
# SiteMatheson       0.02441 -0.003257  0.229821 -0.09205 -0.007867 -0.104861
# SiteRed River     -0.03258  0.086179 -0.117726 -0.01417 -0.225903  0.145120
# SiteSandy Bar      0.06259  0.236614 -0.195819  0.02890  0.258588 -0.130783
# SexF              -0.09540  0.013250  0.035723 -0.09795  0.036480  0.008215
# SexM               0.11993  0.198260 -0.038148  0.21863 -0.133201 -0.015794
# SexUN              0.22557 -0.353704 -0.094603  0.08834  0.044764 -0.011224

plot(RDA_met18factors_small2, scaling=0)
plot(RDA_met18factors_small2, scaling=1)
plot(RDA_met18factors_small2, scaling=2) # this one good

anova(RDA_met18factors_small2)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ Site + FL + Sex + Age, data = Factors4)
# Df Variance      F Pr(>F)
# Model     7 0.012119 1.2908  0.248
# Residual 46 0.061698    
plot(RDA_met18factors_small2, scaling=0)
plot(RDA_met18factors_small2, scaling=1)
plot(RDA_met18factors_small2, scaling=2)
plot(RDA_met18factors_small2, scaling=3)
plot(RDA_met18factors_small2, scaling=3, points(scrs$sites),
     with(scrs, text(species, labels = rownames(species),
                     col = "darkcyan", cex = 0.8)))
# didnt work
plot(RDA_met18factors_small2, scaling=1, type="t") # yeah
#plot with all variables is pixelate dtho
plot(RDA_met18factors_small2, type="n")
text(RDA_met18factors_small2,display="cn")
points(RDA_met18factors_small2,col="red")
text(RDA_met18factors_small2, "species",  cex=0.8, col="blue")

plot(RDA_met18factors_small2, type="n")
text(RDA_met18factors_small2,display="cn")
points(RDA_met18factors_small2,col="red")
text(RDA_met18factors_small2, "sites",  cex=0.8, col="blue")

anova(RDA_met18factors_small2, by="term", permutations=199)
# Permutation test for rda under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ Site + FL + Sex + Age, data = Factors4)
# Df Variance      F Pr(>F)
# Site      3 0.003612 0.8976  0.520
# FL        1 0.000893 0.6655  0.485
# Sex       2 0.004521 1.6852  0.160
# Age       1 0.003094 2.3068  0.110
# Residual 46 0.061698  
anova(RDA_met18factors_small2, by="mar", permutations=199)
# Permutation test for rda under reduced model
# Marginal effects of terms
# Permutation: free
# Number of permutations: 199
# 
# Model: rda(formula = Metabolites18T ~ Site + FL + Sex + Age, data = Factors4)
# Df Variance      F Pr(>F)
# Site      3 0.002541 0.6314   0.63
# FL        1 0.002307 1.7202   0.14
# Sex       2 0.002987 1.1137   0.33
# Age       1 0.003094 2.3068   0.10
# Residual 46 0.061698 

#### RDA with vegan ####
#data normalized
# redundancy analysis constraint by the factor variables
RDA_met18 <- rda(Metabolites18T~.,Factors18T)
summary(RDA_met18)
# Call:
#   rda(formula = Metabolites18T ~ TL + FL + W + K + Sex + Spine.Age,      data = Factors18T) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         0.073818     1.0000
# Constrained   0.009178     0.1243
# Unconstrained 0.064640     0.8757
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#                         RDA1    RDA2      RDA3      RDA4      RDA5      RDA6
# Eigenvalue            0.007334 0.00134 0.0002362 0.0001651 5.753e-05 4.498e-05
# Proportion Explained  0.099357 0.01815 0.0031992 0.0022363 7.794e-04 6.093e-04
# Cumulative Proportion 0.099357 0.11751 0.1207062 0.1229426 1.237e-01 1.243e-01
#                         PC1    PC2      PC3      PC4       PC5       PC6
# Eigenvalue            0.04909 0.0117 0.001219 0.000551 0.0004513 0.0002991
# Proportion Explained  0.66504 0.1584 0.016519 0.007465 0.0061132 0.0040519
# Cumulative Proportion 0.78937 0.9478 0.964327 0.971792 0.9779053 0.9819571
#                         PC7       PC8       PC9      PC10      PC11      PC12
# Eigenvalue            0.0002526 0.0002073 0.0001717 0.0001477 0.0001326 8.413e-05
# Proportion Explained  0.0034225 0.0028079 0.0023260 0.0020015 0.0017957 1.140e-03
# Cumulative Proportion 0.9853796 0.9881875 0.9905136 0.9925151 0.9943107 9.955e-01
# PC13      PC14      PC15      PC16      PC17      PC18
# Eigenvalue            6.131e-05 4.458e-05 0.0000365 2.824e-05 2.535e-05 2.251e-05
# Proportion Explained  8.306e-04 6.039e-04 0.0004944 3.826e-04 3.435e-04 3.049e-04
# Cumulative Proportion 9.963e-01 9.969e-01 0.9973792 9.978e-01 9.981e-01 9.984e-01
# PC19      PC20      PC21      PC22      PC23      PC24
# Eigenvalue            1.867e-05 1.617e-05 1.234e-05 1.079e-05 9.524e-06 7.759e-06
# Proportion Explained  2.529e-04 2.191e-04 1.672e-04 1.462e-04 1.290e-04 1.051e-04
# Cumulative Proportion 9.987e-01 9.989e-01 9.990e-01 9.992e-01 9.993e-01 9.994e-01
# PC25      PC26      PC27      PC28      PC29      PC30
# Eigenvalue            7.565e-06 6.214e-06 5.061e-06 3.613e-06 3.090e-06 2.564e-06
# Proportion Explained  1.025e-04 8.418e-05 6.856e-05 4.895e-05 4.186e-05 3.474e-05
# Cumulative Proportion 9.995e-01 9.996e-01 9.997e-01 9.997e-01 9.998e-01 9.998e-01
# PC31      PC32      PC33      PC34      PC35      PC36
# Eigenvalue            2.424e-06 1.945e-06 1.683e-06 1.329e-06 1.206e-06 1.012e-06
# Proportion Explained  3.283e-05 2.635e-05 2.281e-05 1.800e-05 1.634e-05 1.371e-05
# Cumulative Proportion 9.998e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01 9.999e-01
# PC37      PC38      PC39      PC40      PC41      PC42
# Eigenvalue            7.538e-07 6.729e-07 5.721e-07 5.050e-07 4.727e-07 4.433e-07
# Proportion Explained  1.021e-05 9.116e-06 7.750e-06 6.841e-06 6.403e-06 6.005e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# PC43      PC44      PC45      PC46      PC47
# Eigenvalue            3.123e-07 2.198e-07 1.886e-07 1.567e-07 9.145e-08
# Proportion Explained  4.231e-06 2.977e-06 2.555e-06 2.123e-06 1.239e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#                          RDA1    RDA2      RDA3      RDA4      RDA5      RDA6
# Eigenvalue            0.007334 0.00134 0.0002362 0.0001651 5.753e-05 4.498e-05
# Proportion Explained  0.799132 0.14598 0.0257313 0.0179870 6.269e-03 4.900e-03
# Cumulative Proportion 0.799132 0.94511 0.9708440 0.9888310 9.951e-01 1.000e+00
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  1.4064 
# 
# 
# Species scores
# 
#                               RDA1       RDA2       RDA3       RDA4       RDA5
# Serine                      -4.505e-03 -1.793e-03  1.261e-02  6.339e-03 -6.410e-03
# Putrescine                   4.882e-04  2.571e-04  2.836e-04  7.105e-04  1.128e-03
# Trans_Hydroxyproline         2.129e-03  3.986e-04 -1.175e-03 -8.517e-05  3.323e-03
# Asparagine                   1.204e-03  9.132e-04 -8.311e-04 -1.759e-04  3.709e-03
# Glutamine                   -1.311e-03  3.328e-04  3.062e-03  5.764e-04  3.930e-04
# Alpha_Aminoadipic_Acid       4.506e-04  1.951e-04  5.404e-04 -4.219e-04 -1.868e-05
# Methionine_Sulfoxide        -7.183e-04 -1.955e-05  5.959e-04  5.023e-04 -1.758e-04
# Acetyl_Ornithine             9.540e-05  3.943e-05  4.064e-05 -1.458e-05  6.217e-05
# Citrulline                   4.077e-03  1.231e-03 -1.360e-02 -1.798e-02  5.861e-04
# Asymmetric_Dimethylarginine  5.922e-06  1.121e-07  3.754e-05  3.080e-05  7.526e-06
# Total_Dimethylarginine       2.200e-05 -2.217e-05  7.340e-05  8.056e-05  1.498e-06
# Tryptophan                   3.753e-04 -4.127e-04  5.409e-04 -4.505e-04  6.128e-04
# Kynurenine                  -1.591e-05 -3.287e-06  4.809e-05 -3.865e-05 -6.432e-06
# Ornithine                   -6.561e-04  2.005e-04  1.634e-03  1.029e-03 -8.151e-04
# Lysine                      -4.256e-03  2.136e-03  6.642e-03  4.419e-03 -4.449e-03
# Spermidine                   1.103e-03  5.608e-04 -7.839e-06  2.387e-04  1.147e-03
# Spermine                     2.348e-03 -2.836e-04 -1.043e-03  2.337e-04  1.477e-03
# Sarcosine                   -8.047e-04 -7.114e-04  4.008e-03  1.983e-03 -4.056e-04
# Methylhistidine              3.940e-04 -2.932e-03  1.366e-03  4.184e-03 -2.069e-03
# Beta_Hydroxybutyric_Acid     1.249e-03 -5.116e-04  6.492e-04 -3.261e-05  2.826e-05
# Alpha_Ketoglutaric_Acid      1.374e-03 -7.311e-04  6.283e-04  1.014e-03 -8.022e-04
# Butyric_acid                 1.385e-04 -8.486e-05 -8.333e-05  1.158e-04  4.354e-05
# Propionic_Acid               6.869e-04 -4.401e-04 -1.541e-03  2.300e-03 -3.382e-04
# Fumaric_Acid                 3.472e-04 -7.947e-04  2.749e-03  5.203e-04 -3.663e-04
# Isobutyric_Acid              3.136e-04 -1.527e-04 -1.354e-04  5.512e-05  2.075e-04
# Hippuric_Acid                8.279e-07 -1.067e-06 -2.944e-06  2.085e-06  3.402e-07
# Methylmalonic_Acid           2.358e-06  5.050e-06 -8.854e-08  4.835e-06  5.279e-06
# LYSOC14_0                    9.717e-05 -1.446e-05 -7.310e-05 -1.604e-04  1.444e-05
# LYSOC16_1                    4.367e-04 -2.838e-04 -2.983e-04 -1.051e-03  1.564e-04
# LYSOC16_0                    1.426e-03 -1.117e-03 -1.657e-03 -3.548e-03  2.639e-04
# LYSOC17_0                    6.523e-05 -2.950e-05 -9.389e-05 -1.724e-04 -2.938e-06
# LYSOC18_2                    4.060e-05 -7.416e-05  1.271e-05 -7.645e-06 -2.285e-05
# LYSOC18_1                    2.257e-04 -4.362e-04  1.798e-04 -2.167e-05 -2.023e-04
# LYSOC18_0                    1.766e-05 -1.351e-04  1.474e-04  9.247e-05 -1.258e-04
# LYSOC20_4                    4.842e-04 -2.251e-04  4.710e-05 -1.519e-04  1.656e-04
# LYSOC20_3                    1.050e-04 -7.445e-05 -1.624e-04  1.611e-04  2.248e-05
# LYSOC24_0                   -1.127e-05 -1.677e-05 -7.842e-05  3.659e-05 -1.037e-04
# LYSOC26_1                    2.295e-05 -2.564e-05 -4.045e-05  2.562e-05 -2.205e-05
# LYSOC26_0                   -5.491e-06 -1.332e-05 -4.938e-05 -2.800e-06 -3.941e-05
# LYSOC28_1                    3.677e-05  2.822e-06 -4.046e-05  3.773e-06  8.407e-06
# LYSOC28_0                    6.330e-06 -8.725e-06 -3.980e-05  1.426e-05 -3.613e-05
# X14_1SMOH                    2.557e-04 -2.562e-06 -1.591e-04 -1.127e-04  1.086e-04
# X16_1SM                      7.669e-04 -3.554e-04 -2.687e-04 -1.232e-04  3.317e-04
# X16_0SM                      6.606e-04 -1.140e-04 -3.106e-04 -1.147e-04  2.616e-04
# X16_1SMOH                    5.681e-04  2.015e-04 -5.457e-04 -5.615e-04  4.741e-04
# X18_1SM                      1.018e-04 -1.734e-05  8.664e-05 -3.018e-05  9.663e-06
# PC32_2AA                    -8.272e-05 -4.321e-04  1.494e-03 -8.433e-04 -9.861e-04
# X18_0SM                      6.035e-06 -1.425e-04  8.419e-04 -2.400e-04 -2.855e-04
# X20_2SM                      2.317e-04 -1.028e-04  5.137e-04 -5.279e-05 -1.234e-04
# PC36_0AE                     9.533e-04 -1.944e-05 -7.620e-04 -6.486e-04  4.596e-04
# PC36_6AA                     3.863e-03  3.591e-04  1.925e-04 -3.817e-03  1.544e-03
# PC36_0AA                     6.873e-03  2.993e-03 -7.703e-03 -6.304e-03  7.113e-03
# X22_2SMOH                    8.453e-04  1.680e-04 -4.957e-04 -4.514e-04  4.059e-04
# X22_1SMOH                    2.997e-04 -1.274e-05 -9.888e-05 -1.529e-04  7.277e-05
# PC38_6AA                     3.574e-02 -8.064e-03 -1.467e-03 -1.915e-02  2.813e-03
# PC38_0AA                     5.032e-03 -4.403e-04 -2.112e-03 -2.718e-03  2.175e-03
# PC40_6AE                     4.294e-03 -1.694e-04 -2.229e-04 -1.411e-03  1.749e-04
# X24_1SMOH                    4.854e-04 -1.862e-04 -9.333e-06 -1.781e-04 -1.294e-04
# PC40_6AA                     2.695e-03 -6.374e-03  7.409e-03  5.414e-03 -4.405e-03
# PC40_2AA                     1.058e-04 -3.278e-05 -8.400e-05 -2.569e-05 -3.039e-05
# PC401AA                      8.056e-05 -4.780e-05 -1.046e-06  1.002e-06 -5.706e-05
# C2                           4.421e-04 -1.791e-03 -4.085e-04  1.128e-03 -1.161e-03
# C3_1                         1.550e-06 -1.725e-06 -3.276e-06  1.732e-06 -5.508e-07
# C3                           1.143e-04  2.133e-05 -3.757e-05  1.783e-05  6.297e-05
# C4_1                         2.463e-06 -7.329e-07 -3.255e-06 -3.572e-07  2.005e-06
# C4                           2.082e-05 -3.981e-06 -7.740e-06 -6.522e-06  1.222e-05
# C3OH                         5.622e-07 -2.261e-08 -4.944e-07 -7.750e-08  1.297e-07
# C5_1                         6.601e-07  1.176e-07 -7.357e-07  1.124e-06  5.652e-07
# C5                           1.866e-05  1.505e-05 -9.331e-06  8.570e-07  2.763e-05
# C4OH                         1.551e-05 -4.939e-06 -9.555e-07 -9.315e-06  1.143e-06
# C6_1                         1.189e-05 -6.215e-06 -1.175e-05 -3.469e-06  4.021e-06
# C6                           2.573e-05 -3.070e-05 -3.360e-05 -1.562e-06 -1.098e-05
# C5OH                         1.463e-06  2.797e-06  1.036e-06  7.749e-06  2.246e-07
# C5_1DC                       6.848e-06 -9.982e-07 -2.337e-06 -1.266e-06  3.635e-06
# C5DC                         1.066e-06 -1.107e-05 -1.073e-05  8.142e-06  2.394e-06
# C8                           8.152e-06 -1.138e-05 -1.258e-06 -3.265e-06 -7.841e-06
# C5MDC                        5.749e-07 -7.766e-07 -4.108e-07  4.751e-07  2.314e-07
# C9                           1.024e-06 -1.023e-06  4.504e-07 -9.874e-08 -7.419e-07
# C7DC                         1.576e-06  9.855e-07  2.675e-06 -2.643e-06 -4.336e-06
# C10_2                        1.144e-06 -4.978e-06 -1.485e-06  4.376e-06 -3.635e-06
# C10_1                        4.669e-06 -7.948e-06 -6.125e-06  2.368e-06 -6.498e-08
# C10                          3.878e-06 -4.221e-06 -2.957e-06  1.260e-06 -1.618e-06
# C12_1                        3.263e-06 -3.914e-06 -6.966e-07 -2.155e-07  2.189e-07
# C12                          2.222e-06 -2.167e-06 -2.929e-07 -3.279e-07 -8.950e-07
# C14_2                        8.063e-07 -4.827e-07 -3.834e-07 -5.467e-07 -9.578e-08
# C14_1                        9.611e-06 -6.784e-06  4.626e-06 -2.926e-06 -2.658e-06
# C14                          9.456e-06 -6.285e-06  3.248e-06 -4.742e-06 -2.563e-06
# C12DC                        1.012e-06 -1.051e-06  5.749e-07  2.195e-07 -7.546e-07
# C14_2OH                      1.941e-06 -1.828e-06  1.594e-06 -4.723e-07 -1.014e-06
# C14_1OH                      5.917e-06 -3.654e-06  1.483e-06 -3.648e-06 -1.416e-06
# C16_2                        6.287e-07 -1.144e-06  6.020e-07  1.645e-09 -5.850e-07
# C16_1                        1.299e-05 -1.720e-05  1.096e-05 -1.074e-05 -8.723e-06
# C16                          1.766e-05 -1.315e-05 -3.403e-07 -9.540e-06 -7.018e-06
# C16_2OH                      2.860e-06 -1.901e-06  1.085e-07 -1.424e-06 -1.014e-06
# C16_1OH                      5.434e-06 -2.845e-06  2.190e-07 -3.729e-06 -1.510e-06
# C16OH                        1.253e-06 -6.509e-07  3.235e-07 -2.381e-07 -1.616e-07
# C18_2                        2.143e-06 -2.574e-06  2.367e-06 -1.152e-06 -1.635e-06
# C18_1                        1.853e-05 -1.864e-05  8.347e-06 -1.344e-05 -1.431e-05
# C18                          4.812e-06 -3.205e-06  4.312e-08 -3.194e-06 -2.131e-06
# C18_1OH                      1.603e-06 -1.324e-06  6.186e-08 -7.202e-07 -8.488e-07
# Arginine_Average            -5.124e-03  1.154e-03  7.811e-03  6.926e-03 -4.715e-03
# Betaine_Average              2.826e-03  6.648e-04  3.347e-03 -1.444e-02 -3.774e-03
# C0_Average                   7.624e-04 -1.129e-03  2.952e-04  2.825e-03 -1.130e-03
# Choline_Average             -3.035e-04 -6.056e-04  3.546e-03  3.670e-04 -2.506e-03
# Citrate_Average              4.093e-02 -9.306e-03  1.242e-02 -5.072e-03 -2.958e-04
# Creatine_Average             3.571e-02 -6.543e-03 -4.754e-02  3.105e-02  3.685e-05
# Creatinine_Average           7.171e-04 -3.385e-04 -5.612e-04  8.859e-04  7.709e-05
# Glucose_Average             -3.673e-01  1.777e-02  1.152e-02  1.069e-02  1.470e-02
# Glutamate_Average           -1.027e-03 -2.539e-03  7.931e-03  1.762e-03 -1.509e-03
# Glycine_Average             -1.010e-02 -1.443e-02  2.473e-02  2.546e-02 -6.421e-03
# Histidine_Average           -9.400e-04  1.487e-03  1.292e-03  8.784e-04 -2.060e-04
# Isoleucine_Average           6.244e-03  4.450e-04  7.058e-03 -1.090e-03  2.186e-03
# Lactate_Average              8.796e-02 -1.542e-01  1.560e-02  3.251e-03  1.498e-02
# Leucine                     -2.608e-03  8.839e-03  1.469e-02  1.069e-02 -5.262e-03
# Methionine                  -6.591e-04  1.239e-04  3.402e-03  2.020e-03 -6.366e-04
# Phenylalanine_Average       -1.694e-03 -1.531e-03  5.242e-03  1.317e-03 -6.382e-04
# Proline                      6.253e-03  3.233e-03  2.993e-03 -5.468e-04  5.851e-03
# Pyruvate_Average            -3.141e-03 -1.518e-03  1.105e-02  7.908e-03 -9.414e-03
# Succinate_Average           -2.146e-04 -2.134e-04  6.539e-04  2.354e-05 -4.400e-04
# Threonine_Average           -5.684e-03 -2.341e-03  6.896e-03  8.045e-03  3.142e-03
# Tyrosine_Average            -1.722e-03 -3.848e-03  6.690e-03  2.669e-03 -2.332e-03
# Valine_Average               9.684e-03 -1.528e-03  1.087e-02  5.504e-04  6.582e-03
# X1_Methylhistidine          -3.069e-05 -1.846e-04 -3.318e-04  1.825e-04 -2.626e-04
# X2_Hydroxybutyrate           8.246e-04 -1.599e-03  3.588e-04 -4.016e-04  1.688e-03
# X2_Hydroxyisovaleric_Acid    3.185e-04  2.011e-04  1.018e-04 -1.050e-04  2.514e-04
# X3_Hydroxybutyrate           1.143e-03 -5.860e-04  6.027e-04  8.750e-05 -6.293e-05
# ADP                         -2.545e-03 -2.110e-03  4.153e-04 -7.256e-03 -2.684e-05
# AMP                          3.514e-04 -1.471e-02 -1.020e-02  1.283e-03 -5.041e-03
# ATP                          3.323e-03  1.966e-04 -1.383e-03 -1.113e-03  4.130e-03
# Acetamide                    1.109e-04 -1.822e-04  9.830e-05 -2.865e-04 -3.905e-04
# Acetate                      4.589e-03 -1.446e-03  1.591e-03 -9.122e-04  8.753e-04
# Acetoacetate                 3.123e-04 -4.398e-03 -4.105e-03  3.064e-03 -1.538e-03
# Acetone                      2.212e-04 -8.425e-05  4.760e-05 -1.012e-05 -1.337e-05
# Adenosine                   -8.235e-03  2.055e-03  1.183e-02 -6.129e-03 -4.983e-03
# Alanine                      9.492e-03 -4.337e-05  1.562e-02 -1.014e-02 -4.255e-03
# Aspartate                    7.131e-04 -2.162e-04  4.485e-04  5.394e-04  1.110e-03
# Creatine_Phosphate          -1.556e-04 -7.132e-05  2.547e-04 -6.783e-05  9.186e-05
# Cytidine                    -9.799e-05  1.497e-05  2.750e-04  3.249e-04  3.971e-04
# Dimethyl_Sulfone             9.834e-04 -2.854e-04 -2.968e-04  1.514e-04  7.000e-04
# Ethanol                     -7.786e-05  1.958e-04 -5.528e-04  1.507e-04  2.910e-04
# Ethanolamine                 1.208e-03 -2.013e-03  1.672e-03 -6.609e-03 -3.048e-03
# Formate                      1.408e-05  9.358e-04 -1.312e-03  5.010e-04  1.232e-03
# Glycerol                    -8.594e-03  2.999e-02  1.136e-02 -1.498e-02  8.017e-03
# Guanidoacetate               4.585e-03 -4.829e-03  2.967e-03 -1.288e-03 -2.549e-03
# Guanosine                   -8.846e-03  2.410e-03  7.511e-03 -1.090e-02 -4.823e-03
# Hypoxanthine                -9.099e-04 -4.324e-04 -1.816e-04 -8.562e-04 -1.184e-03
# IMP                          8.971e-03 -5.490e-03  6.391e-03  5.309e-03  1.395e-03
# Inosine                      1.306e-02 -1.589e-03 -1.233e-02  5.965e-03  9.827e-03
# Isopropanol                  7.298e-06  1.721e-05 -2.240e-05 -5.986e-06  2.326e-05
# Malate                       7.143e-04 -4.080e-05  3.662e-03  3.388e-04 -4.737e-04
# Malonate                     1.301e-03 -8.277e-04 -1.913e-03  1.636e-03 -4.199e-04
# Mannose                     -7.099e-04 -1.735e-03  5.702e-04  2.192e-03 -9.010e-04
# Methanol                     2.538e-03 -1.621e-03 -6.708e-03  8.400e-03 -1.001e-03
# N_N_Dimethylglycine          5.854e-04 -5.942e-04  1.032e-03  2.300e-04 -6.451e-04
# Nicotinurate                 1.321e-03  5.084e-04  2.077e-03 -1.676e-04  9.925e-04
# O_Acetylcarnitine            4.175e-04 -1.596e-03 -5.578e-04  1.385e-03 -1.133e-03
# O_Phosphocholine             7.698e-04 -3.052e-04  4.654e-04  1.872e-03  1.167e-03
# Propylene_Glycol             7.846e-04 -1.410e-03 -8.767e-04  8.948e-04  4.776e-04
# Taurine                      2.189e-01  9.856e-02  2.054e-02  1.535e-02  1.644e-02
# Uridine                      1.710e-04 -2.869e-04  9.118e-04  6.405e-04  4.107e-05
# Xanthine                     1.111e-04  2.699e-05 -1.030e-04  8.836e-05  5.097e-05
# sn_Glycero_3_Phosphocholine  1.107e-03  5.762e-03  5.127e-03 -4.005e-05 -5.369e-03
# Beta.Alanine                 2.281e-02 -1.460e-02  1.212e-02  1.624e-02 -2.945e-03
# RDA6
# Serine                       1.475e-03
# Putrescine                  -6.968e-04
# Trans_Hydroxyproline         1.711e-03
# Asparagine                   1.655e-03
# Glutamine                    2.200e-04
# Alpha_Aminoadipic_Acid       2.307e-04
# Methionine_Sulfoxide         1.471e-04
# Acetyl_Ornithine            -1.967e-05
# Citrulline                  -1.450e-04
# Asymmetric_Dimethylarginine -1.851e-05
# Total_Dimethylarginine      -2.868e-06
# Tryptophan                   7.818e-04
# Kynurenine                   1.346e-05
# Ornithine                    4.048e-07
# Lysine                       5.841e-04
# Spermidine                  -2.637e-04
# Spermine                    -5.958e-04
# Sarcosine                    2.909e-04
# Methylhistidine              1.307e-05
# Beta_Hydroxybutyric_Acid     3.981e-05
# Alpha_Ketoglutaric_Acid      1.287e-03
# Butyric_acid                 3.146e-06
# Propionic_Acid               1.090e-04
# Fumaric_Acid                 4.185e-04
# Isobutyric_Acid              1.995e-04
# Hippuric_Acid               -2.463e-07
# Methylmalonic_Acid          -2.552e-06
# LYSOC14_0                   -3.096e-05
# LYSOC16_1                    1.364e-05
# LYSOC16_0                   -6.943e-04
# LYSOC17_0                   -2.570e-07
# LYSOC18_2                   -2.058e-06
# LYSOC18_1                   -5.348e-05
# LYSOC18_0                   -5.959e-05
# LYSOC20_4                   -5.173e-05
# LYSOC20_3                    1.045e-04
# LYSOC24_0                    2.127e-05
# LYSOC26_1                    4.624e-07
# LYSOC26_0                    5.822e-06
# LYSOC28_1                   -1.023e-05
# LYSOC28_0                    1.556e-06
# X14_1SMOH                   -2.353e-05
# X16_1SM                     -3.850e-05
# X16_0SM                     -5.909e-05
# X16_1SMOH                    1.491e-04
# X18_1SM                     -5.340e-05
# PC32_2AA                    -5.114e-04
# X18_0SM                     -2.020e-04
# X20_2SM                     -2.501e-04
# PC36_0AE                     1.302e-04
# PC36_6AA                    -1.442e-03
# PC36_0AA                     1.948e-03
# X22_2SMOH                   -4.097e-06
# X22_1SMOH                   -3.861e-05
# PC38_6AA                    -3.281e-03
# PC38_0AA                     2.122e-04
# PC40_6AE                    -2.000e-04
# X24_1SMOH                    4.270e-05
# PC40_6AA                    -2.156e-03
# PC40_2AA                    -1.114e-05
# PC401AA                     -3.027e-05
# C2                          -5.380e-04
# C3_1                         3.117e-07
# C3                          -4.693e-06
# C4_1                        -2.592e-08
# C4                          -9.387e-06
# C3OH                         2.440e-07
# C5_1                        -1.678e-07
# C5                          -7.908e-06
# C4OH                         8.762e-08
# C6_1                         2.018e-07
# C6                           5.821e-06
# C5OH                        -8.005e-06
# C5_1DC                       5.143e-07
# C5DC                         7.202e-07
# C8                          -7.735e-06
# C5MDC                        3.169e-07
# C9                           1.441e-07
# C7DC                         1.296e-06
# C10_2                       -2.901e-06
# C10_1                       -1.549e-06
# C10                          6.188e-07
# C12_1                       -6.728e-07
# C12                         -2.158e-07
# C14_2                       -3.308e-08
# C14_1                       -1.472e-06
# C14                         -9.842e-07
# C12DC                        1.385e-08
# C14_2OH                     -2.124e-07
# C14_1OH                     -3.812e-07
# C16_2                        4.590e-09
# C16_1                       -4.825e-06
# C16                         -2.096e-06
# C16_2OH                     -1.531e-07
# C16_1OH                      3.816e-08
# C16OH                       -1.118e-07
# C18_2                       -2.573e-07
# C18_1                       -2.898e-06
# C18                         -5.328e-07
# C18_1OH                     -1.655e-07
# Arginine_Average            -2.725e-03
# Betaine_Average             -6.108e-03
# C0_Average                  -1.073e-03
# Choline_Average             -1.036e-04
# Citrate_Average              3.857e-03
# Creatine_Average            -4.478e-03
# Creatinine_Average          -1.434e-04
# Glucose_Average             -3.774e-03
# Glutamate_Average            1.564e-03
# Glycine_Average              1.201e-02
# Histidine_Average           -9.976e-04
# Isoleucine_Average           5.874e-03
# Lactate_Average             -4.250e-03
# Leucine                     -1.937e-03
# Methionine                  -5.220e-04
# Phenylalanine_Average        1.226e-03
# Proline                      4.207e-03
# Pyruvate_Average            -3.863e-03
# Succinate_Average            2.481e-04
# Threonine_Average            3.083e-03
# Tyrosine_Average            -1.880e-03
# Valine_Average               9.533e-03
# X1_Methylhistidine          -1.089e-05
# X2_Hydroxybutyrate           2.202e-03
# X2_Hydroxyisovaleric_Acid   -6.639e-05
# X3_Hydroxybutyrate          -9.887e-05
# ADP                         -2.878e-03
# AMP                          4.047e-03
# ATP                         -2.521e-03
# Acetamide                   -5.010e-04
# Acetate                      1.923e-04
# Acetoacetate                 1.781e-04
# Acetone                      4.627e-05
# Adenosine                   -1.036e-02
# Alanine                      8.897e-03
# Aspartate                    7.162e-04
# Creatine_Phosphate          -4.145e-04
# Cytidine                     2.215e-04
# Dimethyl_Sulfone             3.107e-04
# Ethanol                     -2.331e-04
# Ethanolamine                -1.600e-03
# Formate                     -1.087e-03
# Glycerol                    -7.562e-03
# Guanidoacetate              -3.384e-03
# Guanosine                    6.265e-03
# Hypoxanthine                 2.472e-04
# IMP                         -5.228e-03
# Inosine                      1.157e-02
# Isopropanol                 -3.837e-06
# Malate                      -3.446e-04
# Malonate                     3.537e-04
# Mannose                     -2.282e-04
# Methanol                     1.194e-03
# N_N_Dimethylglycine          3.121e-04
# Nicotinurate                -9.656e-05
# O_Acetylcarnitine           -4.813e-04
# O_Phosphocholine            -2.794e-04
# Propylene_Glycol             1.773e-04
# Taurine                     -3.909e-03
# Uridine                      9.972e-05
# Xanthine                    -6.275e-05
# sn_Glycero_3_Phosphocholine  3.498e-04
# Beta.Alanine                -1.481e-02
# 
# 
# Site scores (weighted sums of species scores)
# 
#          RDA1      RDA2     RDA3      RDA4      RDA5     RDA6
# row1  -0.82817 -0.452377  0.02442 -0.414231 -1.109652  0.26672
# row2  -0.52274 -0.132123 -0.67003  0.045989 -0.320323 -0.58635
# row3   0.46652  1.039594 -0.01908 -0.115958 -0.510892 -0.14996
# row4  -0.50646 -0.003561  0.01425 -0.172770  0.083248 -0.14871
# row5  -0.90789 -0.024853 -0.20370 -0.143684 -1.219967  0.77302
# row6  -0.18874  0.338120  0.37080  0.127610  0.171092  0.05143
# row7  -0.54586 -0.944719  0.02912 -0.473133 -0.166073 -0.19988
# row8  -0.20859 -0.183402  0.45327  0.039454  0.152792 -0.41179
# row9   0.35058  0.418967  0.55768  0.091561 -0.115965 -0.10641
# row10  0.87764  0.103503  0.51095 -0.291477 -1.056416 -0.03249
# row11 -0.14218 -0.245252  0.28077  0.294555  0.139642 -0.36620
# row12  0.47206  1.059531  0.01909 -0.115895 -0.500709 -0.15799
# row13 -0.25253 -0.881165 -0.11666 -0.414540  0.286798 -0.60302
# row14  0.54702  0.126443  0.21139 -0.238535  0.163315  0.02822
# row15  0.63332  1.270359  0.10042 -0.080668 -0.936921 -0.35001
# row16 -0.03620 -0.602399  0.42017 -0.218850  0.413023 -0.11978
# row17  0.23529  0.663603  0.30684 -0.478554  0.088676 -0.69222
# row18 -0.30037  0.698063 -0.14329 -0.231238 -0.096540  0.03693
# row19  0.54296  1.658437 -0.06013 -0.202190 -0.953389  0.51176
# row20 -0.83321 -0.950225 -0.71570 -1.179564 -0.453763 -0.09018
# row21 -0.21234  0.054737  0.72247  0.654075 -0.516771  0.68748
# row22 -0.17858  0.683753  0.26581  0.298736 -0.094277  0.12502
# row23  0.46759  0.748124  0.30119 -0.097564  0.315079 -0.68320
# row24  0.34790  0.939854  0.40021  0.072906 -0.486264  0.45632
# row25  0.07687  0.140798  0.40960 -0.089342  0.590982 -0.16380
# row26  0.34582  0.992942 -0.05666  0.338986  0.198179  0.22583
# row27 -0.57330 -0.176111 -0.59291  0.181377 -0.008849 -0.98933
# row28 -0.59251 -0.467310 -0.29191 -0.346896  0.343567 -0.05422
# row29 -0.23925 -0.143779 -0.06105  0.360716  0.563671 -0.19929
# row30  0.08658  0.470223  0.19748  0.491965  0.587479 -0.18787
# row31 -0.70093 -0.925089 -0.76883  0.090792 -0.378156 -0.09137
# row32 -0.52239 -0.120796 -0.31839  0.004527  0.347775 -0.30636
# row33  0.76969  0.078072 -0.78494  0.849820 -0.843529 -0.62099
# row34 -0.10118 -0.739337  0.28017 -0.331268  0.728253 -0.38107
# row35  0.46248 -1.139312 -0.09623  0.417728 -0.029349  0.46717
# row36 -0.02242  0.240699  0.04649  0.082299  0.535821 -0.41270
# row37  0.61956  0.738120 -0.24003  0.650859 -0.316658  0.46972
# row38  0.59102  0.736134 -0.19716  0.365109 -0.349259 -0.35245
# row39  0.11995  0.541600  0.24973  0.234039  0.311789  0.09064
# row40 -0.61747 -0.165244 -0.29530 -0.163540  0.386707  0.48680
# row41 -0.43350 -0.501347 -0.09366 -0.132523  0.519493  0.16628
# row42 -0.36405 -0.472226 -0.28215  0.047276  0.826454  0.40601
# row43  1.07607 -1.054014 -0.47722 -0.252141 -1.567425  0.77793
# row44 -0.31243 -0.072360 -0.14011  0.061796  0.951113  0.14284
# row45  0.29913  0.159369  0.34707 -0.182680  0.652223  0.16006
# row46  0.85766 -0.679501 -0.18056 -0.026676 -0.248778  0.92164
# row47  0.04358 -0.382742  0.42714  0.187750  0.466164 -1.87161
# row48  0.42711 -0.149752  0.38595  0.181216  0.350297 -0.08095
# row49 -0.36199 -0.296283  0.06081  0.013010  0.777302  0.95163
# row50  0.73014 -0.031709 -0.24389  0.141968  0.282208  0.91938
# row51 -0.03594 -1.122703  0.20713 -0.429558  0.791148  0.38574
# row52 -0.93197 -0.111596 -0.76140 -0.232243 -0.692624  0.43818
# row53  0.36904 -0.475201  0.25794  0.456741  0.461023  0.18459
# row54 -0.34242 -0.254557 -0.04738  0.272856  0.487238  0.27885
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
#         RDA1       RDA2     RDA3      RDA4     RDA5      RDA6
# row1  -0.130367 -0.2400449  0.34271 -0.005228 -0.09080 -0.131835
# row2   0.061222 -0.0612455 -0.12662 -0.020735 -0.12258  0.065271
# row3  -0.121423  0.0578979 -0.17214 -0.327776 -0.31865  0.256927
# row4  -0.009340 -0.0700175 -0.22024 -0.106847 -0.24000  0.181080
# row5  -0.233179 -0.0008385  0.28869 -0.124588 -0.15769 -0.031944
# row6  -0.149898 -0.1563799  0.41337 -0.044239 -0.15102 -0.038388
# row7  -0.344985 -0.3082364 -0.06810 -0.131006 -0.09906 -0.179904
# row8   0.092079 -0.0608731  0.33144  0.224987  0.07340 -0.159968
# row9  -0.266744 -0.0479879  0.56875 -0.293691  0.01774 -0.254965
# row10 -0.020938  0.1421641  0.31546  0.123038 -0.15792  0.109226
# row11  0.052757  0.0738847  0.04108  0.250328  0.07481 -0.085368
# row12  0.094285  0.1778130 -0.02210 -0.170319  0.01038  0.027502
# row13 -0.136254 -0.2298775 -0.26055 -0.381411  0.08518 -0.206686
# row14 -0.141086 -0.0682689 -0.21299 -0.390094 -0.13061 -0.003025
# row15  0.242684 -0.0491373 -0.18924  0.064682  0.13306 -0.047905
# row16 -0.084067  0.1177688  0.17759  0.128169 -0.24264  0.277604
# row17  0.082581  0.0916669  0.01877 -0.208456  0.27183 -0.184604
# row18  0.082948  0.1084354 -0.11076 -0.178409 -0.04710  0.058976
# row19  0.048220 -0.0752924 -0.16973 -0.127992  0.02979 -0.071226
# row20  0.128813  0.1395236 -0.08067 -0.075599 -0.08650  0.122327
# row21 -0.010961  0.0933122  0.11047  0.222127 -0.19669  0.205326
# row22  0.103179  0.0016387  0.20094  0.308023 -0.05913  0.021951
# row23 -0.130200  0.5910214  0.20511 -0.139337  0.20345 -0.081887
# row24 -0.107146  0.3298274 -0.04609  0.043829 -0.08597  0.082504
# row25  0.331860  0.0422852  0.03050 -0.445969  0.05642  0.046826
# row26 -0.048635  0.0120415 -0.21495  0.167037  0.11640 -0.134167
# row27 -0.155850  0.0499110 -0.11693 -0.000113  0.15705 -0.203192
# row28 -0.231070  0.0092495 -0.24620 -0.057889  0.05361 -0.151324
# row29 -0.128067 -0.0460302 -0.28314  0.117043 -0.01516 -0.076102
# row30  0.024323  0.4830240  0.05559  0.192906 -0.15041  0.268452
# row31 -0.064408  0.1717054 -0.16805  0.150755 -0.08449  0.068574
# row32 -0.057203  0.0916707 -0.14084  0.074320  0.33431 -0.252253
# row33  0.024419 -0.0673568 -0.12548  0.318360 -0.08492  0.032745
# row34 -0.199747 -0.2059908  0.29936 -0.071574 -0.12626 -0.102952
# row35 -0.049992 -0.3066585 -0.24318  0.282113 -0.03782 -0.113941
# row36  0.393217 -0.3838954  0.09612  0.190563  0.05032 -0.089785
# row37 -0.089666 -0.2017063 -0.08717  0.198918 -0.14863  0.007065
# row38 -0.107638 -0.0693688 -0.22752  0.162615 -0.07609 -0.030169
# row39 -0.069049 -0.0763010  0.08965  0.164838 -0.17731  0.080014
# row40 -0.326305  0.1172003 -0.20442 -0.151348 -0.17552  0.030919
# row41  0.001437  0.2017963 -0.07120  0.153552  0.18697 -0.117181
# row42  0.282236  0.1080256  0.11450 -0.340092 -0.02907  0.093405
# row43  0.304409 -0.1059734 -0.02322 -0.260045  0.07080 -0.027269
# row44 -0.034178  0.1898421  0.04662  0.041019  0.46901 -0.313287
# row45  0.227258  0.1823669  0.01317 -0.005663  0.13247 -0.005958
# row46  0.501006  0.0861881  0.03063 -0.116237  0.01202  0.189557
# row47  0.280907 -0.2982518  0.17891 -0.009537 -0.01037 -0.074543
# row48  0.063086  0.0181279 -0.06626  0.272020  0.20744 -0.176466
# row49 -0.368347 -0.3492704  0.09809 -0.014871  0.84930  0.965284
# row50  0.409637 -0.1019427  0.04655  0.013496  0.04018  0.035685
# row51  0.225431 -0.3215702 -0.12149 -0.025324 -0.19994  0.171659
# row52 -0.068470  0.1492957 -0.12446  0.178161 -0.17678  0.159280
# row53 -0.050948 -0.0640421  0.08763  0.145189 -0.03037 -0.093464
# row54 -0.121837  0.1288741 -0.05797  0.036301  0.07359 -0.118398
# 
# 
# Biplot scores for constraining variables
# 
#              RDA1     RDA2     RDA3    RDA4     RDA5     RDA6
# TL         0.2472  0.33647 -0.20972 -0.1352 -0.03707 -0.87297
# FL        -0.2400 -0.33477  0.20943  0.1412  0.02176  0.87527
# W         -0.2109 -0.37569  0.82432  0.2674 -0.22603 -0.11072
# K          0.2221  0.66307 -0.01987 -0.6911  0.15182  0.09951
# Sex        0.7167 -0.02553 -0.24435 -0.6406  0.01098  0.12496
# Spine.Age -0.7354 -0.41251  0.28821 -0.1735 -0.40583 -0.10537

coef(RDA_met18)
# RDA1      RDA2        RDA3       RDA4         RDA5       RDA6
# TL         286.60882 593.66703 -143.271212  387.68471 -1471.835243 313.979927
# FL         274.19095 572.61579 -136.642649  376.69503 -1423.539751 333.281713
# W           61.90242 -13.30470  161.202086    3.25160    21.642329 -27.752101
# K         -116.46172 547.70427  297.387540 -238.18731   -70.703045 146.567753
# Sex         74.34419 -98.96197   -4.497081  -72.69161    -5.076749  -4.542598
# Spine.Age  -41.39957 -19.41799  -17.630862  -40.84406   -38.271674  -7.019661

# rdA biplot
plot(RDA_met18, scaling=0)
plot(RDA_met18, scaling=1)
plot(RDA_met18, scaling=2) # this one good

anova(RDA_met18)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ TL + FL + W + K + Sex + Spine.Age, data = Factors18T)
# Df Variance      F Pr(>F)
# Model     6 0.009178 1.1122  0.351
# Residual 47 0.064640  

anova(RDA_met18, by="axis", perm.max=500)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999

# Model: rda(formula = Metabolites18T ~ TL + FL + W + K + Sex + Spine.Age, data = Factors18T)
# Df Variance      F Pr(>F)
# Model     6 0.009178 1.1122  0.351
# Residual 47 0.064640              
function (object, ...) 
  + anova(RDA_met18, by="axis", perm.max=500)
function (object, ...) 
  anova(RDA_met18, by="axis", perm.max=500)

# Permutation test for rda under reduced model
# Forward tests for axes
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ TL + FL + W + K + Sex + Spine.Age, data = Factors18T)
# Df Variance      F Pr(>F)
# RDA1      1 0.007334 5.3328  0.346
# RDA2      1 0.001340 0.9742  0.970
# RDA3      1 0.000236 0.1717  1.000
# RDA4      1 0.000165 0.1200  1.000
# RDA5      1 0.000058 0.0418  1.000
# RDA6      1 0.000045 0.0327  1.000
# Residual 47 0.064640   

#### RDA with smaller model ####
RDA_met184 <- rda(Metabolites18T~.,FactorsT4)
summary(RDA_met184)
# Call:
#   rda(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data = FactorsT4) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         0.073818     1.0000
# Constrained   0.007621     0.1032
# Unconstrained 0.066196     0.8968
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#   RDA1      RDA2     RDA3      RDA4    PC1     PC2      PC3
# Eigenvalue            0.006796 0.0005757 0.000191 0.0000578 0.0495 0.01264 0.001262
# Proportion Explained  0.092071 0.0077993 0.002588 0.0007830 0.6706 0.17127 0.017102
# Cumulative Proportion 0.092071 0.0998705 0.102458 0.1032414 0.7738 0.94510 0.962202
# PC4       PC5       PC6       PC7       PC8       PC9
# Eigenvalue            0.0005587 0.0004539 0.0003551 0.0002622 0.0002216 0.0001947
# Proportion Explained  0.0075688 0.0061490 0.0048109 0.0035515 0.0030014 0.0026377
# Cumulative Proportion 0.9697710 0.9759200 0.9807309 0.9842824 0.9872838 0.9899216
# PC10      PC11      PC12      PC13      PC14      PC15
# Eigenvalue            0.0001551 0.0001362 8.738e-05 6.564e-05 4.665e-05 4.157e-05
# Proportion Explained  0.0021016 0.0018450 1.184e-03 8.892e-04 6.319e-04 5.632e-04
# Cumulative Proportion 0.9920232 0.9938682 9.951e-01 9.959e-01 9.966e-01 9.971e-01
# PC16      PC17      PC18      PC19      PC20      PC21
# Eigenvalue            3.272e-05 2.805e-05 2.523e-05 1.927e-05 1.654e-05 1.317e-05
# Proportion Explained  4.433e-04 3.800e-04 3.418e-04 2.611e-04 2.241e-04 1.784e-04
# Cumulative Proportion 9.976e-01 9.980e-01 9.983e-01 9.986e-01 9.988e-01 9.990e-01
# PC22      PC23      PC24      PC25      PC26      PC27
# Eigenvalue            1.233e-05 9.820e-06 8.608e-06 7.582e-06 6.593e-06 5.649e-06
# Proportion Explained  1.670e-04 1.330e-04 1.166e-04 1.027e-04 8.932e-05 7.652e-05
# Cumulative Proportion 9.991e-01 9.993e-01 9.994e-01 9.995e-01 9.996e-01 9.996e-01
# PC28      PC29      PC30      PC31      PC32      PC33
# Eigenvalue            3.920e-06 3.258e-06 2.979e-06 2.658e-06 2.029e-06 1.909e-06
# Proportion Explained  5.311e-05 4.414e-05 4.036e-05 3.601e-05 2.749e-05 2.587e-05
# Cumulative Proportion 9.997e-01 9.997e-01 9.998e-01 9.998e-01 9.999e-01 9.999e-01
# PC34      PC35      PC36      PC37      PC38      PC39
# Eigenvalue            1.500e-06 1.292e-06 1.089e-06 8.750e-07 6.900e-07 6.536e-07
# Proportion Explained  2.032e-05 1.750e-05 1.475e-05 1.185e-05 9.348e-06 8.854e-06
# Cumulative Proportion 9.999e-01 9.999e-01 9.999e-01 9.999e-01 1.000e+00 1.000e+00
# PC40      PC41      PC42      PC43    PC44      PC45
# Eigenvalue            5.528e-07 5.372e-07 4.517e-07 4.093e-07 3.1e-07 2.071e-07
# Proportion Explained  7.489e-06 7.278e-06 6.119e-06 5.544e-06 4.2e-06 2.806e-06
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00 1.0e+00 1.000e+00
# PC46      PC47      PC48      PC49
# Eigenvalue            1.846e-07 1.707e-07 1.023e-07 5.796e-08
# Proportion Explained  2.501e-06 2.313e-06 1.386e-06 7.852e-07
# Cumulative Proportion 1.000e+00 1.000e+00 1.000e+00 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#   RDA1      RDA2     RDA3      RDA4
# Eigenvalue            0.006796 0.0005757 0.000191 0.0000578
# Proportion Explained  0.891805 0.0755442 0.025067 0.0075837
# Cumulative Proportion 0.891805 0.9673493 0.992416 1.0000000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  1.4064 
# 
# 
# Species scores
# 
# RDA1       RDA2       RDA3       RDA4        PC1
# Serine                      -5.074e-03 -8.927e-03  1.145e-02  7.857e-04 -2.989e-03
# Putrescine                   6.445e-04  7.683e-04  9.677e-04  2.566e-04 -5.454e-04
# Trans_Hydroxyproline         2.582e-03  1.568e-03 -5.016e-04 -2.591e-03 -1.483e-03
# Asparagine                   1.871e-03  1.781e-03 -2.742e-04 -2.544e-03 -1.656e-03
# Glutamine                   -8.714e-04 -1.368e-03  2.364e-03  5.790e-05 -2.158e-03
# Alpha_Aminoadipic_Acid       5.689e-04 -4.259e-04 -1.331e-05 -2.778e-05 -3.553e-04
# Methionine_Sulfoxide        -7.213e-04 -2.861e-04  7.096e-04 -1.081e-04 -1.431e-04
# Acetyl_Ornithine             1.140e-04  1.815e-05  2.638e-05  1.310e-05 -7.876e-05
# Citrulline                   4.937e-03  2.909e-03 -2.199e-02  1.825e-03  1.519e-03
# Asymmetric_Dimethylarginine  7.389e-06 -4.898e-06  4.979e-05  1.437e-05 -2.556e-05
# Total_Dimethylarginine       1.699e-05 -2.846e-05  1.062e-04 -4.709e-06  9.686e-06
# Tryptophan                   5.526e-04 -7.199e-04 -4.071e-05 -7.169e-04 -3.030e-04
# Kynurenine                  -6.175e-06 -4.968e-05 -2.855e-06  4.881e-06 -7.535e-05
# Ornithine                   -7.050e-04 -7.777e-04  1.689e-03  2.459e-04 -6.597e-04
# Lysine                      -4.491e-03 -2.812e-03  6.891e-03  7.487e-04 -6.636e-04
# Spermidine                   1.300e-03  8.518e-04  3.945e-04 -8.296e-05 -3.685e-04
# Spermine                     2.347e-03  1.162e-03 -2.034e-04 -5.112e-05  6.270e-04
# Sarcosine                   -7.194e-04 -2.352e-03  3.853e-03 -1.908e-06 -9.404e-04
# Methylhistidine             -7.102e-04 -1.788e-03  3.616e-03 -2.883e-04  1.098e-03
# Beta_Hydroxybutyric_Acid     1.230e-03 -7.152e-04  3.443e-04  4.251e-05  1.790e-03
# Alpha_Ketoglutaric_Acid      1.035e-03 -1.057e-03  8.675e-04 -1.142e-03  7.615e-04
# Butyric_acid                 1.072e-04  5.303e-05  3.925e-05 -5.543e-05  1.036e-04
# Propionic_Acid               7.005e-05  1.323e-03  7.432e-04 -7.697e-04  1.184e-04
# Fumaric_Acid                 4.316e-04 -2.176e-03  1.944e-03 -1.235e-05  9.890e-04
# Isobutyric_Acid              3.007e-04  2.744e-05 -4.251e-05 -2.774e-04  1.479e-04
# Hippuric_Acid                1.283e-07  2.041e-06 -1.778e-07 -8.070e-07  2.429e-06
# Methylmalonic_Acid           3.140e-06  7.049e-06  4.936e-06  1.363e-07 -5.325e-06
# LYSOC14_0                    1.070e-04 -8.147e-06 -1.633e-04  4.788e-05 -4.258e-05
# LYSOC16_1                    5.211e-04 -3.053e-04 -9.853e-04  1.184e-04 -3.000e-04
# LYSOC16_0                    1.570e-03 -6.331e-04 -3.684e-03  1.048e-03 -6.079e-04
# LYSOC17_0                    7.064e-05 -2.169e-05 -1.919e-04  2.271e-05 -8.551e-05
# LYSOC18_2                    2.926e-05 -6.121e-05 -4.802e-06  8.596e-06 -2.722e-05
# LYSOC18_1                    1.560e-04 -4.274e-04  4.925e-05  1.176e-04 -9.017e-05
# LYSOC18_0                   -1.600e-05 -1.632e-04  1.438e-04  8.526e-05 -6.265e-05
# LYSOC20_4                    4.970e-04 -1.495e-04 -7.098e-05  3.688e-05 -1.974e-04
# LYSOC20_3                    5.722e-05  9.058e-05  1.177e-05 -1.658e-04  7.841e-05
# LYSOC24_0                   -4.571e-05  1.062e-05 -3.749e-05 -1.387e-05  7.263e-05
# LYSOC26_1                    7.155e-06  1.064e-05 -9.485e-06 -7.585e-06  7.239e-06
# LYSOC26_0                   -1.937e-05  6.590e-06 -3.915e-05 -2.831e-06  1.832e-05
# LYSOC28_1                    3.199e-05  3.240e-05 -1.943e-05  3.181e-07  1.261e-05
# LYSOC28_0                   -8.032e-06  1.144e-05 -1.903e-05 -1.782e-06  1.214e-05
# X14_1SMOH                    2.618e-04  9.515e-05 -1.667e-04 -6.585e-06 -2.002e-05
# X16_1SM                      7.450e-04  2.388e-05 -2.276e-04 -7.819e-05  9.812e-05
# X16_0SM                      6.499e-04  1.765e-04 -2.418e-04 -4.046e-05  5.216e-05
# X16_1SMOH                    6.659e-04  3.682e-04 -7.074e-04 -2.158e-04 -9.423e-05
# X18_1SM                      1.117e-04 -5.733e-05  3.625e-05  6.626e-05 -1.025e-04
# PC32_2AA                    -2.568e-05 -1.645e-03  1.657e-04  1.126e-03 -1.478e-03
# X18_0SM                      6.639e-05 -7.193e-04  3.069e-04  4.377e-04 -3.649e-04
# X20_2SM                      2.548e-04 -3.694e-04  2.797e-04  3.505e-04 -5.562e-04
# PC36_0AE                     9.959e-04  3.356e-04 -9.181e-04 -2.178e-04 -2.371e-04
# PC36_6AA                     4.557e-03 -3.897e-04 -2.425e-03  1.810e-03 -5.984e-03
# PC36_0AA                     8.179e-03  6.034e-03 -8.654e-03 -3.353e-03 -3.988e-03
# X22_2SMOH                    9.072e-04  3.696e-04 -5.863e-04 -7.390e-05 -4.924e-05
# X22_1SMOH                    3.086e-04  3.039e-05 -1.646e-04  3.420e-05 -7.660e-05
# PC38_6AA                     3.633e-02 -9.037e-03 -1.530e-02  5.904e-03 -3.250e-02
# PC38_0AA                     5.302e-03  6.997e-04 -3.133e-03 -5.144e-04 -2.429e-03
# PC40_6AE                     4.299e-03 -3.840e-04 -1.188e-03  3.997e-04 -3.525e-03
# X24_1SMOH                    4.447e-04 -2.230e-04 -1.753e-04  2.306e-05 -2.588e-04
# PC40_6AA                     1.234e-03 -7.284e-03  8.007e-03  2.861e-03 -4.105e-03
# PC40_2AA                     8.615e-05  1.439e-05 -7.587e-05  9.331e-06 -2.574e-05
# PC401AA                      6.139e-05 -3.911e-05 -6.825e-06  4.044e-05 -2.594e-05
# C2                          -1.792e-04 -6.671e-04  4.268e-04  4.222e-04 -3.483e-05
# C3_1                         5.946e-07  1.292e-06 -8.737e-07 -1.097e-06  2.195e-06
# C3                           1.171e-04  6.235e-05  9.027e-07 -2.084e-05 -5.825e-05
# C4_1                         2.328e-06  2.061e-06 -2.025e-06 -9.456e-07 -1.637e-06
# C4                           2.178e-05  6.289e-06 -7.211e-06  5.629e-06  9.214e-06
# C3OH                         5.150e-07  2.355e-07 -3.738e-07 -3.211e-07 -8.080e-07
# C5_1                         5.188e-07  1.125e-06  5.162e-07 -3.434e-07  5.784e-07
# C5                           2.346e-05  2.571e-05  4.115e-07 -8.336e-07 -1.362e-05
# C4OH                         1.569e-05 -5.323e-06 -7.864e-06  1.295e-06  7.266e-06
# C6_1                         1.059e-05  3.430e-06 -9.649e-06 -2.528e-06  6.809e-06
# C6                           1.569e-05 -3.557e-06 -2.552e-05 -8.621e-06  4.512e-05
# C5OH                         8.424e-07  5.753e-06  7.673e-06  5.953e-06 -3.189e-06
# C5_1DC                       7.041e-06  1.403e-06 -2.017e-06 -1.542e-06  2.029e-06
# C5DC                        -2.036e-06  3.415e-06 -6.141e-07 -5.116e-06  7.714e-06
# C8                           5.425e-06 -7.777e-06 -4.066e-06  9.272e-06  1.183e-05
# C5MDC                        4.021e-07 -5.031e-08  7.004e-08 -5.496e-07  1.307e-06
# C9                           8.012e-07 -1.197e-06  2.778e-08  1.079e-07  1.527e-06
# C7DC                         1.477e-06 -3.726e-06 -1.096e-06  9.270e-07 -4.958e-06
# C10_2                       -8.608e-07 -9.967e-07  2.031e-06  2.259e-06  6.936e-06
# C10_1                        2.594e-06  1.842e-07 -2.165e-06 -3.060e-07  6.438e-06
# C10                          2.465e-06 -9.772e-07 -1.353e-06 -1.053e-06  5.633e-06
# C12_1                        2.701e-06 -1.737e-06 -6.854e-07  3.588e-07  3.651e-06
# C12                          1.745e-06 -1.469e-06 -6.422e-07  3.722e-07  3.234e-06
# C14_2                        7.321e-07 -2.711e-07 -6.895e-07  9.561e-08  9.809e-07
# C14_1                        8.929e-06 -8.382e-06  2.844e-08  3.133e-06  8.998e-06
# C14                          8.931e-06 -7.975e-06 -2.228e-06  2.856e-06  1.058e-05
# C12DC                        7.573e-07 -1.150e-06  3.603e-07  1.813e-07  1.240e-06
# C14_2OH                      1.727e-06 -2.498e-06  4.020e-07  7.356e-07  2.876e-06
# C14_1OH                      5.679e-06 -4.727e-06 -2.241e-06  1.594e-06  6.765e-06
# C16_2                        4.421e-07 -1.234e-06  2.298e-07  1.952e-07  1.273e-06
# C16_1                        1.169e-05 -2.222e-05 -3.085e-06  1.009e-05  2.427e-05
# C16                          1.546e-05 -1.276e-05 -8.958e-06  5.250e-06  2.079e-05
# C16_2OH                      2.554e-06 -1.996e-06 -1.250e-06  6.532e-07  3.188e-06
# C16_1OH                      5.149e-06 -3.648e-06 -3.095e-06  1.081e-06  4.612e-06
# C16OH                        1.173e-06 -6.963e-07 -2.900e-08  2.209e-07  1.464e-06
# C18_2                        1.904e-06 -3.834e-06  2.334e-07  1.176e-06  3.587e-06
# C18_1                        1.587e-05 -2.480e-05 -7.839e-06  9.849e-06  2.762e-05
# C18                          4.306e-06 -3.625e-06 -2.830e-06  1.615e-06  4.943e-06
# C18_1OH                      1.342e-06 -1.316e-06 -6.829e-07  4.856e-07  2.394e-06
# Arginine_Average            -5.678e-03 -2.482e-03  9.825e-03  3.491e-03 -2.418e-03
# Betaine_Average              4.360e-03 -6.378e-03 -8.849e-03  1.031e-02  3.569e-03
# C0_Average                   6.412e-05  2.317e-05  2.260e-03  6.746e-04  1.452e-03
# Choline_Average             -4.577e-04 -3.171e-03  2.086e-03  1.184e-03 -3.219e-03
# Citrate_Average              4.038e-02 -1.615e-02  2.704e-03 -8.910e-04  1.053e-02
# Creatine_Average             2.402e-02  3.643e-02 -5.082e-03 -1.025e-02  2.961e-02
# Creatinine_Average           4.854e-04  5.018e-04  3.467e-04 -1.794e-04  2.622e-04
# Glucose_Average             -3.484e-01  1.631e-02  1.909e-02  4.533e-04 -8.751e-01
# Glutamate_Average           -8.485e-04 -6.550e-03  5.693e-03 -3.134e-04 -1.592e-03
# Glycine_Average             -1.290e-02 -1.962e-02  3.173e-02 -1.173e-02 -3.030e-03
# Histidine_Average           -7.477e-04  5.843e-04  1.627e-03  1.044e-03 -2.498e-03
# Isoleucine_Average           7.424e-03 -5.179e-03  3.129e-03 -4.679e-03 -2.427e-03
# Lactate_Average              7.204e-02 -9.346e-02  6.755e-03 -3.980e-03 -2.613e-02
# Leucine                     -2.226e-03 -1.231e-03  1.715e-02  3.423e-03  2.352e-03
# Methionine                  -6.084e-04 -1.359e-03  3.613e-03  7.408e-04 -7.148e-04
# Phenylalanine_Average       -1.474e-03 -4.110e-03  3.917e-03 -5.041e-04 -2.457e-03
# Proline                      7.866e-03  7.283e-04  1.897e-03 -4.713e-03 -4.492e-03
# Pyruvate_Average            -4.684e-03 -6.956e-03  1.190e-02  5.937e-03 -2.188e-04
# Succinate_Average           -2.375e-04 -7.176e-04  3.185e-04 -2.926e-05  2.826e-04
# Threonine_Average           -5.382e-03 -2.432e-03  1.038e-02 -4.423e-03 -5.521e-03
# Tyrosine_Average            -2.078e-03 -5.660e-03  5.846e-03  2.658e-03 -8.396e-05
# Valine_Average               1.156e-02 -7.561e-03  6.814e-03 -9.044e-03 -3.669e-03
# X1_Methylhistidine          -1.604e-04  7.136e-05 -1.071e-04 -2.038e-05  2.111e-04
# X2_Hydroxybutyrate           1.030e-03 -1.291e-03 -1.876e-04 -2.394e-03  1.114e-03
# X2_Hydroxyisovaleric_Acid    3.998e-04  1.170e-04  3.365e-05  4.272e-05  2.622e-04
# X3_Hydroxybutyrate           1.082e-03 -6.838e-04  4.077e-04  1.588e-04  1.987e-03
# ADP                         -1.684e-03 -3.264e-03 -5.101e-03  4.246e-03  7.318e-03
# AMP                         -3.528e-03 -4.695e-03 -7.155e-03 -4.864e-03  8.108e-03
# ATP                          3.961e-03  2.533e-03 -8.362e-04  1.313e-03  3.000e-03
# Acetamide                    6.279e-05 -2.705e-04 -1.663e-04  6.356e-04  8.221e-04
# Acetate                      4.720e-03 -1.924e-03  2.934e-04 -1.886e-05  8.052e-03
# Acetoacetate                -1.336e-03  4.050e-04 -6.112e-04 -1.234e-03  1.398e-03
# Acetone                      2.079e-04 -9.962e-05  9.709e-06 -3.343e-05  2.853e-04
# Adenosine                   -6.454e-03 -7.051e-03  3.132e-03  1.415e-02  2.330e-02
# Alanine                      1.148e-02 -1.669e-02  1.470e-04 -2.571e-03  2.217e-03
# Aspartate                    8.498e-04 -2.878e-05  7.495e-04 -1.006e-03  9.623e-04
# Creatine_Phosphate          -1.024e-04 -8.380e-05  1.603e-04  4.131e-04  2.444e-04
# Cytidine                    -2.933e-05  3.212e-05  4.487e-04 -3.345e-04  9.660e-04
# Dimethyl_Sulfone             9.901e-04  2.098e-04 -1.920e-05 -5.584e-04  6.430e-04
# Ethanol                     -8.406e-05  6.560e-04 -1.456e-04  3.103e-05  1.829e-04
# Ethanolamine                 1.436e-03 -5.097e-03 -4.399e-03  3.884e-03  8.360e-03
# Formate                      1.231e-04  2.193e-03 -7.581e-05  4.165e-04  1.313e-03
# Glycerol                    -2.708e-04  1.015e-02 -1.079e-03  1.109e-02  1.567e-02
# Guanidoacetate               3.921e-03 -5.109e-03  6.102e-04  4.348e-03  6.236e-03
# Guanosine                   -6.825e-03 -9.975e-03 -5.032e-03 -9.518e-04  1.457e-02
# Hypoxanthine                -1.049e-03 -8.853e-04 -9.820e-04  2.167e-04  2.967e-03
# IMP                          8.325e-03 -3.556e-03  8.494e-03  4.117e-03  6.715e-03
# Inosine                      1.201e-02  8.829e-03 -3.013e-03 -1.653e-02  1.435e-02
# Isopropanol                  1.135e-05  3.014e-05 -1.379e-05 -3.933e-06  5.228e-05
# Malate                       9.744e-04 -2.196e-03  2.472e-03  9.313e-04  3.007e-03
# Malonate                     6.471e-04  9.972e-04 -5.417e-05 -9.046e-04  3.833e-03
# Mannose                     -1.257e-03 -8.381e-04  1.849e-03 -7.881e-06 -1.078e-04
# Methanol                     2.018e-04  5.355e-03  1.993e-03 -3.778e-03  3.380e-03
# N_N_Dimethylglycine          4.691e-04 -1.189e-03  6.526e-04 -3.785e-05  1.454e-03
# Nicotinurate                 1.771e-03 -6.741e-04  1.315e-03  2.099e-04  1.607e-03
# O_Acetylcarnitine           -2.275e-04 -3.784e-04  5.406e-04  2.904e-04  2.922e-04
# O_Phosphocholine             7.313e-04  6.369e-04  1.901e-03 -3.863e-04  2.601e-03
# Propylene_Glycol             4.716e-04  1.195e-04  1.256e-04 -6.697e-04  1.613e-03
# Taurine                      2.244e-01  5.509e-02  3.176e-02  2.528e-03  7.457e-01
# Uridine                      1.630e-04 -5.102e-04  1.030e-03 -1.120e-04  1.062e-03
# Xanthine                     9.552e-05  1.401e-04  2.035e-05  1.092e-05  1.291e-04
# sn_Glycero_3_Phosphocholine  1.291e-03 -1.610e-03  2.610e-03  2.060e-03  4.769e-04
# Beta.Alanine                 1.906e-02 -7.748e-03  2.041e-02  1.228e-02  2.848e-03
# PC2
# Serine                       3.401e-03
# Putrescine                   1.855e-03
# Trans_Hydroxyproline         4.807e-03
# Asparagine                   4.053e-03
# Glutamine                    1.017e-03
# Alpha_Aminoadipic_Acid       1.397e-04
# Methionine_Sulfoxide         3.816e-04
# Acetyl_Ornithine             2.348e-04
# Citrulline                  -7.267e-03
# Asymmetric_Dimethylarginine  9.493e-05
# Total_Dimethylarginine       1.527e-04
# Tryptophan                   2.605e-03
# Kynurenine                   1.408e-05
# Ornithine                   -3.963e-04
# Lysine                      -1.882e-03
# Spermidine                   1.720e-03
# Spermine                     3.531e-03
# Sarcosine                    6.119e-04
# Methylhistidine             -3.087e-04
# Beta_Hydroxybutyric_Acid     2.826e-03
# Alpha_Ketoglutaric_Acid      2.397e-03
# Butyric_acid                 2.478e-04
# Propionic_Acid               9.825e-04
# Fumaric_Acid                 2.971e-03
# Isobutyric_Acid              4.590e-04
# Hippuric_Acid                1.739e-06
# Methylmalonic_Acid           9.496e-06
# LYSOC14_0                    1.048e-04
# LYSOC16_1                    4.170e-04
# LYSOC16_0                    3.690e-04
# LYSOC17_0                    7.859e-05
# LYSOC18_2                    8.375e-05
# LYSOC18_1                    6.378e-04
# LYSOC18_0                    1.980e-04
# LYSOC20_4                    6.852e-04
# LYSOC20_3                    2.208e-04
# LYSOC24_0                    1.258e-04
# LYSOC26_1                    7.733e-05
# LYSOC26_0                    5.361e-05
# LYSOC28_1                    9.495e-05
# LYSOC28_0                    5.766e-05
# X14_1SMOH                    2.902e-04
# X16_1SM                      1.183e-03
# X16_0SM                      7.959e-04
# X16_1SMOH                    4.320e-04
# X18_1SM                      1.563e-04
# PC32_2AA                     2.453e-04
# X18_0SM                      2.055e-04
# X20_2SM                      2.641e-04
# PC36_0AE                     1.076e-03
# PC36_6AA                     2.856e-03
# PC36_0AA                     6.712e-03
# X22_2SMOH                    1.100e-03
# X22_1SMOH                    3.843e-04
# PC38_6AA                     2.769e-02
# PC38_0AA                     5.837e-03
# PC40_6AE                     4.274e-03
# X24_1SMOH                    5.374e-04
# PC40_6AA                     6.330e-03
# PC40_2AA                     1.483e-04
# PC401AA                      1.349e-04
# C2                           2.355e-03
# C3_1                         6.394e-06
# C3                           2.273e-04
# C4_1                         6.867e-06
# C4                           5.702e-05
# C3OH                         1.075e-06
# C5_1                         1.824e-06
# C5                           5.369e-05
# C4OH                         1.602e-05
# C6_1                         1.241e-05
# C6                           8.995e-05
# C5OH                         1.272e-05
# C5_1DC                       1.255e-05
# C5DC                         3.207e-05
# C8                           3.457e-05
# C5MDC                        1.250e-06
# C9                           2.281e-06
# C7DC                        -9.670e-08
# C10_2                        7.087e-06
# C10_1                        9.346e-06
# C10                          5.645e-06
# C12_1                        7.220e-06
# C12                          4.164e-06
# C14_2                        1.742e-06
# C14_1                        1.953e-05
# C14                          1.684e-05
# C12DC                        7.057e-07
# C14_2OH                      3.690e-06
# C14_1OH                      1.013e-05
# C16_2                        1.735e-06
# C16_1                        3.314e-05
# C16                          2.934e-05
# C16_2OH                      5.378e-06
# C16_1OH                      8.562e-06
# C16OH                        1.859e-06
# C18_2                        5.736e-06
# C18_1                        3.946e-05
# C18                          6.701e-06
# C18_1OH                      3.269e-06
# Arginine_Average            -6.537e-04
# Betaine_Average             -2.084e-03
# C0_Average                   3.213e-03
# Choline_Average             -1.687e-03
# Citrate_Average              4.992e-02
# Creatine_Average             9.467e-02
# Creatinine_Average           2.043e-03
# Glucose_Average             -2.101e-01
# Glutamate_Average            3.970e-03
# Glycine_Average              3.906e-02
# Histidine_Average            3.419e-03
# Isoleucine_Average           1.469e-02
# Lactate_Average              4.733e-01
# Leucine                      1.216e-02
# Methionine                   1.551e-03
# Phenylalanine_Average        4.776e-03
# Proline                      8.835e-03
# Pyruvate_Average             6.901e-03
# Succinate_Average            5.417e-04
# Threonine_Average            1.162e-02
# Tyrosine_Average             8.401e-03
# Valine_Average               2.833e-02
# X1_Methylhistidine           1.120e-04
# X2_Hydroxybutyrate           1.804e-03
# X2_Hydroxyisovaleric_Acid    8.025e-05
# X3_Hydroxybutyrate           3.012e-03
# ADP                         -1.278e-02
# AMP                         -1.767e-03
# ATP                         -5.124e-03
# Acetamide                   -1.246e-03
# Acetate                      4.063e-03
# Acetoacetate                 5.033e-03
# Acetone                      2.492e-04
# Adenosine                    1.154e-03
# Alanine                     -3.716e-03
# Aspartate                    1.124e-03
# Creatine_Phosphate          -2.246e-04
# Cytidine                     3.122e-05
# Dimethyl_Sulfone             6.423e-04
# Ethanol                     -1.506e-04
# Ethanolamine                -1.359e-02
# Formate                     -5.157e-04
# Glycerol                    -1.190e-03
# Guanidoacetate              -2.845e-03
# Guanosine                   -1.005e-02
# Hypoxanthine                -1.022e-03
# IMP                          1.118e-02
# Inosine                      7.309e-03
# Isopropanol                 -5.986e-05
# Malate                       1.445e-03
# Malonate                     5.805e-04
# Mannose                      1.307e-03
# Methanol                     5.171e-03
# N_N_Dimethylglycine         -9.162e-04
# Nicotinurate                 6.831e-04
# O_Acetylcarnitine            2.385e-03
# O_Phosphocholine            -4.226e-04
# Propylene_Glycol             2.606e-03
# Taurine                     -2.323e-01
# Uridine                      1.104e-03
# Xanthine                    -2.972e-05
# sn_Glycero_3_Phosphocholine -1.328e-02
# Beta.Alanine                -6.359e-03
# 
# 
# Site scores (weighted sums of species scores)
# 
# RDA1      RDA2      RDA3     RDA4        PC1       PC2
# row1  -0.86876 -0.609939 -0.429365  0.14817 -0.2784043 -0.069166
# row2  -0.54825  0.051849 -0.495157  0.04864 -0.2095724 -0.081340
# row3   0.50538  1.342854  0.234596  1.08633  0.2830929 -0.236133
# row4  -0.52454  0.038862 -0.073308  0.30376 -0.1576038 -0.121350
# row5  -0.94429  0.052154 -0.286090 -0.12148 -0.2605775 -0.191120
# row6  -0.18718  0.408422  0.499120  0.40093  0.0055931 -0.194928
# row7  -0.58478 -1.280763 -0.599939 -0.19240 -0.1098078  0.206075
# row8  -0.21827 -0.321233  0.332029  0.40762 -0.1208180 -0.024384
# row9   0.37424  0.399833  0.611194  0.68614  0.2182415 -0.096038
# row10  0.91365 -0.150464  0.143709  0.70336  0.3403307  0.143048
# row11 -0.15224 -0.346566  0.344250  0.04451 -0.0789905  0.063629
# row12  0.51172  1.360442  0.270900  1.12944  0.1796556 -0.253571
# row13 -0.27931 -1.163326 -0.633361 -0.15133 -0.0896838  0.234555
# row14  0.57182  0.037825  0.025593  0.21435  0.2687610  0.077938
# row15  0.68296  1.601899  0.409177  1.55489  0.2154402 -0.282950
# row16 -0.04732 -0.927108 -0.017349 -0.12223  0.0006713  0.172278
# row17  0.26100  0.770630  0.158691  1.48418  0.0593596 -0.180709
# row18 -0.29663  0.995446 -0.006821  0.70636 -0.1148516 -0.302728
# row19  0.59723  2.151986  0.324136  1.25901  0.2674886 -0.410270
# row20 -0.88409 -1.152115 -1.635585 -0.17643 -0.4072127  0.100282
# row21 -0.21901 -0.045395  0.970446 -0.22389 -0.0544821 -0.067556
# row22 -0.17068  0.911353  0.641475  0.53471 -0.0588304 -0.274047
# row23  0.50281  0.905453  0.435224  1.20415  0.1957689 -0.048460
# row24  0.38138  1.124423  0.632578  0.72946  0.2046047 -0.175944
# row25  0.08557  0.095501  0.325383  0.38602 -0.1004297 -0.144849
# row26  0.37873  1.363800  0.517276  0.31351  0.1969332 -0.179664
# row27 -0.60125  0.010208 -0.336110  0.19826 -0.1870939 -0.011546
# row28 -0.62391 -0.518210 -0.571290 -0.29298 -0.1644252  0.089944
# row29 -0.25168 -0.094890  0.183252 -0.33484 -0.0322966  0.057662
# row30  0.09993  0.654173  0.667035  0.18788  0.0413473 -0.108226
# row31 -0.75052 -0.991509 -0.826305 -1.02219 -0.2762742  0.203383
# row32 -0.54505 -0.007329 -0.232376 -0.06631 -0.2047363 -0.012600
# row33  0.79264  0.280167 -0.057481 -0.45186  0.3013217  0.201785
# row34 -0.11732 -1.067247 -0.222808 -0.13554  0.0046153  0.187383
# row35  0.45362 -1.552137 -0.232391 -1.71425  0.1718017  0.508164
# row36 -0.01737  0.353271  0.209067  0.34940 -0.1117827 -0.176049
# row37  0.65465  1.039119  0.454794 -0.31405  0.3284580 -0.073554
# row38  0.62604  1.015711  0.318808  0.49682  0.3136341 -0.042322
# row39  0.13666  0.694560  0.539760  0.30368  0.1174147 -0.150777
# row40 -0.64389 -0.093485 -0.357271 -0.54870 -0.1171063 -0.013344
# row41 -0.45934 -0.609408 -0.297168 -0.56649 -0.2031635  0.113182
# row42 -0.38756 -0.507727 -0.307045 -1.03806 -0.2768500 -0.009229
# row43  1.08992 -1.535963 -1.037676 -1.42631  0.2241538  0.520697
# row44 -0.32480  0.007091 -0.039452 -0.46946 -0.1553939  0.006454
# row45  0.31660  0.097001  0.205752  0.12478  0.0232070 -0.021781
# row46  0.87393 -1.010209 -0.469989 -1.45479  0.1025874  0.314811
# row47  0.03890 -0.562299  0.380701  1.05260 -0.0901069  0.011926
# row48  0.44126 -0.318234  0.355773 -0.11459  0.1234186  0.174162
# row49 -0.38025 -0.368674 -0.025260 -1.03256 -0.0619161 -0.003470
# row50  0.75550 -0.061982 -0.149509 -1.15580  0.1272934  0.098555
# row51 -0.05770 -1.602130 -0.499384 -1.03031 -0.1089537  0.271308
# row52 -0.97225  0.090045 -0.765143 -0.38020 -0.3152924 -0.117275
# row53  0.37291 -0.697790  0.327716 -0.85126  0.1393725  0.256419
# row54 -0.36079 -0.257950  0.085199 -0.67067 -0.1079103  0.061741
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# RDA1     RDA2       RDA3      RDA4        PC1       PC2
# row1  -0.127725 -0.34548  0.1962534  0.191186 -0.2784043 -0.069166
# row2   0.017653 -0.02403 -0.1209943 -0.046670 -0.2095724 -0.081340
# row3  -0.146083 -0.14402 -0.4276813 -0.110163  0.2830929 -0.236133
# row4  -0.072248 -0.06955 -0.2743031 -0.120148 -0.1576038 -0.121350
# row5  -0.203590 -0.26010  0.0629243  0.142056 -0.2605775 -0.191120
# row6  -0.135167 -0.39572  0.1947231  0.142328  0.0055931 -0.194928
# row7  -0.374120 -0.16956 -0.1506193  0.199552 -0.1098078  0.206075
# row8   0.104254 -0.09467  0.4009886  0.129779 -0.1208180 -0.024384
# row9  -0.154137 -0.40130  0.1517196  0.382609  0.2182415 -0.096038
# row10 -0.013371 -0.14408  0.2604224 -0.033689  0.3403307  0.143048
# row11  0.044362  0.15066  0.2413016  0.014749 -0.0789905  0.063629
# row12  0.131492  0.05436 -0.1373369  0.011745  0.1796556 -0.253571
# row13 -0.120543 -0.02818 -0.4285979  0.204425 -0.0896838  0.234555
# row14 -0.140746 -0.08748 -0.4511879  0.085711  0.2687610  0.077938
# row15  0.222041  0.16171 -0.0449444 -0.035073  0.2154402 -0.282950
# row16 -0.108767 -0.14284  0.1479205 -0.191584  0.0006713  0.172278
# row17  0.168778  0.10565 -0.0855319  0.153258  0.0593596 -0.180709
# row18  0.093292  0.03767 -0.2128279 -0.017258 -0.1148516 -0.302728
# row19  0.040695  0.04135 -0.1938268  0.057213  0.2674886 -0.410270
# row20  0.123546  0.04399 -0.1265695 -0.082604 -0.4072127  0.100282
# row21 -0.052852 -0.05153  0.1923641 -0.168030 -0.0544821 -0.067556
# row22  0.071381 -0.03990  0.3489771 -0.041167 -0.0588304 -0.274047
# row23  0.018223  0.26327  0.0857563  0.107857  0.1957689 -0.048460
# row24 -0.094275  0.18819  0.0008502 -0.058981  0.2046047 -0.175944
# row25  0.395944 -0.14390 -0.3199607  0.044656 -0.1004297 -0.144849
# row26 -0.070917  0.26715  0.0289688  0.025800  0.1969332 -0.179664
# row27 -0.129171  0.20400 -0.0239999  0.132509 -0.1870939 -0.011546
# row28 -0.232346  0.19175 -0.1697060  0.101996 -0.1644252  0.089944
# row29 -0.179146  0.19968 -0.0788539  0.003852 -0.0322966  0.057662
# row30  0.029210  0.19914  0.1550493 -0.226385  0.0413473 -0.108226
# row31 -0.098165  0.20975  0.0022232 -0.094377 -0.2762742  0.203383
# row32 -0.009649  0.33872  0.0507153  0.114222 -0.2047363 -0.012600
# row33 -0.055738  0.10990  0.1490245 -0.099725  0.3013217  0.201785
# row34 -0.193587 -0.34060  0.1123135  0.182504  0.0046153  0.187383
# row35 -0.153467  0.08113  0.0604771  0.005430  0.1718017  0.508164
# row36  0.331836 -0.18162  0.2027492  0.029256 -0.1117827 -0.176049
# row37 -0.171602 -0.04693  0.0681538 -0.032464  0.3284580 -0.073554
# row38 -0.172757  0.13633 -0.0246680 -0.025391  0.3136341 -0.042322
# row39 -0.118480 -0.11993  0.1441248 -0.053545  0.1174147 -0.150777
# row40 -0.337274  0.07694 -0.2629774  0.022272 -0.1171063 -0.013344
# row41  0.029207  0.30553  0.1238625  0.024014 -0.2031635  0.113182
# row42  0.335468 -0.15899 -0.2009725  0.015774 -0.2768500 -0.009229
# row43  0.325535 -0.11052 -0.2068782  0.055699  0.2241538  0.520697
# row44  0.074027  0.33114  0.1703437  0.176219 -0.1553939  0.006454
# row45  0.264845  0.14025  0.0316097 -0.018772  0.0232070 -0.021781
# row46  0.512042 -0.05609 -0.0868607 -0.146753  0.1025874  0.314811
# row47  0.257752 -0.27353  0.0938832  0.090211 -0.0901069  0.011926
# row48  0.057395  0.25691  0.2182529  0.042024  0.1234186  0.174162
# row49 -0.219578 -0.22533  0.0391464 -1.107375 -0.0619161 -0.003470
# row50  0.393781 -0.08252  0.0347234 -0.043549  0.1272934  0.098555
# row51  0.134413 -0.23494 -0.1575053 -0.133688 -0.1089537  0.271308
# row52 -0.119966  0.12659  0.0257069 -0.155011 -0.3152924 -0.117275
# row53 -0.070482 -0.02652  0.1685239  0.074311  0.1393725  0.256419
# row54 -0.101221  0.17813  0.0227505  0.079184 -0.1079103  0.061741
# 
# 
# Biplot scores for constraining variables
# 
# RDA1    RDA2     RDA3     RDA4 PC1 PC2
# FL        -0.2555 -0.4829  0.12336 -0.82841   0   0
# W         -0.2246 -0.6709  0.67267  0.21662   0   0
# Sex        0.7437 -0.1230 -0.65680 -0.01964   0   0
# Spine.Age -0.7704 -0.5773 -0.02099  0.26997   0   0

coef(RDA_met184)
# RDA1       RDA2       RDA3      RDA4
# FL         -3.023064  -8.848056  -0.940715 -27.61851
# W          80.296909 -90.515737 106.555952  43.86903
# Sex        68.822883 -81.639614 -63.873081  16.85403
# Spine.Age -45.670233 -25.402512 -47.609445  21.80619

# rdA biplot
plot(RDA_met184, scaling=0)
plot(RDA_met184, scaling=1)
plot(RDA_met184, scaling=2) # this one good

anova(RDA_met184)
# Permutation test for rda under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: rda(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data = FactorsT4)
# Df Variance      F Pr(>F)
# Model     4 0.007621 1.4103  0.202
# Residual 49 0.066196 

#### Discriminant analisis age vs metabolites ####
Age_single<- Factors18T[,6] #doenst work with this
#read data again as factor young vs old age
Age18_single_factor <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Age18_single_factor.csv", quote="", stringsAsFactors=TRUE)
View(Age18_single_factor)

Age_factor<- Age18_single_factor[,2]

DA18age <- rda(Age_single~., Metabolites18T)
summary(DA18age)
# Call:
#   rda(formula = Age_single ~ Serine + Putrescine + Trans_Hydroxyproline +      Asparagine + Glutamine + Alpha_Aminoadipic_Acid + Methionine_Sulfoxide +      Acetyl_Ornithine + Citrulline + Asymmetric_Dimethylarginine +      Total_Dimethylarginine + Tryptophan + Kynurenine + Ornithine +      Lysine + Spermidine + Spermine + Sarcosine + Methylhistidine +      Beta_Hydroxybutyric_Acid + Alpha_Ketoglutaric_Acid + Butyric_acid +      Propionic_Acid + Fumaric_Acid + Isobutyric_Acid + Hippuric_Acid +      Methylmalonic_Acid + LYSOC14_0 + LYSOC16_1 + LYSOC16_0 +      LYSOC17_0 + LYSOC18_2 + LYSOC18_1 + LYSOC18_0 + LYSOC20_4 +      LYSOC20_3 + LYSOC24_0 + LYSOC26_1 + LYSOC26_0 + LYSOC28_1 +      LYSOC28_0 + X14_1SMOH + X16_1SM + X16_0SM + X16_1SMOH + X18_1SM +      PC32_2AA + X18_0SM + X20_2SM + PC36_0AE + PC36_6AA + PC36_0AA +      X22_2SMOH + X22_1SMOH + PC38_6AA + PC38_0AA + PC40_6AE +      X24_1SMOH + PC40_6AA + PC40_2AA + PC401AA + C2 + C3_1 + C3 +      C4_1 + C4 + C3OH + C5_1 + C5 + C4OH + C6_1 + C6 + C5OH +      C5_1DC + C5DC + C8 + C5MDC + C9 + C7DC + C10_2 + C10_1 +      C10 + C12_1 + C12 + C14_2 + C14_1 + C14 + C12DC + C14_2OH +      C14_1OH + C16_2 + C16_1 + C16 + C16_2OH + C16_1OH + C16OH +      C18_2 + C18_1 + C18 + C18_1OH + Arginine_Average + Betaine_Average +      C0_Average + Choline_Average + Citrate_Average + Creatine_Average +      Creatinine_Average + Glucose_Average + Glutamate_Average +      Glycine_Average + Histidine_Average + Isoleucine_Average +      Lactate_Average + Leucine + Methionine + Phenylalanine_Average +      Proline + Pyruvate_Average + Succinate_Average + Threonine_Average +      Tyrosine_Average + Valine_Average + X1_Methylhistidine +      X2_Hydroxybutyrate + X2_Hydroxyisovaleric_Acid + X3_Hydroxybutyrate +      ADP + AMP + ATP + Acetamide + Acetate + Acetoacetate + Acetone +      Adenosine + Alanine + Aspartate + Creatine_Phosphate + Cytidine +      Dimethyl_Sulfone + Ethanol + Ethanolamine + Formate + Glycerol +      Guanidoacetate + Guanosine + Hypoxanthine + IMP + Inosine +      Isopropanol + Malate + Malonate + Mannose + Methanol + N_N_Dimethylglycine +      Nicotinurate + O_Acetylcarnitine + O_Phosphocholine + Propylene_Glycol +      Taurine + Uridine + Xanthine + sn_Glycero_3_Phosphocholine +      Beta.Alanine, data = Metabolites18T) 
# 
# Partitioning of variance:
#   Inertia Proportion
# Total         5.862e-06          1
# Constrained   5.862e-06          1
# Unconstrained 0.000e+00          0
# 
# Eigenvalues, and their contribution to the variance 
# 
# Importance of components:
#   RDA1
# Eigenvalue            5.862e-06
# Proportion Explained  1.000e+00
# Cumulative Proportion 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#   RDA1
# Eigenvalue            5.862e-06
# Proportion Explained  1.000e+00
# Cumulative Proportion 1.000e+00
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# * General scaling constant of scores:  0.1327649 
# 
# 
# Species scores
# 
# RDA1
# col1 0.1328
# 
# 
# Site scores (weighted sums of species scores)
# 
# RDA1
# row1   3.260e-02
# row2  -9.239e-04
# row3   1.651e-02
# row4   6.526e-03
# row5   3.248e-02
# row6   3.463e-02
# row7   4.183e-02
# row8   9.009e-05
# row9   4.253e-02
# row10  7.449e-03
# row11 -1.154e-02
# row12 -1.195e-02
# row13  1.636e-02
# row14  1.808e-02
# row15 -2.576e-02
# row16  1.052e-02
# row17 -1.396e-02
# row18 -8.855e-03
# row19 -3.370e-03
# row20 -1.324e-02
# row21  1.988e-03
# row22 -4.757e-03
# row23 -1.309e-02
# row24 -4.904e-03
# row25 -1.918e-02
# row26 -8.801e-03
# row27  1.702e-03
# row28  9.383e-03
# row29  2.401e-03
# row30 -1.905e-02
# row31 -6.701e-03
# row32 -1.495e-02
# row33 -4.772e-03
# row34  3.707e-02
# row35  6.758e-03
# row36 -1.389e-02
# row37  1.407e-02
# row38  4.536e-03
# row39  1.350e-02
# row40  2.142e-02
# row41 -1.841e-02
# row42 -1.493e-02
# row43 -1.582e-02
# row44 -1.927e-02
# row45 -2.744e-02
# row46 -3.775e-02
# row47 -1.725e-03
# row48 -1.754e-02
# row49 -5.233e-05
# row50 -2.532e-02
# row51 -6.697e-05
# row52 -2.176e-03
# row53  8.130e-03
# row54 -3.729e-04
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# RDA1
# row1   3.260e-02
# row2  -9.239e-04
# row3   1.651e-02
# row4   6.526e-03
# row5   3.248e-02
# row6   3.463e-02
# row7   4.183e-02
# row8   9.009e-05
# row9   4.253e-02
# row10  7.449e-03
# row11 -1.154e-02
# row12 -1.195e-02
# row13  1.636e-02
# row14  1.808e-02
# row15 -2.576e-02
# row16  1.052e-02
# row17 -1.396e-02
# row18 -8.855e-03
# row19 -3.370e-03
# row20 -1.324e-02
# row21  1.988e-03
# row22 -4.757e-03
# row23 -1.309e-02
# row24 -4.904e-03
# row25 -1.918e-02
# row26 -8.801e-03
# row27  1.702e-03
# row28  9.383e-03
# row29  2.401e-03
# row30 -1.905e-02
# row31 -6.701e-03
# row32 -1.495e-02
# row33 -4.772e-03
# row34  3.707e-02
# row35  6.758e-03
# row36 -1.389e-02
# row37  1.407e-02
# row38  4.536e-03
# row39  1.350e-02
# row40  2.142e-02
# row41 -1.841e-02
# row42 -1.493e-02
# row43 -1.582e-02
# row44 -1.927e-02
# row45 -2.744e-02
# row46 -3.775e-02
# row47 -1.725e-03
# row48 -1.754e-02
# row49 -5.233e-05
# row50 -2.532e-02
# row51 -6.697e-05
# row52 -2.176e-03
# row53  8.130e-03
# row54 -3.729e-04
# 
# 
# Biplot scores for constraining variables
# 
# RDA1
# Serine                       0.3581837
# Putrescine                  -0.1996122
# Trans_Hydroxyproline        -0.3023805
# Asparagine                  -0.2775460
# Glutamine                    0.1897277
# Alpha_Aminoadipic_Acid      -0.0955812
# Methionine_Sulfoxide         0.3363783
# Acetyl_Ornithine            -0.1848767
# Citrulline                  -0.1139671
# Asymmetric_Dimethylarginine -0.0001819
# Total_Dimethylarginine      -0.0005646
# Tryptophan                  -0.0461641
# Kynurenine                   0.1709236
# Ornithine                    0.2811619
# Lysine                       0.3068755
# Spermidine                  -0.3458218
# Spermine                    -0.3285214
# Sarcosine                    0.2208487
# Methylhistidine              0.1274454
# Beta_Hydroxybutyric_Acid    -0.1076285
# Alpha_Ketoglutaric_Acid     -0.0808590
# Butyric_acid                -0.2642953
# Propionic_Acid              -0.1296446
# Fumaric_Acid                 0.1086155
# Isobutyric_Acid             -0.3757612
# Hippuric_Acid               -0.2014526
# Methylmalonic_Acid          -0.1535915
# LYSOC14_0                   -0.0954357
# LYSOC16_1                   -0.0656224
# LYSOC16_0                   -0.0461960
# LYSOC17_0                   -0.0542079
# LYSOC18_2                    0.0698233
# LYSOC18_1                    0.0889973
# LYSOC18_0                    0.1898469
# LYSOC20_4                   -0.2031843
# LYSOC20_3                   -0.1311852
# LYSOC24_0                    0.0469900
# LYSOC26_1                   -0.0651858
# LYSOC26_0                    0.0395451
# LYSOC28_1                   -0.1941070
# LYSOC28_0                   -0.0027311
# X14_1SMOH                   -0.3524587
# X16_1SM                     -0.3256689
# X16_0SM                     -0.4094836
# X16_1SMOH                   -0.5086590
# X18_1SM                     -0.0725468
# PC32_2AA                     0.1946964
# X18_0SM                      0.1900195
# X20_2SM                      0.0634195
# PC36_0AE                    -0.4002963
# PC36_6AA                    -0.1884708
# PC36_0AA                    -0.4837300
# X22_2SMOH                   -0.4295161

anova(DA18age)

DA18age <- rda(Metabolites18T~., Factors18$Spine.Age, data=Factors18T)
Metabolites18T
summary(RDA_met184)

#### CCA with smaller model ####
CCA_met184 <- cca(Metabolites18T~.,FactorsT4)
summary(CCA_met184)
# Call:
#   cca(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data = FactorsT4) 
# 
# Partitioning of scaled Chi-square:
#   Inertia Proportion
# Total         0.15710     1.0000
# Constrained   0.01896     0.1207
# Unconstrained 0.13814     0.8793
# 
# Eigenvalues, and their contribution to the scaled Chi-square 
# 
# Importance of components:
#   CCA1     CCA2     CCA3     CCA4     CA1     CA2      CA3
# Eigenvalue            0.009446 0.005622 0.002398 0.001497 0.04086 0.02603 0.009601
# Proportion Explained  0.060128 0.035784 0.015262 0.009527 0.26009 0.16571 0.061113
# Cumulative Proportion 0.060128 0.095913 0.111174 0.120701 0.38079 0.54650 0.607614
# CA4      CA5      CA6      CA7     CA8      CA9     CA10
# Eigenvalue            0.008264 0.006732 0.005648 0.005195 0.00494 0.004011 0.003729
# Proportion Explained  0.052604 0.042851 0.035953 0.033069 0.03144 0.025532 0.023735
# Cumulative Proportion 0.660219 0.703070 0.739023 0.772092 0.80353 0.829066 0.852801
# CA11     CA12    CA13     CA14     CA15     CA16     CA17
# Eigenvalue            0.003484 0.002742 0.00212 0.001769 0.001595 0.001399 0.001160
# Proportion Explained  0.022176 0.017450 0.01349 0.011259 0.010154 0.008907 0.007384
# Cumulative Proportion 0.874977 0.892427 0.90592 0.917181 0.927335 0.936242 0.943626
# CA18      CA19      CA20      CA21      CA22      CA23
# Eigenvalue            0.001111 0.0008904 0.0007996 0.0007314 0.0006343 0.0005467
# Proportion Explained  0.007074 0.0056674 0.0050899 0.0046553 0.0040378 0.0034799
# Cumulative Proportion 0.950700 0.9563676 0.9614574 0.9661128 0.9701505 0.9736304
# CA24      CA25      CA26      CA27      CA28      CA29
# Eigenvalue            0.0004781 0.0004703 0.0004264 0.0003632 0.0003045 0.0002836
# Proportion Explained  0.0030435 0.0029937 0.0027139 0.0023116 0.0019379 0.0018051
# Cumulative Proportion 0.9766739 0.9796677 0.9823816 0.9846931 0.9866311 0.9884362
# CA30      CA31     CA32      CA33      CA34      CA35
# Eigenvalue            0.0002366 0.0001975 0.000181 0.0001724 0.0001370 0.0001194
# Proportion Explained  0.0015058 0.0012570 0.001152 0.0010973 0.0008723 0.0007602
# Cumulative Proportion 0.9899420 0.9911990 0.992351 0.9934482 0.9943204 0.9950806
# CA36      CA37      CA38      CA39      CA40      CA41
# Eigenvalue            0.000102 9.671e-05 8.913e-05 7.646e-05 7.212e-05 6.723e-05
# Proportion Explained  0.000649 6.156e-04 5.673e-04 4.867e-04 4.591e-04 4.279e-04
# Cumulative Proportion 0.995730 9.963e-01 9.969e-01 9.974e-01 9.979e-01 9.983e-01
# CA42      CA43      CA44      CA45      CA46      CA47
# Eigenvalue            6.234e-05 4.922e-05 3.888e-05 3.821e-05 2.715e-05 2.215e-05
# Proportion Explained  3.968e-04 3.133e-04 2.475e-04 2.432e-04 1.728e-04 1.410e-04
# Cumulative Proportion 9.987e-01 9.990e-01 9.992e-01 9.995e-01 9.997e-01 9.998e-01
# CA48      CA49
# Eigenvalue            1.732e-05 1.397e-05
# Proportion Explained  1.102e-04 8.895e-05
# Cumulative Proportion 9.999e-01 1.000e+00
# 
# Accumulated constrained eigenvalues
# Importance of components:
#                          CCA1     CCA2     CCA3     CCA4
# Eigenvalue            0.009446 0.005622 0.002398 0.001497
# Proportion Explained  0.498159 0.296472 0.126443 0.078927
# Cumulative Proportion 0.498159 0.794631 0.921073 1.000000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# 
# 
# Species scores
# 
#                                CCA1       CCA2       CCA3       CCA4       CA1
# Serine                      -0.1872242 -2.019e-01 -0.0329948 -2.778e-02 -0.054807
# Putrescine                   0.0337253 -4.323e-02  0.0937223  7.159e-02 -0.080349
# Trans_Hydroxyproline         0.3483340  6.574e-02  0.2532702 -1.865e-01 -0.225160
# Asparagine                   0.3292459  1.002e-01  0.3480362 -2.136e-01 -0.299237
# Glutamine                   -0.1884644 -2.168e-01  0.0052883 -2.015e-02 -0.242885
# Alpha_Aminoadipic_Acid       0.2128369 -1.570e-01 -0.1413453 -7.504e-02 -0.205059
# Methionine_Sulfoxide        -0.2192828 -8.385e-02  0.0378934 -3.377e-02 -0.034389
# Acetyl_Ornithine             0.0879924 -2.889e-02  0.0234220  2.914e-02 -0.071828
# Citrulline                   0.4640065  7.145e-01 -0.3500154 -7.620e-03  0.186383
# Asymmetric_Dimethylarginine -0.0392884 -1.354e-01  0.0488059  6.520e-02 -0.122722
# Total_Dimethylarginine      -0.0402631 -1.605e-01  0.0551109  3.545e-03 -0.015707
# Tryptophan                   0.0454651 -2.713e-02 -0.0239325 -9.355e-02 -0.050567
# Kynurenine                  -0.1046262 -1.324e-01 -0.3317015 -1.336e-01 -0.649153
# Ornithine                   -0.4578043 -4.974e-01  0.0306941  4.079e-02 -0.242282
# Lysine                      -0.4990885 -3.708e-01  0.0535483  2.222e-02 -0.068142
# Spermidine                   0.1557915 -2.809e-02  0.1200858  5.570e-02 -0.089259
# Spermine                     0.0966547  1.608e-02  0.0382852  2.387e-02  0.014497
# Sarcosine                   -0.2177160 -3.632e-01  0.0022926 -3.969e-02 -0.084664
# Methylhistidine             -0.1972404 -3.136e-01  0.0448201 -4.496e-02  0.139078
# Beta_Hydroxybutyric_Acid     0.1995474 -2.091e-01 -0.0826386 -2.652e-02  0.361165
# Alpha_Ketoglutaric_Acid      0.0166664 -2.912e-02  0.0062210 -4.065e-02  0.031821
# Butyric_acid                 0.0722485 -1.108e-02  0.0677378 -1.046e-02  0.069985
# Propionic_Acid              -0.0003518  2.233e-02  0.0761360 -1.329e-05  0.013760
# Fumaric_Acid                -0.0239140 -8.375e-02 -0.0256081 -2.086e-02  0.039995
# Isobutyric_Acid              0.2045361 -7.282e-03  0.0846166 -1.461e-01  0.078381
# Hippuric_Acid                0.0240905  7.876e-02  0.0995279  6.263e-03  0.130743
# Methylmalonic_Acid           0.0596753 -2.683e-02  0.2067042  1.056e-01 -0.157780
# LYSOC14_0                    0.0732429  6.769e-02 -0.0515576  1.248e-02 -0.009882
# LYSOC16_1                    0.1271735  1.037e-01 -0.1294233 -2.325e-02 -0.032663
# LYSOC16_0                    0.1066185  1.153e-01 -0.1178155  1.091e-02  0.003132
# LYSOC17_0                    0.0800289  1.041e-01 -0.0780804 -8.205e-03 -0.041832
# LYSOC18_2                    0.0272577 -3.786e-02 -0.0838078 -2.567e-02 -0.045244
# LYSOC18_1                    0.0075997 -4.019e-02 -0.0686157 -9.490e-03 -0.016806
# LYSOC18_0                   -0.0490048 -7.523e-02 -0.0444633  1.627e-02 -0.033844
# LYSOC20_4                    0.1653591 -4.907e-02 -0.0552763 -1.888e-03 -0.102857
# LYSOC20_3                    0.0121290  2.551e-02  0.0346207 -2.157e-02  0.024203
# LYSOC24_0                   -0.0220668  5.383e-02  0.0002862 -9.314e-03  0.058491
# LYSOC26_1                    0.0116990  3.501e-02  0.0124261 -3.406e-03  0.015314
# LYSOC26_0                   -0.0096562  6.998e-02 -0.0117143 -7.039e-03  0.034494
# LYSOC28_1                    0.0427658  4.350e-02  0.0214649  1.576e-02  0.017777
# LYSOC28_0                   -0.0037246  5.925e-02  0.0037154  7.187e-04  0.026329
# X14_1SMOH                    0.1374745  6.100e-02  0.0033756  1.213e-02 -0.009645
# X16_1SM                      0.1790144  6.113e-03 -0.0078186 -1.032e-02  0.010389
# X16_0SM                      0.1894411  3.512e-02  0.0160116  1.201e-02  0.003887
# X16_1SMOH                    0.2629719  1.747e-01  0.0182356 -3.065e-02 -0.029869
# X18_1SM                      0.0474937 -4.393e-02 -0.0323973  3.257e-02 -0.069937
# PC32_2AA                    -0.0273860 -3.481e-02 -0.0938361  2.173e-02 -0.077203
# X18_0SM                     -0.0296812 -7.334e-02 -0.0856255  2.303e-02 -0.048583
# X20_2SM                      0.0107616 -8.825e-02 -0.0613780  4.833e-02 -0.123452
# PC36_0AE                     0.1776417  1.010e-01 -0.0066014 -1.805e-02 -0.041815
# PC36_6AA                     0.1110941  2.263e-02 -0.0489782  3.410e-02 -0.142864
# PC36_0AA                     0.2554229  1.832e-01  0.0510952 -2.910e-02 -0.103429
# X22_2SMOH                    0.2329095  9.361e-02  0.0143147  1.261e-02 -0.024936
# X22_1SMOH                    0.1498323  3.761e-02 -0.0264113  1.797e-02 -0.043119
# PC38_6AA                     0.0981241  7.007e-03 -0.0422001  5.341e-03 -0.091386
# PC38_0AA                     0.2074827  5.688e-02 -0.0196407 -1.007e-02 -0.099743
# PC40_6AE                     0.1138886  5.127e-05 -0.0238471  9.052e-03 -0.107005
# X24_1SMOH                    0.0715883 -2.353e-04 -0.0421820 -1.102e-02 -0.045142
# PC40_6AA                    -0.0479620 -1.548e-01 -0.0481852  1.570e-02 -0.085271
# PC40_2AA                     0.0696495  4.700e-02 -0.0164195  6.824e-03 -0.018375
# PC401AA                      0.0326167 -5.982e-03 -0.0334818  1.786e-02 -0.018095
# C2                          -0.0552078 -5.302e-02 -0.0562477  1.998e-02 -0.010386
# C3_1                         0.0391777  6.679e-02  0.0448543 -2.038e-02  0.082644
# C3                           0.1459513  6.355e-03  0.0768965  1.919e-02 -0.101521
# C4_1                         0.0874671  7.401e-02  0.0338338 -3.559e-03 -0.051645
# C4                           0.2011772  2.809e-02 -0.0032916  7.132e-02  0.038026
# C3OH                         0.0481231  4.074e-02  0.0148992 -1.601e-02 -0.054741
# C5_1                         0.0381695  1.634e-02  0.1067602  2.300e-02  0.043223
# C5                           0.2174417  5.137e-02  0.1818333  9.924e-02 -0.174992
# C4OH                         0.4823079 -3.076e-02 -0.2422909 -3.648e-02  0.157825
# C6_1                         0.1311713  7.916e-02 -0.0038192 -1.546e-02  0.076484
# C6                           0.0504061  5.440e-02 -0.0231683 -2.788e-02  0.110299
# C5OH                        -0.0171976 -2.452e-02  0.0626191  9.823e-02 -0.031956
# C5_1DC                       0.1313679  1.902e-02  0.0189091 -1.099e-02  0.029996
# C5DC                        -0.0116571  4.941e-02  0.0446076 -3.015e-02  0.058876
# C8                           0.0318723 -1.710e-03 -0.0924021  4.002e-02  0.090534
# C5MDC                        0.0204915  8.589e-03  0.0179174 -2.912e-02  0.096528
# C9                           0.0379989 -4.571e-02 -0.0690433 -2.474e-02  0.116999
# C7DC                         0.0500920 -5.006e-02 -0.1831784 -3.710e-02 -0.199890
# C10_2                       -0.0410100 -2.017e-02 -0.0139281  4.058e-02  0.159016
# C10_1                        0.0274199  3.025e-02 -0.0042703 -2.493e-03  0.077868
# C10                          0.0324641  1.839e-02 -0.0095837 -1.806e-02  0.091377
# C12_1                        0.0776432 -2.039e-02 -0.0566088 -9.790e-03  0.120149
# C12                          0.0795572 -2.184e-02 -0.0803287 -1.255e-02  0.174661
# C14_2                        0.0893074  3.934e-02 -0.0593041 -8.209e-03  0.110446
# C14_1                        0.1289283 -1.209e-01 -0.1464731 -3.300e-04  0.151142
# C14                          0.2365342 -1.448e-01 -0.2593287 -1.470e-02  0.297425
# C12DC                        0.0365641 -8.918e-02 -0.0748297 -1.938e-02  0.132157
# C14_2OH                      0.0752550 -1.401e-01 -0.1490682 -1.367e-02  0.208542
# C14_1OH                      0.2454180 -9.947e-02 -0.2533162 -2.308e-02  0.296090
# C16_2                        0.0131563 -9.120e-02 -0.1075983 -3.111e-02  0.157100
# C16_1                        0.0879373 -1.279e-01 -0.2653634  3.102e-03  0.274492
# C16                          0.1996925 -4.030e-02 -0.2173562 -1.177e-02  0.264507
# C16_2OH                      0.1701048 -4.097e-02 -0.1676941 -1.798e-02  0.211850
# C16_1OH                      0.2190103 -2.593e-02 -0.1996695 -2.843e-02  0.179450
# C16OH                        0.1510784 -9.438e-02 -0.0966222 -1.927e-03  0.210993
# C18_2                        0.0647990 -1.586e-01 -0.2158119 -2.299e-02  0.218328
# C18_1                        0.1203537 -9.024e-02 -0.2576142 -1.412e-02  0.251397
# C18                          0.1672786 -2.026e-02 -0.1899482 -7.206e-03  0.190086
# C18_1OH                      0.1074437 -3.034e-02 -0.1354733 -1.028e-02  0.206012
# Arginine_Average            -0.2857550 -2.096e-01  0.0384540  1.033e-01 -0.081503
# Betaine_Average              0.0455166  4.090e-02 -0.1284611  5.511e-02  0.072633
# C0_Average                  -0.0443371 -8.909e-02  0.0490345  5.728e-02  0.083937
# Choline_Average             -0.0662337 -9.688e-02 -0.0724218  3.035e-03 -0.101302
# Citrate_Average              0.2852022 -1.801e-01 -0.0831113 -3.664e-02  0.049418
# Creatine_Average             0.1181101  7.500e-02  0.1263187  2.757e-02  0.105127
# Creatinine_Average           0.0781068 -1.851e-02  0.1234215  2.563e-02  0.029177
# Glucose_Average             -0.1185362  6.072e-02  0.0087149 -2.834e-03 -0.299045
# Glutamate_Average           -0.0799416 -1.392e-01 -0.0456681 -4.543e-02 -0.029324
# Glycine_Average             -0.1052365 -1.053e-01  0.0228388 -6.023e-02 -0.014516
# Histidine_Average           -0.0528460 -1.358e-02  0.0336895  5.731e-02 -0.106039
# Isoleucine_Average           0.1090082 -1.288e-01 -0.0052984 -1.086e-01 -0.078563
# Lactate_Average              0.0174342 -1.042e-02 -0.0247815 -1.403e-02 -0.016567
# Leucine                     -0.1269077 -1.970e-01  0.0908740  8.006e-02  0.005118
# Methionine                  -0.1414468 -2.191e-01  0.0259594  4.488e-02 -0.061305
# Phenylalanine_Average       -0.0990316 -1.164e-01 -0.0309136 -4.785e-02 -0.082387
# Proline                      0.2062220 -8.725e-02  0.1077111 -9.053e-02 -0.168481
# Pyruvate_Average            -0.0994323 -9.536e-02 -0.0208741  4.102e-02 -0.000417
# Succinate_Average           -0.0787428 -6.915e-02 -0.0663893 -4.931e-02  0.069205
# Threonine_Average           -0.1446618 -1.055e-01  0.0853678 -6.186e-02 -0.104243
# Tyrosine_Average            -0.1686998 -2.138e-01 -0.0927787  2.935e-02 -0.021952
# Valine_Average               0.0899289 -1.237e-01  0.0193007 -1.067e-01 -0.072965
# X1_Methylhistidine          -0.0328472  6.981e-02  0.0059648 -2.997e-03  0.080391
# X2_Hydroxybutyrate           0.1713136 -9.773e-02 -0.0033854 -4.572e-01  0.190548
# X2_Hydroxyisovaleric_Acid    0.3925604 -1.010e-01  0.1007758  1.237e-01  0.316932
# X3_Hydroxybutyrate           0.1625475 -2.051e-01 -0.0814499 -8.221e-04  0.399338
# ADP                         -0.0303885  1.195e-01 -0.2231282  5.387e-02  0.340333
# AMP                         -0.0183068  7.297e-02 -0.0475138 -7.631e-02  0.100059
# ATP                          0.7338441  9.078e-02  0.1850633  4.087e-01  0.770457
# Acetamide                   -0.0006262  1.284e-02 -0.0852784  6.987e-02  0.193021
# Acetate                      0.0906551 -4.524e-02 -0.0271126 -9.848e-03  0.202443
# Acetoacetate                -0.1395507  2.047e-01  0.0837382 -1.660e-01  0.207230
# Acetone                      0.1744626 -1.052e-01 -0.0521319 -5.523e-02  0.292555
# Adenosine                   -0.1234150 -3.674e-02 -0.1301602  1.303e-01  0.345429
# Alanine                      0.0579633 -6.698e-02 -0.0823848 -6.106e-02  0.019093
# Aspartate                    0.0931443 -1.124e-01  0.1224552 -1.136e-01  0.137320
# Creatine_Phosphate          -0.0783326 -4.090e-02 -0.0634138  1.401e-01  0.120545
# Cytidine                    -0.0262400 -3.103e-02  0.0643700 -3.434e-02  0.164733
# Dimethyl_Sulfone             0.1538564 -1.123e-02  0.0669836 -5.482e-02  0.112704
# Ethanol                      0.0216519  2.120e-01  0.1807639  1.148e-01  0.098745
# Ethanolamine                 0.0263331  2.899e-02 -0.1375467  1.591e-02  0.229231
# Formate                      0.0278708  9.702e-02  0.1126933  9.563e-02  0.109579
# Glycerol                     0.0042580  7.871e-02  0.0314649  1.589e-01  0.206469
# Guanidoacetate               0.0238464 -3.233e-02 -0.0613611  2.621e-02  0.110657
# Guanosine                   -0.1000171  4.939e-02 -0.1477854 -9.378e-02  0.272904
# Hypoxanthine                -0.0564511  6.785e-02 -0.0770917 -2.334e-02  0.221337
# IMP                          0.0688354 -1.789e-01 -0.0040418  6.993e-02  0.096387
# Inosine                      0.1511116  5.566e-02  0.1369320 -1.140e-01  0.139180
# Isopropanol                  0.0282328  5.635e-02  0.0335225  1.350e-02  0.113484
# Malate                      -0.0342430 -3.867e-01 -0.1059333  4.505e-02  0.368943
# Malonate                     0.0341526  3.612e-02  0.0551814 -1.568e-02  0.196127
# Mannose                     -0.1472727 -9.043e-02  0.0190889 -1.005e-02 -0.016565
# Methanol                     0.0039320  3.375e-02  0.0866208 -9.639e-03  0.046280
# N_N_Dimethylglycine          0.0011863 -8.616e-02 -0.0471937 -3.239e-02  0.145879
# Nicotinurate                 0.0769469 -1.245e-01  0.0052153  1.714e-02  0.129511
# O_Acetylcarnitine           -0.0591369 -4.572e-02 -0.0169872  2.199e-02  0.030358
# O_Phosphocholine             0.0053526 -4.476e-02  0.0720402  1.231e-02  0.130395
# Propylene_Glycol             0.0997072 -1.778e-02  0.1017327 -1.100e-01  0.350594
# Taurine                      0.0584281 -3.118e-03  0.0207659  1.437e-02  0.234211
# Uridine                     -0.0300972 -1.040e-01  0.0186274 -1.456e-02  0.110716
# Xanthine                     0.2524141  5.850e-02  0.2883029  1.921e-01  0.335830
# sn_Glycero_3_Phosphocholine -0.0041335 -7.277e-02 -0.0210989  4.628e-02  0.056825
# Beta.Alanine                 0.0708707 -2.007e-01 -0.0083835  9.829e-02  0.052862
# CA2
# Serine                       0.0328409
# Putrescine                   0.2016699
# Trans_Hydroxyproline         0.7429278
# Asparagine                   0.8221789
# Glutamine                    0.1743463
# Alpha_Aminoadipic_Acid       0.1983315
# Methionine_Sulfoxide         0.0910685
# Acetyl_Ornithine             0.1416347
# Citrulline                  -0.6110869
# Asymmetric_Dimethylarginine  0.3759396
# Total_Dimethylarginine       0.3274242
# Tryptophan                   0.3034874
# Kynurenine                   0.3213083
# Ornithine                   -0.1179754
# Lysine                      -0.1085607
# Spermidine                   0.2795386
# Spermine                     0.1192216
# Sarcosine                    0.0097900
# Methylhistidine             -0.0795364
# Beta_Hydroxybutyric_Acid     0.6145441
# Alpha_Ketoglutaric_Acid      0.0228196
# Butyric_acid                 0.1587132
# Propionic_Acid              -0.0444489
# Fumaric_Acid                 0.0659178
# Isobutyric_Acid              0.3158896
# Hippuric_Acid                0.0488480
# Methylmalonic_Acid           0.1529662
# LYSOC14_0                   -0.0392212
# LYSOC16_1                   -0.0537570
# LYSOC16_0                   -0.1281981
# LYSOC17_0                   -0.0761731
# LYSOC18_2                    0.0697344
# LYSOC18_1                    0.0626418
# LYSOC18_0                    0.0501864
# LYSOC20_4                    0.2721007
# LYSOC20_3                   -0.0283674
# LYSOC24_0                   -0.0278220
# LYSOC26_1                    0.0243354
# LYSOC26_0                   -0.0384657
# LYSOC28_1                    0.0376770
# LYSOC28_0                    0.0133966
# X14_1SMOH                    0.0594118
# X16_1SM                      0.2414404
# X16_0SM                      0.1962725
# X16_1SMOH                    0.0909591
# X18_1SM                      0.0697654
# PC32_2AA                    -0.0558985
# X18_0SM                     -0.0386433
# X20_2SM                      0.0175206
# PC36_0AE                     0.1374443
# PC36_6AA                     0.0137169
# PC36_0AA                     0.1591972
# X22_2SMOH                    0.2056364
# X22_1SMOH                    0.1386793
# PC38_6AA                     0.0189640
# PC38_0AA                     0.1771018
# PC40_6AE                     0.0667147
# X24_1SMOH                    0.0227359
# PC40_6AA                     0.0960533
# PC40_2AA                     0.0509560
# PC401AA                      0.0463142
# C2                           0.2036320
# C3_1                         0.2530737
# C3                           0.3400627
# C4_1                         0.1332112
# C4                           0.5405915
# C3OH                        -0.0023913
# C5_1                         0.1160023
# C5                           0.5622678
# C4OH                         0.5281463
# C6_1                         0.0365704
# C6                           0.1299173
# C5OH                         0.0890230
# C5_1DC                       0.1655977
# C5DC                         0.2251860
# C8                           0.1975253
# C5MDC                       -0.0061742
# C9                           0.1085886
# C7DC                        -0.1367724
# C10_2                        0.0268605
# C10_1                        0.0102368
# C10                         -0.0066248
# C12_1                        0.1621866
# C12                          0.1355711
# C14_2                        0.1136655
# C14_1                        0.3238753
# C14                          0.4811966
# C12DC                       -0.0006355
# C14_2OH                      0.1864011
# C14_1OH                      0.4292031
# C16_2                        0.1137398
# C16_1                        0.2885063
# C16                          0.3198896
# C16_2OH                      0.2831493
# C16_1OH                      0.2908286
# C16OH                        0.2659869
# C18_2                        0.2992648
# C18_1                        0.2994184
# C18                          0.1843116
# C18_1OH                      0.2197351
# Arginine_Average            -0.0290451
# Betaine_Average             -0.1403841
# C0_Average                   0.1434358
# Choline_Average             -0.1412538
# Citrate_Average              0.4591320
# Creatine_Average             0.4730315
# Creatinine_Average           0.4037065
# Glucose_Average             -0.1078137
# Glutamate_Average            0.0883514
# Glycine_Average              0.1274525
# Histidine_Average            0.1363534
# Isoleucine_Average           0.4111005
# Lactate_Average              0.1304748
# Leucine                      0.2873546
# Methionine                   0.1524222
# Phenylalanine_Average        0.1407988
# Proline                      0.3825297
# Pyruvate_Average             0.0138515
# Succinate_Average           -0.0005026
# Threonine_Average            0.1781190
# Tyrosine_Average             0.3498116
# Valine_Average               0.4115873
# X1_Methylhistidine          -0.0365147
# X2_Hydroxybutyrate           0.3539243
# X2_Hydroxyisovaleric_Acid   -0.0998489
# X3_Hydroxybutyrate           0.6292544
# ADP                         -0.6431170
# AMP                         -0.0731282
# ATP                         -1.5776943
# Acetamide                   -0.3598609
# Acetate                      0.0399476
# Acetoacetate                 0.5751223
# Acetone                      0.1777934
# Adenosine                   -0.0388829
# Alanine                     -0.0440205
# Aspartate                    0.2170293
# Creatine_Phosphate          -0.2317833
# Cytidine                    -0.0321252
# Dimethyl_Sulfone             0.0466973
# Ethanol                     -0.1124872
# Ethanolamine                -0.3934424
# Formate                     -0.0788994
# Glycerol                    -0.0496236
# Guanidoacetate              -0.1503208
# Guanosine                   -0.2023460
# Hypoxanthine                -0.1458726
# IMP                          0.2529470
# Inosine                      0.1275643
# Isopropanol                 -0.1813922
# Malate                       0.0763826
# Malonate                     0.0214346
# Mannose                      0.0740488
# Methanol                     0.0158574
# N_N_Dimethylglycine         -0.1220887
# Nicotinurate                -0.0065106
# O_Acetylcarnitine            0.2166997
# O_Phosphocholine            -0.0407808
# Propylene_Glycol             0.4746984
# Taurine                     -0.0796881
# Uridine                      0.1091824
# Xanthine                    -0.1117682
# sn_Glycero_3_Phosphocholine -0.3905737
# Beta.Alanine                -0.1792419
# 
# 
# Site scores (weighted averages of species scores)
# 
#           CCA1     CCA2     CCA3     CCA4       CA1      CA2
# row1  -3.35626 -0.63580 -2.47669 -0.65862 -1.262602 -0.37995
# row2  -0.54160  2.79140 -2.46586  0.61144 -0.603262 -0.59487
# row3   1.45926  1.92392 -2.69463  2.64447  1.625336 -0.96820
# row4  -2.25443  0.89645 -0.72150  0.33802 -0.861961 -0.61658
# row5  -3.84114  0.16435  0.03982 -1.77743 -1.473702 -0.20440
# row6  -1.45587 -0.43055 -0.42842  0.69129  0.034487 -0.68615
# row7  -2.13977  0.16191 -2.35557 -0.92403 -0.525898  0.33797
# row8  -1.59421 -1.26026 -1.59057  0.80379 -0.573924 -0.61638
# row9  -0.13138 -1.64347 -1.57090  1.93295  1.087900 -0.16697
# row10  1.97917 -3.42614 -2.43378  2.27914  1.897917  0.22557
# row11 -1.47533 -0.54418 -1.13550  0.79649 -0.200123 -0.48266
# row12  1.67457  1.48420 -2.31058  2.96678  1.038639 -1.54660
# row13 -0.22542  2.57393 -4.09025  0.38198 -0.365230  0.33685
# row14  1.38145  0.86466 -1.89884  0.60600  1.411092 -0.04348
# row15  2.84454  0.78889 -0.59902  7.89281  1.484548 -2.43141
# row16 -0.93415 -1.21027 -1.76725 -0.57651 -0.060980  0.12428
# row17  1.44630  1.89267 -3.85706  5.30090  0.665615 -2.05600
# row18 -0.48300  2.32802 -1.76764  1.00341 -0.540777 -1.26355
# row19  1.86640  1.46694 -0.30506  2.69629  1.638492 -1.78949
# row20 -1.44680  3.73529 -2.96158 -1.49993 -2.254365 -0.47403
# row21 -2.09132 -2.88013  0.40609 -1.13151 -0.312895 -0.14160
# row22 -1.30784 -0.61329  0.55204  0.70538 -0.322514 -1.21012
# row23  0.89947 -0.18491  1.98604  6.73071  1.104483  0.08359
# row24  0.16309 -0.87371 -0.39088  0.97137  0.959425 -0.67399
# row25  0.48445 -0.43100 -0.05172 -0.24704 -0.640090 -0.63413
# row26  0.80725  0.36794  3.31114  1.17699  0.957358 -0.43645
# row27 -1.15416  1.02264  1.27659  1.52807 -0.991541  0.19597
# row28 -1.81988  1.76854  0.62423 -0.97138 -0.985456  0.23347
# row29 -1.24848  0.95770  2.03325 -0.42915 -0.178500  0.36968
# row30  0.04807 -0.27432  2.57778  0.94986  0.168157 -0.63271
# row31 -2.02962  1.27457  1.65792 -1.35224 -1.385898  0.72262
# row32 -1.63477  1.45912  1.31902  0.01191 -1.119767 -0.09740
# row33  2.19010 -1.77132  2.70712  2.80572  1.472232  1.57457
# row34 -0.70579 -0.33164 -1.58026  0.20400 -0.004665  0.29657
# row35  1.04226 -1.04553  1.28258 -2.93952  0.891599  1.59110
# row36 -0.24580  0.33537  0.20757  0.86410 -0.613359 -0.86862
# row37  1.80524 -0.86288  3.10678  0.25943  1.728963  0.17964
# row38  1.58300 -0.34007  1.97606  2.96347  1.611076  0.46335
# row39 -0.09144 -0.07681  0.85924  0.24566  0.513561 -0.46108
# row40 -1.78985  1.93581  1.53565 -3.18980 -0.793886  0.41675
# row41 -1.07757  0.89626  0.87304 -2.30576 -1.144047  0.34944
# row42  0.05634  0.25144  1.60999 -3.72113 -1.473030  0.94374
# row43  4.60812 -3.75331  0.02626 -2.02331  0.848974  3.03899
# row44 -0.32560  1.02946  2.16737 -1.36530 -0.860815  0.18159
# row45  1.36732  0.37688 -1.15287 -0.82898  0.130912 -0.69038
# row46  3.61064 -2.48051  1.71468 -3.60901  0.411835  1.75299
# row47  0.52424 -1.97821 -0.52918  3.24262 -0.403173 -0.47442
# row48  1.44768 -1.93629  0.58613 -0.62902  0.457262  0.73028
# row49 -0.87013  0.91452  1.27851 -6.00326 -0.270502 -0.18398
# row50  3.55464 -1.15627  2.17917 -3.33593  0.594390  1.18105
# row51  0.62212 -0.31685 -0.78749 -5.23475 -0.553814  0.98353
# row52 -2.59508  2.38015  1.93213 -1.47646 -1.789194 -0.13105
# row53  1.25223 -2.71636  0.92035 -1.76186  0.598796  1.98924
# row54 -0.35766 -0.12394  1.67606 -3.44166 -0.546626  1.06682
# 
# 
# Site constraints (linear combinations of constraining variables)
# 
# CCA1     CCA2     CCA3      CCA4       CA1      CA2
# row1  -1.28560 -1.48059 -1.34412  0.269284 -1.262602 -0.37995
# row2   0.27802  0.45589 -0.28501 -0.359151 -0.603262 -0.59487
# row3  -0.08868  1.78089 -1.39025 -1.210487  1.625336 -0.96820
# row4   0.08314  1.18082 -0.68584 -0.951436 -0.861961 -0.61658
# row5  -1.35345 -0.55207 -1.22304  0.091880 -1.473702 -0.20440
# row6  -1.33870 -1.56932 -1.44045 -0.070423  0.034487 -0.68615
# row7  -1.79010  0.87163 -1.52522  0.329411 -0.525898  0.33797
# row8  -0.27131 -2.14100  0.32288  0.758091 -0.573924 -0.61638
# row9  -1.46052 -1.43674 -2.11141  1.000362  1.087900 -0.16697
# row10 -0.58924 -1.40214  0.13862 -0.261989  1.897917  0.22557
# row11 -0.06952 -0.71813  1.17232  0.599714 -0.200123 -0.48266
# row12  0.89587  0.49114 -0.13356  0.105776  1.038639 -1.54660
# row13  0.00196  1.92938 -1.63352  0.515869 -0.365230  0.33685
# row14 -0.05845  1.95173 -1.66155 -0.190689  1.411092 -0.04348
# row15  1.28784  0.21040  0.63731  0.219965  1.484548 -2.43141
# row16 -0.80771 -0.70041  0.21615 -1.117884 -0.060980  0.12428
# row17  0.97687  0.28720 -0.11610  0.930547  0.665615 -2.05600
# row18  0.83102  0.84889 -0.32365 -0.138074 -0.540777 -1.26355
# row19  0.51759  0.85207 -0.43357  0.216019  1.638492 -1.78949
# row20  0.86903  0.46246  0.06323 -0.351474 -2.254365 -0.47403
# row21 -0.54668 -0.77439  0.64361 -0.758548 -0.312895 -0.14160
# row22 -0.23724 -1.67533  0.79827  0.024370 -0.322514 -1.21012
# row23  0.10546  0.23807  1.03127  1.143959  1.104483  0.08359
# row24 -0.29622  0.66959  0.88855  0.099092  0.959425 -0.67399
# row25  2.31370  0.28294 -1.43636 -0.225319 -0.640090 -0.63413
# row26 -0.20087  0.67629  1.08600  0.694631  0.957358 -0.43645
# row27 -0.48926  0.82140  0.45717  0.996994 -0.991541  0.19597
# row28 -0.75245  1.60749  0.11120  0.678639 -0.985456  0.23347
# row29 -0.59601  1.17305  0.59134  0.326466 -0.178500  0.36968
# row30  0.12925 -0.13465  1.69757 -0.497126  0.168157 -0.63271
# row31 -0.28680  0.73428  1.05819 -0.020296 -1.385898  0.72262
# row32  0.08219  0.62111  1.23242  1.298523 -1.119767 -0.09740
# row33 -0.39317 -0.20936  1.03244 -0.128664  1.472232  1.57457
# row34 -1.46282 -0.98926 -1.51591  0.150967 -0.004665  0.29657
# row35 -0.78891  0.24392  0.45523  0.199016  0.891599  1.59110
# row36  1.13078 -1.90275 -0.27235  0.017517 -0.613359 -0.86862
# row37 -0.97321 -0.05840  0.04299 -0.252391  1.728963  0.17964
# row38 -0.69001  0.78480  0.53605  0.099207  1.611076  0.46335
# row39 -0.88575 -0.65096 -0.01275 -0.429710  0.513561 -0.46108
# row40 -1.16872  1.93736 -0.40773 -0.048416 -0.793886  0.41675
# row41  0.16277  0.18483  1.48473  0.876569 -1.144047  0.34944
# row42  1.82612 -0.13877 -1.14354 -0.317454 -1.473030  0.94374
# row43  1.80888  0.01169 -1.05369 -0.034843  0.848974  3.03899
# row44  0.26508 -0.07657  1.36219  1.694458 -0.860815  0.18159
# row45  1.34904 -0.25020  0.70546  0.325007  0.130912 -0.69038
# row46  2.64386 -0.64645 -0.07049 -0.708518  0.411835  1.75299
# row47  0.85197 -1.54873 -1.05234 -0.005296 -0.403173 -0.47442
# row48  0.10230 -0.39168  1.48257  0.940834  0.457262  0.73028
# row49 -0.87222  0.03179  1.67264 -5.697989 -0.270502 -0.18398
# row50  1.80990 -1.03973 -0.11850 -0.224161  0.594390  1.18105
# row51  0.77762 -0.09587 -1.01930 -1.209345 -0.553814  0.98353
# row52 -0.47105  0.48861  0.91648 -0.470334 -1.789194 -0.13105
# row53 -0.67033 -0.65101  0.13834  0.403166  0.598796  1.98924
# row54 -0.42790  0.52413  0.59015  0.738567 -0.546626  1.06682
# 
# 
# Biplot scores for constraining variables
#  
#               CCA1       CCA2     CCA3      CCA4 CA1 CA2
# FL        -0.2846 -0.1924883  0.04588 -0.937990   0   0
# W         -0.5369 -0.7920724 -0.29042  0.007123   0   0
# Sex        0.8862  0.2131917 -0.39260 -0.122671   0   0
# Spine.Age -0.8189 -0.0006762 -0.57233 -0.042437   0   0


CCA_met184
# Call: cca(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data =
#             FactorsT4)
# 
#                Inertia Proportion Rank
# Total         0.15710    1.00000     
# Constrained   0.01896    0.12070    4
# Unconstrained 0.13814    0.87930   49
# Inertia is scaled Chi-square 
# 
# Eigenvalues for constrained axes:
#   CCA1     CCA2     CCA3     CCA4 
# 0.009446 0.005622 0.002398 0.001497 
# 
# Eigenvalues for unconstrained axes:
#   CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8 
# 0.04086 0.02603 0.00960 0.00826 0.00673 0.00565 0.00520 0.00494 
# (Showing 8 of 49 unconstrained eigenvalues)

anova(CCA_met184)
# Permutation test for cca under reduced model
# Permutation: free
# Number of permutations: 999
# 
# Model: cca(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data = FactorsT4)
#            Df  ChiSquare      F Pr(>F)  
#   Model     4  0.018963 1.6816  0.018 *
#   Residual 49  0.138141                
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

anova(CCA_met184, by="term", permutations=199)
# Permutation test for cca under reduced model
# Terms added sequentially (first to last)
# Permutation: free
# Number of permutations: 199
# 
# Model: cca(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data = FactorsT4)
# Df ChiSquare      F Pr(>F)  
# FL         1  0.002295 0.8142  0.540  
# W          1  0.005824 2.0659  0.045 *
#   Sex        1  0.006037 2.1415  0.035 *
#   Spine.Age  1  0.004806 1.7046  0.085 .
# Residual  49  0.138141                
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

anova(CCA_met184, by="mar", permutations=199)
# Permutation test for cca under reduced model
# Marginal effects of terms
# Permutation: free
# Number of permutations: 199
# 
# Model: cca(formula = Metabolites18T ~ FL + W + Sex + Spine.Age, data = FactorsT4)
# Df ChiSquare      F Pr(>F)  
# FL         1  0.001551 0.5500  0.790  
# W          1  0.005467 1.9391  0.045 *
#   Sex        1  0.004654 1.6508  0.100 .
# Spine.Age  1  0.004806 1.7046  0.080 .
# Residual  49  0.138141                
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

plot(CCA_met184, scaling=0)
plot(CCA_met184, scaling=1)
plot(CCA_met184, scaling=2)
plot(CCA_met184, scaling=3)
plot(CCA_met184, scaling=3, points(scrs$sites),
      with(scrs, text(species, labels = rownames(species),
                     col = "darkcyan", cex = 0.8)))
 # didnt work
plot(CCA_met184, scaling=3, type="t") # yeah
#plot with all variables is pixelate dtho
plot(CCA_met184, type="n")
text(CCA_met184,display="cn")
points(CCA_met184,col="red")
text(CCA_met184, "species",  cex=0.7, col="blue")


# trying to unpixelate
plot(CCA_met184, type="n")
text(CCA_met184,display="cn")
points(CCA_met184,col="red")
text(CCA_met184, "species",  cex=0.7, col="blue")

# trying ploting
with(FactorsT4, levels(Spine.Age))
str(CCA_met184, max=1)

scrs<- scores(CCA_met184, display =  c("sites", "species"))

xlim<- with(scrs, range(species[,1], sites[,1]))
ylim<- with(scrs, range(species[,1], sites[,1]))

plot.new()
plot.window(xlim =xlim, ylim = ylim, asp= 1)

abline(h=0, lty = "dotted")
abline(v=0, lty = "dotted")


with(FactorsT4, points(scrs$sites))#, col = colvec[Use],
                     # pch = 21, bg = colvec[Use]))
with(scrs, text(species, labels = rownames(species),
                col = "darkcyan", cex = 0.8))
with(FactorsT4, legend("topright"), legend= default)
axis(side = 1)
axis(side = 2)
title(xlab = "CCA 2", ylab = "CCA 1")
box()

#### Biogenic Amines Linear Models ####
#### Spermine, Spermidine & Putrescine ####
# linear model versus age
bio_lm <- glm(Spine.Age ~ Spermine + Spermidine + Putrescine, 
              data = Data_2018, family = "gaussian")
summary(bio_lm)
# Call:
#   glm(formula = Spine.Age ~ Spermine + Spermidine + Putrescine, 
#       family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  7.932816   1.726525   4.595 2.96e-05 ***
#   Spermine    -0.005353   0.046018  -0.116   0.9079    
# Spermidine  -0.191022   0.095837  -1.993   0.0517 .  
# Putrescine   0.140257   0.074318   1.887   0.0649 .  
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 8.950572)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 447.53  on 50  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 277.44
# 
# Number of Fisher Scoring iterations: 2
check_model(bio_lm)              

forest_model(bio_lm)

#### Linear model only spermidine ####

# linear model versus age
spermidine_lm <- glm(Spine.Age ~ Spermidine, 
              data = Data_2018, family = "gaussian")
summary(spermidine_lm)
# Call:
#   glm(formula = Spine.Age ~ Spermidine, family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  8.76183    0.76258  11.490 6.93e-16 ***
#   Spermidine  -0.06856    0.04152  -1.651    0.105    
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 9.232341)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 480.08  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 277.23
# 
# Number of Fisher Scoring iterations: 2

#### Linear model age vs spermidine & putrescine ####
# linear model versus age
spermidine_putrescine_lm <- glm(Spine.Age ~ Spermidine + Putrescine, 
              data = Data_2018, family = "gaussian")
summary(spermidine_putrescine_lm)

# Call:
#   glm(formula = Spine.Age ~ Spermidine + Putrescine, family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  7.76258    0.90725   8.556 1.98e-11 ***
#   Spermidine  -0.19733    0.07827  -2.521   0.0149 *  
#   Putrescine   0.14098    0.07334   1.922   0.0602 .  
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 8.777445)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 447.65  on 51  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 275.46
# 
# Number of Fisher Scoring iterations: 2

check_model(spermidine_putrescine_lm)              

forest_model(spermidine_putrescine_lm)


#### Amino acids linear models ####

#### Essential ####

#### branched chained iso, leu, val ####

# linear model versus age
iso_leu_val_lm <- glm(Spine.Age ~ Valine_Average 
                      + Leucine + Isoleucine_Average, 
                     data = Data_2018, family = "gaussian")
summary(iso_leu_val_lm)
# Call:
#   glm(formula = Spine.Age ~ Valine_Average + Leucine + Isoleucine_Average, 
#       family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)         7.183180   0.763117   9.413 1.18e-12 ***
#   Valine_Average     -0.011262   0.011541  -0.976   0.3339    
# Leucine             0.015010   0.006059   2.477   0.0167 *  
#   Isoleucine_Average  0.005768   0.017935   0.322   0.7491    
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 8.998823)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 449.94  on 50  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 277.73
# 
# Number of Fisher Scoring iterations: 2
check_model(iso_leu_val_lm)              

forest_model(iso_leu_val_lm)

#### linear model only leucine ####

leu_lm <- glm(Spine.Age ~ Leucine, 
              data = Data_2018, family = "gaussian")
summary(leu_lm)
# Call:
#   glm(formula = Spine.Age ~ Leucine, family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept) 6.669588   0.699064   9.541 5.14e-13 ***
#   Leucine     0.007999   0.004373   1.829   0.0731 .  
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 9.12915)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 474.72  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 276.63
# 
# Number of Fisher Scoring iterations: 2

cor.test(Data_2018$Spine.Age, Data_2018$Leucine)
# Pearson's product-moment correlation
# 
# data:  Data_2018$Spine.Age and Data_2018$Leucine
# t = 1.8291, df = 52, p-value = 0.07312
# alternative hypothesis: true correlation is not equal to 0
# 95 percent confidence interval:
#  -0.02343531  0.48190313
# sample estimates:
#       cor 
# 0.2458681 

#### rest of essentials ####
#### linear models his, lys, met, phe, thr, trp ####

# linear model versus age
his_lys_met_phe_thr_trp_lm <- glm(Spine.Age ~ Histidine_Average
                                  + Lysine + Methionine + Phenylalanine_Average
                                  + Threonine_Average + Tryptophan, 
                     data = Data_2018, family = "gaussian")
summary(his_lys_met_phe_thr_trp_lm)
# Call:
#   glm(formula = Spine.Age ~ Histidine_Average + Lysine + Methionine + 
#         Phenylalanine_Average + Threonine_Average + Tryptophan, family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)            5.595475   1.018053   5.496 1.54e-06 ***
#   Histidine_Average     -0.043939   0.028275  -1.554   0.1269    
# Lysine                 0.027667   0.017368   1.593   0.1179    
# Methionine             0.010111   0.044589   0.227   0.8216    
# Phenylalanine_Average  0.054817   0.030246   1.812   0.0763 .  
# Threonine_Average      0.011868   0.009642   1.231   0.2245    
# Tryptophan            -0.094207   0.068921  -1.367   0.1782    
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 6.389124)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 300.29  on 47  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 261.9
# 
# Number of Fisher Scoring iterations: 2

check_model(his_lys_met_phe_thr_trp_lm)              

forest_model(his_lys_met_phe_thr_trp_lm)

#### linear model only phenylalanine ####

phe_lm <- glm(Spine.Age ~ Phenylalanine_Average, 
              data = Data_2018, family = "gaussian")
summary(phe_lm)
# Call:
#   glm(formula = Spine.Age ~ Phenylalanine_Average, family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)            4.59794    0.94895   4.845 1.18e-05 ***
#   Phenylalanine_Average  0.04667    0.01306   3.572 0.000774 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 7.802209)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 405.71  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 268.15
# 
# Number of Fisher Scoring iterations: 2

check_model(phe_lm)              

forest_model(phe_lm)

plot(Spine.Age ~ Phenylalanine_Average, data= Data_2018)
plot(Phenylalanine_Average ~Spine.Age, data= Data_2018)
cor.test(Data_2018$Spine.Age, Data_2018$Phenylalanine_Average)
# Pearson's product-moment correlation
# 
# data:  Data_2018$Spine.Age and Data_2018$Phenylalanine_Average
# t = 3.5719, df = 52, p-value = 0.0007739
# alternative hypothesis: true correlation is not equal to 0
# 95 percent confidence interval:
#  0.1998579 0.6360336

#### Conditional AAs ####
#### linear model arg glut gly pro tyr ####
# linear model versus age
arg_glut_gly_pro_tyr_lm <- glm(Spine.Age ~ Arginine_Average
                                  + Glutamine + Glycine_Average + Proline
                                  + Tyrosine_Average, 
                                  data = Data_2018, family = "gaussian")
summary(arg_glut_gly_pro_tyr_lm)
# Call:
#   glm(formula = Spine.Age ~ Arginine_Average + Glutamine + Glycine_Average + 
#         Proline + Tyrosine_Average, family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)       4.479556   1.013367   4.420 5.61e-05 ***
#   Arginine_Average  0.016706   0.011397   1.466 0.149239    
# Glutamine         0.029786   0.029950   0.995 0.324946    
# Glycine_Average   0.006039   0.003098   1.949 0.057099 .  
# Proline          -0.028225   0.007683  -3.674 0.000601 ***
#   Tyrosine_Average  0.012209   0.006953   1.756 0.085493 .  
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 5.158598)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 247.61  on 48  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 249.48
# 
# Number of Fisher Scoring iterations: 2

check_model(arg_glut_gly_pro_tyr_lm)  

#### Glycine linear model ####

# linear model versus age
gly_lm <- glm(Spine.Age ~ Glycine_Average, 
                               data = Data_2018, family = "gaussian")
summary(gly_lm)
# Call:
#   glm(formula = Spine.Age ~ Glycine_Average, family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)     3.553631   1.100835   3.228 0.002160 ** 
#   Glycine_Average 0.008942   0.002233   4.004 0.000199 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 7.426803)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 386.19  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 265.48
# 
# Number of Fisher Scoring iterations: 2
check_model(gly_lm)


#### Proline linear model ####

# linear model versus age
pro_lm <- glm(Spine.Age ~ Proline, 
              data = Data_2018, family = "gaussian")
summary(pro_lm)
#Call:
#   glm(formula = Spine.Age ~ Proline, family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  8.492115   0.680693  12.476   <2e-16 ***
#   Proline     -0.011276   0.007709  -1.463     0.15    
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 9.332527)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 485.29  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 277.82
# 
# Number of Fisher Scoring iterations: 2
check_model(pro_lm)

# linear model versus age natural log
proln_lm <- glm(Spine.Age ~ log(Proline), 
              data = Data_2018, family = "gaussian") # not significant
summary(proln_lm)
check_model(proln_lm)

#### Tyrosine linear model ####

# linear model versus age
tyr_lm <- glm(Spine.Age ~ Tyrosine_Average, 
              data = Data_2018, family = "gaussian")
summary(tyr_lm)

check_model(tyr_lm)

# Call:
#   glm(formula = Spine.Age ~ Tyrosine_Average, family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)      6.490472   0.583977  11.114 2.39e-15 ***
#   Tyrosine_Average 0.020481   0.007261   2.821  0.00676 ** 
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 8.426961)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 438.20  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 272.3
# 
# Number of Fisher Scoring iterations: 2

# linear model versus  lon
tyrln_lm <- glm(Spine.Age ~ log(Tyrosine_Average), 
              data = Data_2018, family = "gaussian")
summary(tyrln_lm)
# Call:
#   glm(formula = Spine.Age ~ log(Tyrosine_Average), family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)   
# (Intercept)            -0.9254     2.5086  -0.369  0.71372   
# log(Tyrosine_Average)   2.2298     0.6407   3.480  0.00102 **
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 7.880742)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 409.80  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 268.69
# 
# Number of Fisher Scoring iterations: 2
check_model(tyrln_lm)
 # better


#### non essential amino acids ####
#### linear model ala aspn asp glut ser ####
# linear model versus  lon
ala_apn_asp_glu_lm <- glm(Spine.Age ~ Alanine + Asparagine + Aspartate + Glutamate_Average, 
                data = Data_2018, family = "gaussian")
summary(ala_apn_asp_glu_lm)
# Call:
#   glm(formula = Spine.Age ~ Alanine + Asparagine + Aspartate + 
#         Glutamate_Average, family = "gaussian", data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)        4.1337595  0.9909565   4.171 0.000123 ***
#   Alanine           -0.0002525  0.0028899  -0.087 0.930741    
# Asparagine        -0.0748388  0.0201091  -3.722 0.000511 ***
#   Aspartate          0.0374811  0.0529044   0.708 0.482011    
# Glutamate_Average  0.0455461  0.0092741   4.911 1.05e-05 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 6.147836)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 301.24  on 49  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 258.07
# 
# Number of Fisher Scoring iterations: 2

check_model(ala_apn_asp_glu_lm)
forest_model(ala_apn_asp_glu_lm)


# linear model versus  lon
glutm_lm <- glm(Spine.Age ~ Glutamate_Average, 
                          data = Data_2018, family = "gaussian")
summary(glutm_lm)
# Call:
#   glm(formula = Spine.Age ~ Glutamate_Average, family = "gaussian", 
#       data = Data_2018)
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)       4.760954   0.948968   5.017 6.49e-06 ***
#   Glutamate_Average 0.031816   0.009383   3.391  0.00134 ** 
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for gaussian family taken to be 7.957147)
# 
# Null deviance: 505.26  on 53  degrees of freedom
# Residual deviance: 413.77  on 52  degrees of freedom
# (6 observations deleted due to missingness)
# AIC: 269.21
# 
# Number of Fisher Scoring iterations: 2

#### Cancor factominer amino acids ####
# reading data of amino acids
Amino_Acids18 <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Amino_Acids18.csv", quote="")
   View(Amino_Acids18)
str(Amino_Acids18)
dim(Amino_Acids18)
num_amino<- Amino_Acids18[,9:27]
factor_amino<- Amino_Acids18[,1:8]
library(FactoMineR)
library(factoextra)
AA.ca <- CA(Amino_Acids18, 
             row.sup = 15:18,  # Supplementary rows
             col.sup = 6:8,    # Supplementary columns
             graph = FALSE)
# another try
# Install and load the FactoMineR package
install.packages("FactoMineR")
library(FactoMineR)

# Generate sample data
set.seed(123)
data <- data.frame(
  X1 = rnorm(100),
  X2 = rnorm(100),
  X3 = rnorm(100),
  Y1 = rnorm(100),
  Y2 = rnorm(100)
)

# Perform canonical correlation analysis
cancor_result <- cancor(num_amino, factor_amino$Spine.Age)

# Summary of canonical correlations
summary(cancor_result)
# Length Class  Mode   
# cor       1    -none- numeric
# xcoef   361    -none- numeric
# ycoef     1    -none- numeric
# xcenter  19    -none- numeric
# ycenter   1    -none- numeric
cancor_result$cor
#[1] 0.8191136
# Canonical loadings for Y variables
cancor_result$cor.y

# Canonical coefficients for X variables
cancor_result$xcoef
#[,1]          [,2]          [,3]          [,4]
# Serine                -8.855798e-04  6.836656e-04  4.034046e-03 -1.236359e-03
# Asparagine             4.327983e-04  5.757311e-03  5.775242e-03 -5.526846e-03
# Glutamine              1.391110e-03 -2.593404e-04 -1.693521e-02 -8.064533e-04
# Tryptophan             7.247519e-03 -1.351133e-03 -7.116755e-05  2.167737e-02
# Lysine                 2.173915e-04 -4.052763e-05 -2.134692e-06  1.039134e-05
# Arginine_Average      -7.832878e-04  1.460260e-04  7.691553e-06 -3.744124e-05
# Glutamate_Average     -3.249601e-04  6.058132e-05  3.190970e-06 -1.553313e-05
# Glycine_Average       -1.864387e-04  3.475719e-05  1.830748e-06 -8.911788e-06
# Histidine_Average      3.819441e-04 -7.120467e-05 -3.750528e-06  1.825697e-05
# Isoleucine_Average     2.392521e-04 -4.460304e-05 -2.349354e-06  1.143628e-05
# Leucine                5.606616e-04 -1.045224e-04 -5.505458e-06  2.679968e-05
# Methionine             4.878769e-04 -9.095340e-05 -4.790743e-06  2.332057e-05
# Phenylalanine_Average -2.994478e-03  5.582515e-04  2.940450e-05 -1.431364e-04
# Proline                2.717484e-03 -5.066123e-04 -2.668454e-05  1.298960e-04
# Threonine_Average     -6.991158e-05  1.303340e-05  6.865020e-07 -3.341781e-06
# Tyrosine_Average      -3.656333e-04  6.816390e-05  3.590363e-06 -1.747731e-05
# Valine_Average        -1.202252e-03  2.241321e-04  1.180560e-05 -5.746776e-05
# Alanine               -3.854077e-05  7.185038e-06  3.784539e-07 -1.842253e-06
# Aspartate             -4.479217e-03  8.350469e-04  4.398401e-05 -2.141071e-04
# [,5]          [,6]          [,7]          [,8]
# Serine                 3.266578e-03 -2.050983e-03 -1.486415e-03 -1.710626e-03
# Asparagine            -2.316787e-03  3.141740e-03 -1.499510e-03  7.995848e-04
# Glutamine              8.849942e-04 -1.825454e-03 -3.972293e-03 -1.589338e-03
# Tryptophan            -3.106497e-03 -4.242382e-03 -1.854748e-03 -8.058796e-03
# Lysine                -7.786173e-03 -4.949694e-03 -6.166278e-04 -1.048330e-03
# Arginine_Average       3.975578e-06  7.829218e-03 -4.286372e-04 -4.130123e-04
# Glutamate_Average      1.649335e-06 -3.665537e-07  5.080807e-03 -1.138227e-03
# Glycine_Average        9.462696e-07 -2.103021e-07 -2.579529e-05  1.483229e-03
# Histidine_Average     -1.938557e-06  4.308313e-07  5.284504e-05  1.748945e-05
# Isoleucine_Average    -1.214324e-06  2.698754e-07  3.310246e-05  1.095550e-05
# Leucine               -2.845638e-06  6.324240e-07  7.757206e-05  2.567303e-05
# Methionine            -2.476219e-06  5.503231e-07  6.750170e-05  2.234017e-05
# Phenylalanine_Average  1.519848e-05 -3.377759e-06 -4.143103e-04 -1.371190e-04
# Proline               -1.379259e-05  3.065311e-06  3.759858e-04  1.244352e-04
# Threonine_Average      3.548363e-07 -7.885998e-08 -9.672832e-06 -3.201293e-06
# Tyrosine_Average       1.855772e-06 -4.124328e-07 -5.058832e-05 -1.674257e-05
# Valine_Average         6.102029e-06 -1.356135e-06 -1.663412e-04 -5.505182e-05
# Alanine                1.956137e-07 -4.347383e-08 -5.332426e-06 -1.764805e-06
# Aspartate              2.273427e-05 -5.052539e-06 -6.197359e-04 -2.051060e-04
# [,9]         [,10]         [,11]         [,12]
# Serine                 1.673839e-03 -1.413092e-03 -2.992344e-03 -2.229212e-03
# Asparagine            -8.426117e-04 -2.746607e-03  5.408042e-04 -3.764451e-03
# Glutamine             -7.460644e-03  2.654346e-03 -2.160178e-03 -2.284634e-03
# Tryptophan            -7.301792e-03 -2.271235e-02  4.242711e-03 -4.856691e-03
# Lysine                 1.162858e-03 -2.416227e-03  3.555793e-03  3.403477e-03
# Arginine_Average      -3.981160e-03  2.514252e-03  4.132554e-03 -4.898538e-03
# Glutamate_Average      6.920706e-04 -4.912166e-04 -1.389039e-04 -3.879231e-04
# Glycine_Average        4.687146e-05  1.030655e-04  3.297643e-04  8.697380e-05
# Histidine_Average      1.100303e-02 -4.278899e-04 -6.501986e-04 -6.996397e-04
# Isoleucine_Average    -1.511248e-05  4.184381e-03  2.292784e-03  7.740413e-04
# Leucine               -3.541447e-05 -4.838530e-05 -2.867933e-03 -9.686200e-04
# Methionine            -3.081699e-05 -4.210395e-05 -1.390935e-05  2.092174e-02
# Phenylalanine_Average  1.891477e-04  2.584246e-04  8.537247e-05 -1.310754e-04
# Proline               -1.716512e-04 -2.345199e-04 -7.747537e-05  1.189507e-04
# Threonine_Average      4.416000e-06  6.033395e-06  1.993177e-06 -3.060195e-06
# Tyrosine_Average       2.309541e-05  3.155429e-05  1.042419e-05 -1.600463e-05
# Valine_Average         7.594084e-05  1.037548e-04  3.427615e-05 -5.262539e-05
# Alanine                2.434447e-06  3.326082e-06  1.098796e-06 -1.687020e-06
# Aspartate              2.829320e-04  3.865581e-04  1.277023e-04 -1.960659e-04
# [,13]         [,14]         [,15]         [,16]
# Serine                -1.225608e-03  1.080900e-03  1.900226e-04 -6.305231e-04
# Asparagine             7.879609e-05 -8.893880e-03  2.986244e-03  1.768159e-05
# Glutamine             -9.371157e-04  1.500495e-03  9.164046e-05 -4.413041e-03
# Tryptophan            -1.833819e-02  6.106442e-03 -1.971187e-03 -1.160469e-02
# Lysine                -2.279155e-03  1.834744e-03 -1.230858e-03  5.329640e-03
# Arginine_Average      -3.106956e-04 -1.470064e-03  2.942717e-03  9.166776e-04
# Glutamate_Average     -6.898692e-04  3.945312e-04 -1.490468e-03 -2.223314e-03
# Glycine_Average       -2.276400e-04 -1.255171e-04  6.201637e-04  1.408555e-04
# Histidine_Average      1.339902e-03 -1.998221e-04  5.230628e-03  4.714980e-03
# Isoleucine_Average    -3.964285e-05 -2.472764e-03  9.802233e-04  7.837330e-04
# Leucine                4.171810e-04 -1.388216e-04 -8.466674e-04 -3.682521e-03
# Methionine            -7.925249e-03  3.823364e-06  3.372413e-03 -1.310801e-03
# Phenylalanine_Average  1.312750e-02 -2.072291e-03 -2.017470e-04 -2.818342e-03
# Proline                1.727151e-04  5.872360e-03 -1.165860e-03  3.526472e-03
# Threonine_Average     -4.443370e-06  1.332036e-05 -4.453320e-03 -3.630550e-04
# Tyrosine_Average      -2.323855e-05  6.966467e-05  2.260402e-05  6.749811e-03
# Valine_Average        -7.641150e-05  2.290669e-04  7.432509e-05 -6.324218e-05
# Alanine               -2.449535e-06  7.343231e-06  2.382651e-06 -2.027364e-06
# Aspartate             -2.846856e-04  8.534321e-04  2.769122e-04 -2.356208e-04
# [,17]         [,18]         [,19]
# Serine                -5.469888e-04  1.968351e-03 -0.0018072646
# Asparagine            -3.479302e-03 -5.713533e-03 -0.0018816678
# Glutamine              1.685583e-03  4.599950e-03  0.0030360909
# Tryptophan            -2.694638e-02 -3.963453e-03 -0.0064016069
# Lysine                -1.453147e-03 -5.104154e-04  0.0008621998
# Arginine_Average       4.317362e-04 -2.012257e-03  0.0054594379
# Glutamate_Average     -1.227959e-03  2.731515e-04 -0.0023684743
# Glycine_Average        4.396125e-05 -1.621769e-04  0.0005770208
# Histidine_Average      5.571720e-04 -8.625690e-06  0.0043488062
# Isoleucine_Average    -5.135382e-03 -1.872980e-03  0.0029145364
# Leucine               -1.142421e-03 -2.644456e-04 -0.0014823883
# Methionine             5.057628e-03  8.694562e-04 -0.0096564585
# Phenylalanine_Average  3.394693e-03 -1.432014e-03  0.0001589290
# Proline               -2.513044e-03  4.412996e-03 -0.0008710108
# Threonine_Average      1.221224e-04  4.104107e-04 -0.0024340800
# Tyrosine_Average      -2.912286e-03  1.346933e-03  0.0022072747
# Valine_Average         7.205996e-03  1.415790e-05 -0.0006191544
# Alanine               -3.829468e-06 -1.395110e-03 -0.0004449174
# Aspartate             -4.450617e-04  1.940390e-04  0.0288149552
# Canonical coefficients for Y variables
cancor_result$ycoef
# [,1]
# [1,] -0.044488
plot(cancor_result, choix = "ind", habillage = 1)

#### correlation analysis ####
# Generate example data
set.seed(123)
continuous_var <- rnorm(100)  # One continuous variable
other_continuous_vars <- matrix(rnorm(100*20), ncol = 20)  # 20 other continuous variables

#### Compute correlations ####
correlations <- cor(Amino_Acids18$Spine.Age, num_amino)

# Print correlations
print(correlations)
#      Serine     Asparagine Glutamine Tryptophan    Lysine Arginine_Average
# [1,] 0.6193454 -0.2720322  0.325698 0.06018503 0.5335207        0.5717329
#       Glutamate_Average Glycine_Average Histidine_Average Isoleucine_Average
# [1,]          0.425524       0.4854403           0.16368         0.01377828
#       Leucine Methionine Phenylalanine_Average    Proline Threonine_Average
# [1,] 0.2458681  0.4148477             0.4438654 -0.1987963         0.3349239
#      Tyrosine_Average Valine_Average   Alanine   Aspartate
# [1,]        0.3643056      0.0133911 0.1418183 -0.08054285

# Load the car package
library(car)

#### Amino Acids Perform MANCOVA ####
manova_result <- manova(cbind(Amino_Acids18$Serine, Amino_Acids18$Asparagine, 
                              Amino_Acids18$Glutamine, Amino_Acids18$Tryptophan,
                              Amino_Acids18$Lysine, Amino_Acids18$Arginine_Average,
                              Amino_Acids18$Glutamate_Average, Amino_Acids18$Glycine_Average,
                              Amino_Acids18$Histidine_Average, Amino_Acids18$Isoleucine_Average,
                              Amino_Acids18$Leucine, Amino_Acids18$Methionine,
                              Amino_Acids18$Phenylalanine_Average, Amino_Acids18$Proline,
                              Amino_Acids18$Threonine_Average, Amino_Acids18$Tyrosine_Average,
                              Amino_Acids18$Alanine, Amino_Acids18$Aspartate)  ~ Amino_Acids18$Spine.Age + Amino_Acids18$Site)
# Summarize MANOVA results
summary(manova_result)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Amino_Acids18$Spine.Age  1 0.73598   4.9557     18     32 4.219e-05 ***
#   Amino_Acids18$Site       3 1.95045   3.5102     54    102 2.371e-08 ***
#   Residuals               49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

# Extract coefficients
coefficients <- coef(manova_result)
coefficients
#                                [,1]        [,2]       [,3]        [,4]
# (Intercept)                  29.841298  43.9359791  13.676394  25.3730246
# Amino_Acids18$Spine.Age       9.900848  -0.4852388   2.0 how c h57201   0.7253119
# Amino_Acids18$SiteMatheson  -17.001300 -31.5653672 -16.329708 -17.0001449
# Amino_Acids18$SiteRed River   9.963954 -39.2907025  -9.461043 -14.4296647
# Amino_Acids18$SiteSandy Bar   6.619717 -37.8449426 -15.382178 -17.7484373
#                                 [,5]      [,6]       [,7]       [,8]       [,9]
# (Intercept)                 -21.576714  2.893556  67.579769  319.90031  49.087087
# Amino_Acids18$Spine.Age       4.883039  6.832202   6.864115   29.30521   1.185197
# Amino_Acids18$SiteMatheson    8.540807  9.455624 -46.897477 -158.26133  -7.347302
# Amino_Acids18$SiteRed River  13.343075 12.666121 -30.570170  -74.67669  -8.972630
# Amino_Acids18$SiteSandy Bar  32.089120 18.554266 -38.679427 -101.17952 -23.227843
#                                [,10]     [,11]      [,12]      [,13]       [,14]
# (Intercept)                  134.185205  83.96989  18.103429  50.702541 129.1906485
# Amino_Acids18$Spine.Age        5.007468  12.00304   2.674064   5.195651   0.3650292
# Amino_Acids18$SiteMatheson  -104.339784 -72.10467 -16.254398 -42.409999 -80.9847114
# Amino_Acids18$SiteRed River -108.531396 -83.48307 -10.819171 -25.173584 -92.4239267
# Amino_Acids18$SiteSandy Bar  -92.300267 -23.67351 -12.758299 -32.412439 -83.4908431
#                                 [,15]      [,16]      [,17]       [,18]
# (Intercept)                  79.969730  33.379121 244.012647  19.7420823
# Amino_Acids18$Spine.Age       7.450964   7.827507   5.082214   0.2301975
# Amino_Acids18$SiteMatheson   -2.748978 -55.682178 -13.992728  -8.2863029
# Amino_Acids18$SiteRed River -34.027250 -37.381356   4.670250 -13.0809655
# Amino_Acids18$SiteSandy Bar -49.796988 -51.555836 -51.116293 -15.1656214
# Plot the relationship between X and each dependent variable while controlling for C
for (i in 1:18) {
  # Extract coefficients for the ith dependent variable
  coeffs <- coefficients[, i]
  
  # Plot the relationship
  ggplot(data = data.frame(X, Y = coeffs[1] + coeffs[2] * as.numeric(X) 
                           + coeffs[3] * C),
         aes(x = as.numeric(X), y = Y)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE) +
    labs(x = "X", y = paste0("Y", i)) +
    ggtitle(paste0("Effect of X on Y", i))
}

# trying to plot
# Load necessary packages
library(tidyr)
library(dplyr)

# Reshape your data to long format
Amino_Acids18_long <- Amino_Acids18 %>%
  pivot_longer(cols = c(Serine, Asparagine, Glutamine, Tryptophan, Lysine, Arginine_Average,
                        Glutamate_Average, Glycine_Average, Histidine_Average, Isoleucine_Average,
                        Leucine, Methionine, Phenylalanine_Average, Proline, Threonine_Average,
                        Tyrosine_Average, Alanine, Aspartate),
               names_to = "Amino_Acid",
               values_to = "Concentration")

# Plot using ggplot2
library(ggplot2)

ggplot(data = Amino_Acids18_long, aes(x = Spine.Age, y = Concentration, color = Site)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~Amino_Acid, scales = "free_y") +
  labs(title = "Relationship between Spine Age, Site, and Amino Acid Concentration")
#### trying plot MANOVA ####

# Load necessary libraries
library(ggplot2)
library(GGally)

# Select only the dependent variables from your data
dep_vars <- Amino_Acids18[, c("Serine", "Asparagine", "Glutamine", "Tryptophan",
                              "Lysine", "Arginine_Average", "Glutamate_Average", 
                              "Glycine_Average", "Histidine_Average", "Isoleucine_Average",
                              "Leucine", "Methionine", "Phenylalanine_Average", 
                              "Proline", "Threonine_Average", "Tyrosine_Average",
                              "Alanine", "Aspartate")]

# Create a scatterplot matrix
ggpairs(dep_vars)

# Add a factor (e.g., 'Site') as a different color
ggpairs(dep_vars, mapping = ggplot2::aes(color = Amino_Acids18$Site))

# Create a scatterplot matrix with smaller text
ggpairs(dep_vars, mapping = ggplot2::aes(color = Amino_Acids18$Site)) +
  theme(text = element_text(size = 8))  # Adjust size as needed

# separate graphs versus age
# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Create a list to store plots
plots_list <- list()

# Loop through each amino acid
for (amino_acid in colnames(dep_vars)) {
  # Create a scatterplot for each amino acid vs. Spine.Age
  p <- ggplot(Amino_Acids18, aes_string(x = "Spine.Age", y = amino_acid)) +
    geom_point() +
    labs(x = "Spine Age", y = amino_acid) +
    theme(text = element_text(size = 8))  # Adjust text size as needed
  
  # Add the plot to the list
  plots_list[[amino_acid]] <- p
}

# Arrange the plots in a grid
grid.arrange(grobs = plots_list, ncol = 3)

# In this example, aes_string() is used 
#to specify the x and y variables 
#in the ggplot() call. 
#This allows you to loop through 
#each amino acid and create 
#a scatterplot for each one.
# 
# The grid.arrange() function 
#from the gridExtra library 
#is then used to arrange all the scatterplots 
#in a grid, with 3 plots per row. 
#You can adjust the ncol argument 
#as needed to change the number of plots 
#per row

#### PCA Amino Acids ####      
#### load packages ####

library(tidyverse)
library(corrplot)
library(FactoMineR)
library(factoextra)
library(sjstats)
library(performance)
library(forestmodel)
library(emmeans)
library(pwr)
# as data.frame
AA_data.frame <- data.frame(Amino_Acids18)
names(AA_data.frame)
dim(AA_data.frame)
# 54 27

# dataframe with just met data columns
AA_data_pca <- AA_data.frame[, c(9:27)] %>%
  print()

dim(AA_data_pca) 
#54 20
#### Correlations plot AAs ####

AA_cor <- cor(AA_data_pca)

summary(AA_cor)

corrplot(AA_cor, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 60, 
         tl.cex = 1, cl.cex = 1)
#dev.off()
library(corrplot)

#### PCA AAs ####

# PCA with FactoMineR package

AA_pca_FM <- PCA(AA_data_pca, graph = FALSE)


#### Eigenvalues / Variances AAs   ####

# extract eigenvalues/varianes
get_eig(AA_pca_FM)
# eigenvalue variance.percent cumulative.variance.percent
# Dim.1  9.78439685       48.9219843                    48.92198
# Dim.2  3.87964687       19.3982344                    68.32022
# Dim.3  1.55198625        7.7599313                    76.08015
# Dim.4  0.97695765        4.8847883                    80.96494
# Dim.5  0.70445330        3.5222665                    84.48720
# Dim.6  0.63483362        3.1741681                    87.66137
# Dim.7  0.48732103        2.4366052                    90.09798
# Dim.8  0.40485900        2.0242950                    92.12227
# Dim.9  0.29732012        1.4866006                    93.60887
# Dim.10 0.27108970        1.3554485                    94.96432
# Dim.11 0.23655148        1.1827574                    96.14708
# Dim.12 0.18331540        0.9165770                    97.06366
# Dim.13 0.14662609        0.7331304                    97.79679
# Dim.14 0.12998310        0.6499155                    98.44670
# Dim.15 0.08666878        0.4333439                    98.88005
# Dim.16 0.07311227        0.3655614                    99.24561
# Dim.17 0.06886092        0.3443046                    99.58991
# Dim.18 0.03768843        0.1884421                    99.77835
# Dim.19 0.02784165        0.1392083                    99.91756
# Dim.20 0.01648746        0.0824373                   100.00000

corrplot(AA_cor, type = "upper", order = "hclust", 
         +          tl.col = "black", tl.srt = 60, 
         +          tl.cex = 1, cl.cex = 1)
AA_pca_FM <- PCA(AA_data_pca, graph = FALSE)
# extract eigenvalues/varianes
get_eig(AA_pca_FM)

fviz_screeplot(AA_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = Inf
)
fviz_screeplot(AA_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = 16
)

# extract the results for variables
var <- get_pca_var(AA_pca_FM)
var
# Principal Component Analysis Results for variables
#   Name       Description                                    
# 1 "$coord"   "Coordinates for the variables"                
# 2 "$cor"     "Correlations between variables and dimensions"
# 3 "$cos2"    "Cos2 for the variables"                       
# 4 "$contrib" "contributions of the variables"
var$coord  # coordinates of variables
# Dim.1       Dim.2        Dim.3        Dim.4        Dim.5
# Serine                0.7230922  0.55670020  0.145408849  0.061686837 -0.183945501
# Asparagine            0.5311752 -0.73223312  0.147563364 -0.117507759 -0.117460358
# Glutamine             0.8433966  0.09679767  0.282074923 -0.066800589 -0.227214762
# Tryptophan            0.7969608 -0.43581061 -0.198918811 -0.113309981 -0.008525766
# Lysine                0.4295974  0.77855332 -0.113669025  0.079232490 -0.058799775
# Arginine_Average      0.5685023  0.76207187 -0.007751513 -0.036789496  0.132302017
# Glutamate_Average     0.7723778  0.08686899  0.087922019  0.207271652 -0.357570572
# Glycine_Average       0.8083054  0.29095979 -0.014021850  0.021789435 -0.172926795
# Histidine_Average     0.7366175  0.09415033  0.157220141 -0.466144847  0.191315193
# Isoleucine_Average    0.7725156 -0.44012375 -0.257686120 -0.020714158 -0.127952426
# Leucine               0.7413415  0.08442662 -0.488223559  0.172688560  0.313575909
# Methionine            0.8861882  0.20490839  0.086145124 -0.019674310  0.176571046
# Phenylalanine_Average 0.9167304  0.11707764 -0.017697043  0.005519357 -0.088586941
# Proline               0.7104739 -0.58360391  0.098844334  0.029149447 -0.048057782
# Threonine_Average     0.7321295  0.18329453  0.278803287 -0.413608354  0.210898849
# Tyrosine_Average      0.7040285 -0.02383442 -0.461267372  0.294025477  0.208793775
# Valine_Average        0.7828489 -0.50032832 -0.307660821  0.058826111 -0.025263560
# Alanine               0.3475975  0.02174957  0.632091737  0.546340051  0.176637605
# Aspartate             0.3910232 -0.55601386  0.486883738  0.144488056  0.258654448
var$contrib # contributions of variables to the PCs
# Dim.1       Dim.2        Dim.3        Dim.4       Dim.5
# Serine                5.420025  8.79293876  1.362619133  0.415813041  5.14610601
# Asparagine            2.924755 15.21213032  1.403297986  1.508850414  2.09837463
# Glutamine             7.373567  0.26584047  5.127690066  0.487611203  7.85187680
# Tryptophan            6.583969  5.38873586  2.550025470  1.402973375  0.01105521
# Lysine                1.913098 17.19760679  0.832677974  0.685993037  0.52583770
# Arginine_Average      3.350259 16.47719022  0.003872271  0.147897482  2.66215487
# Glutamate_Average     6.184056  0.21410205  0.498182095  4.694538628 19.44571552
# Glycine_Average       6.772747  2.40191277  0.012670783  0.051880605  4.54804733
# Histidine_Average     5.624681  0.25149824  1.592975779 23.744054077  5.56671911
# Isoleucine_Average    6.186263  5.49592625  4.279320956  0.046886485  2.48998906
# Leucine               5.697056  0.20223210 15.361381443  3.258668893 14.95497766
# Methionine            8.140776  1.19127162  0.478249150  0.042297247  4.74175782
# Phenylalanine_Average 8.711585  0.38890116  0.020183396  0.003328818  1.19354774
# Proline               5.232511  9.66334954  0.629645877  0.092848251  0.35125930
# Threonine_Average     5.556352  0.95321380  5.009433201 18.693546453  6.76470418
# Tyrosine_Average      5.138003  0.01611761 13.711920309  9.446763073  6.63033513
# Valine_Average        6.352867  7.10234006  6.100103443  0.378140651  0.09707100
# Alanine               1.252469  0.01342123 25.748565303 32.616636670  4.74533331
# Aspartate             1.584962  8.77127115 15.277185365  2.281271595 10.17513763
var$cos2  # Cos2: quality on the factore map
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# Serine                0.5228624 0.3099151107 2.114373e-02 0.0038052659 3.383595e-02
# Asparagine            0.2821471 0.5361653459 2.177495e-02 0.0138080735 1.379694e-02
# Glutamine             0.7113179 0.0093697886 7.956626e-02 0.0044623186 5.162655e-02
# Tryptophan            0.6351465 0.1899308884 3.956869e-02 0.0128391517 7.268868e-05
# Lysine                0.1845539 0.6061452669 1.292065e-02 0.0062777875 3.457414e-03
# Arginine_Average      0.3231949 0.5807535310 6.008595e-05 0.0013534670 1.750382e-02
# Glutamate_Average     0.5965674 0.0075462213 7.730281e-03 0.0429615379 1.278567e-01
# Glycine_Average       0.6533576 0.0846575967 1.966123e-04 0.0004747795 2.990368e-02
# Histidine_Average     0.5426053 0.0088642839 2.471817e-02 0.2172910184 3.660150e-02
# Isoleucine_Average    0.5967803 0.1937089110 6.640214e-02 0.0004290764 1.637182e-02
# Leucine               0.5495872 0.0071278539 2.383622e-01 0.0298213389 9.832985e-02
# Methionine            0.7853295 0.0419874499 7.420982e-03 0.0003870785 3.117733e-02
# Phenylalanine_Average 0.8403947 0.0137071747 3.131853e-04 0.0000304633 7.847646e-03
# Proline               0.5047731 0.3405935291 9.770202e-03 0.0008496902 2.309550e-03
# Threonine_Average     0.5360137 0.0335968860 7.773127e-02 0.1710718706 4.447832e-02
# Tyrosine_Average      0.4956561 0.0005680797 2.127676e-01 0.0864509810 4.359484e-02
# Valine_Average        0.6128523 0.2503284244 9.465518e-02 0.0034605113 6.382475e-04
# Alanine               0.1208240 0.0004730436 3.995400e-01 0.2984874518 3.120084e-02
# Aspartate             0.1528992 0.3091514161 2.370558e-01 0.0208767983 6.690212e-02

#### graph of variables default plot ####
fviz_pca_var(AA_pca_FM, col.var = "black")
# plot aka variable correlation plot
# positively correlated: variables grouped together 
# negatively correlated: variables positioned on opposite sides of the origin (opposed quadrants)
# distance between variables and the origin measures the quality of the variables on the factor map. 
# variables that are away from the origin are well represented on the factor map
fviz_pca_var(AA_pca_FM, col.var = "black", axes = c(2,3))
fviz_pca_var(AA_pca_FM, col.var = "black", axes = c(3,4))
fviz_pca_var(AA_pca_FM, col.var = "black", axes = c(4,5))

fviz_pca_var(AA_pca_FM, col.var = "black", axes = c(1,3))

#### Quality of representation ####
#### Contributions of variables to PCs ####

# contributions of variables in a given principal component are expressed in percentage.
# Variables that are correlated with PC1 and PC2 are the most important in explaining the variability in the data set.
# Variables that do not correlate with any PC or correlate with the last dimensions are variables with 
# low contribution and might be removed to simplify the overall analysis.

head(var$contrib) # contributions of variables to the PCs
# The larger the value of the contribution, the more the variable contributes to the component.
# visualize cos2 as bar graph
fviz_cos2(AA_pca_FM, choice = "var", axes = 1:2)

# Color by cos2 values: quality on the factor map
fviz_pca_var(AA_pca_FM, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

# Color by cos2 values: quality on the factor map
fviz_pca_var(AA_pca_FM, col.var = "cos2", axes = 2:3,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

variables_PCA<- fviz_pca_var(AA_pca_FM, col.var = "cos2",
                             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                             repel = TRUE # Avoid text overlapping
)

# Adjust transparancy by cos2 values: quality on the factor map
fviz_pca_var(AA_pca_FM, alpha.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

#### Color by a custom continuous variable ####
# Age

fviz_pca_ind(AA_pca_FM, col.ind = AA_data.frame$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

fviz_pca_var(AA_pca_FM, col.var = AA_data.frame$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
            gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

indyear1_2<- fviz_pca_ind(AA_pca_FM, col.ind = AA_data.frame$Spine.Age,
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Age") 
ggsave("indyear1_2.pdf")

fviz_pca_ind(AA_pca_FM, col.ind = AA_data.frame$Year, axes = c(2,3),
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Year")  
indyear2_3<- fviz_pca_ind(AA_pca_FM, col.ind = AA_data.frame$Year, axes = c(2,3),
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Year") 
ggsave("indyear2_3.pdf")

# Load necessary packages
library(FactoMineR)
library(ggplot2)

# Example data
# Assuming your data is stored in a data frame called "my_data"
# It contains the PCA scores in columns PC1, PC2, etc., the variable you want to plot against (e.g., "variable"), and the factor (e.g., "factor")



# Extract the principal component scores for the axis you're interested in (e.g., PC1)
pc_scores <- AA_pca_FM$ind$coord[, "Dim.1"]

# Combine the principal component scores with the variable and factor
pca_AA_data <- data.frame(PC1 = AA_pca_FM, 
                       variable = factor_amino$Spine.Age,
                       factor = factor_amino$Site)

# Plot using ggplot2
ggplot(pca_data, aes(x = PC1, y = variable, color = factor)) +
  geom_point() +
  labs(title = "PCA Axis 1 vs Variable, Colored by Factor")
length(AA_data.frame)
dim(AA_data.frame)
length(AA_pca_FM)
length(factor_amino$Spine.Age)
dim(factor_amino)
length(factor_amino$Site)

#### trying heatmap on aas ####
# Define a distance function based on euclidean norm
# calculated between PCA values of the i-th and j-th items
dst <- Vectorize(function(i,j,dtset) sqrt(sum((dtset[i,2:3]-dtset[j,2:3])^2)), vectorize.args=c("i","j"))

# Calculate the distance matrix
nr <- nrow(AA_pca_FM)
mtx <- outer(1:nr, 1:nr, "dst", dtset=AA_pca_FM)
colnames(mtx) <- rownames(mtx) <- AA_pca_FM[,1]

# Plot the heatmap using ggplot2
library(reshape2)
library(ggplot2)
mtx.long <- melt(mtx)
ggplot(mtx.long, aes(x = Var1, y = Var2, fill = value)) + geom_tile()+xlab("")+ylab("")

# Default plot
library(stats)
summary(AA_data_pca)
dim(AA_data_pca)
str(AA_data_pca)
# Assuming your data frame is named 'df'
AA_data_pca[,1:19] <- lapply(AA_data_pca[,1:19], as.numeric)
sum(is.na(AA_data_pca))

heatmap(AA_data_pca, scale = "column")

#### heatmap on correlations try 2 ####
view(Amino_Acids18)
dim(Amino_Acids18)
corAA_df <- Amino_Acids18[,8:27]
cor_df <- round(cor(corAA_df), 2)

library(reshape2)
melted_cor <- melt(cor_df)

ggplot(data = melted_cor, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  #geom_text(aes(Var2, Var1, label = value), size = 5) +
  scale_fill_gradient2(low = "blue", high = "red", 
                       limit = c(-1, 1), 
                       name = "Correlation") +
  theme(axis.title.x = element_blank(), 
        axis.title.y = element_blank(), 
        panel.background = element_blank())

ggplot(data = melted_cor, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  geom_text(aes(Var2, Var1, label = value), size = 2) +
  scale_fill_gradient2(low = "blue", high = "red", limit = c(-1, 1), 
                       name = "Correlation") +
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1),  # Tilt x-axis labels
    panel.background = element_blank()
  )

# Example: Rename the columns
library(dplyr)
new_amino_acid <- Amino_Acids18 %>%
  rename(Valine_Average = Valine, 
         Tyrosine_Average = Tyrosine,
         Threonine_Average = Threonine,
         Phenylalanine_Average = Phenylalanine,
         Isoleucine_Average = Isoleucine,
         Histidine_Average = Histidine,
         Glycine_Average = Glycine,
         Glutamate_Average = Glutamate,
         Arginine_Average = Arginine,
         Spine.Age = Age)

names(Amino_Acids18)

names(Amino_Acids18) <- c( "ID", "Site", "TL", "FL", "W", "K", "Sex", 
                           "Age", "Serine", "Asparagine", "Glutamine", 
                           "Tryptophan", "Lysine", "Arginine", "Glutamate", 
                           "Glycine", "Histidine",   "Isoleucine",   "Leucine", 
                           "Methionine", "Phenylalanine", "Proline", "Threonine",  
                           "Tyrosine", "Valine", "Alanine", "Aspartate")

#### Correspondence analysis trying the aas ####
# normalize
aa_transformed <- decostand(num_amino, "normalize")
aa.ca2 <- cca(aa_transformed)
aa.ca2
# Call: cca(X = aa_transformed)
# 
# Inertia Rank
# Total          0.1424     
# Unconstrained  0.1424   18
# Inertia is scaled Chi-square 
# 
# Eigenvalues for unconstrained axes:
#   CA1     CA2     CA3     CA4     CA5     CA6     CA7     CA8 
# 0.05080 0.03212 0.01600 0.01168 0.00662 0.00547 0.00469 0.00357 
# (Showing 8 of 18 unconstrained eigenvalues)

summary(aa.ca2)

# 
# Call:
#   cca(X = aa_transformed) 
# 
# Partitioning of scaled Chi-square:
#   Inertia Proportion
# Total          0.1424          1
# Unconstrained  0.1424          1
# 
# Eigenvalues, and their contribution to the scaled Chi-square 
# 
# Importance of components:
#   CA1     CA2    CA3     CA4      CA5      CA6      CA7      CA8
# Eigenvalue            0.0508 0.03212 0.0160 0.01168 0.006616 0.005475 0.004691 0.003575
# Proportion Explained  0.3568 0.22555 0.1124 0.08203 0.046460 0.038448 0.032940 0.025103
# Cumulative Proportion 0.3568 0.58231 0.6947 0.77674 0.823196 0.861644 0.894584 0.919687
# CA9     CA10     CA11     CA12     CA13      CA14      CA15
# Eigenvalue            0.002667 0.002259 0.001622 0.001143 0.001011 0.0008896 0.0008061
# Proportion Explained  0.018729 0.015865 0.011393 0.008026 0.007098 0.0062474 0.0056608
# Cumulative Proportion 0.938416 0.954281 0.965673 0.973700 0.980798 0.9870451 0.9927059
# CA16      CA17      CA18
# Eigenvalue            0.0005285 0.0003265 0.0001836
# Proportion Explained  0.0037115 0.0022930 0.0012896
# Cumulative Proportion 0.9964174 0.9987104 1.0000000
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# 
# 
# Species scores
# 
# CA1      CA2      CA3       CA4       CA5        CA6
# Serine                -0.15813 -0.13080 -0.02801  0.002757 -0.061198  7.820e-02
# Asparagine             1.03500  0.51531 -0.06238  0.414600 -0.212082  4.218e-02
# Glutamine              0.07311 -0.05426  0.04336  0.241040 -0.193027  2.436e-01
# Tryptophan             0.15834  0.07162 -0.09123 -0.040480  0.071440  5.175e-02
# Lysine                -0.21255 -0.65570  0.34301  0.071419 -0.339573  1.718e-02
# Arginine_Average      -0.16327 -0.29997  0.13041  0.094714 -0.014900  1.443e-02
# Glutamate_Average     -0.06178  0.01631 -0.10368 -0.058289 -0.077306  1.370e-01
# Glycine_Average       -0.09140 -0.04421 -0.15146 -0.047790 -0.012561 -6.020e-02
# Histidine_Average     -0.01804 -0.05208 -0.04403  0.138350  0.082313  8.128e-03
# Isoleucine_Average     0.33402  0.06031  0.01094 -0.054136 -0.029327 -2.047e-05
# Leucine                0.17973 -0.22483  0.24079 -0.085006  0.066348 -1.086e-01
# Methionine             0.04397 -0.11207  0.07525  0.089595  0.044120  9.406e-02
# Phenylalanine_Average  0.03430 -0.02456 -0.04178 -0.026220 -0.005377  8.198e-02
# Proline                0.40937  0.21575  0.05356  0.093198 -0.121565 -9.191e-02
# Threonine_Average      0.00768 -0.11554 -0.06249  0.280436  0.142935 -7.069e-03
# Tyrosine_Average       0.14338 -0.08286  0.07599 -0.228429  0.203104  1.966e-01
# Valine_Average         0.33154  0.08218  0.01096 -0.066720  0.000233  1.471e-02
# Alanine               -0.30609  0.28619  0.13651  0.001510  0.005152 -1.036e-02
# Aspartate              0.05900  0.25460  0.02510  0.209074  0.144307  7.433e-02
# 
# 
# Site scores (weighted averages of species scores)
# 
# CA1      CA2      CA3       CA4      CA5      CA6
# sit1  -0.49474 -0.99745 -0.12938  0.067368  0.71143  2.46094
# sit2  -1.19381  0.61241 -1.30353 -0.876900  0.08496  0.02415
# sit3  -1.12990  0.99021 -0.55846 -0.688799  0.39121  1.64263
# sit4  -0.87235 -0.19172  1.09752 -0.574233 -0.97416  0.90373
# sit5   0.14032 -1.42380  0.57917 -0.633424  0.16424  0.13994
# sit6  -0.80181 -0.54000  0.72876  0.309401 -0.15571  0.32609
# sit7  -0.52901 -0.77253 -0.52880 -0.085293  1.37814  0.33778
# sit8  -0.58332 -1.10079  0.08926  0.783440 -0.22201  1.33873
# sit9  -0.94763 -1.05149 -0.23834 -0.596581 -2.58411  1.41502
# sit10 -0.50178  0.39790  0.43686  0.168156  0.99831  0.53441
# sit11 -0.97529 -0.48146 -0.47235 -0.318289 -0.51383 -0.47184
# sit12 -1.63160  1.44630 -0.69020 -0.892002  0.18441 -0.54783
# sit13 -0.60929 -0.47190 -2.02562 -0.992104  0.44430 -1.20063
# sit14 -0.50542  0.03739  0.18235 -1.664519  0.43234  0.98937
# sit15 -1.12506  0.45758 -1.52567 -0.716844 -0.96717  0.77498
# sit16 -0.27398 -1.77925  0.64146 -0.773905 -2.36669  0.53033
# sit17 -0.60086  0.57792 -0.99619 -1.077692  0.60409  0.10124
# sit18 -2.30854  2.58450  1.32716 -0.539561  0.28946 -1.15084
# sit19 -0.34696  0.26603 -0.07531 -1.067625  0.17617 -0.80911
# sit20  0.07266 -0.44037 -3.07457 -0.666778 -0.14293 -0.09056
# sit21 -0.22504 -1.90148  0.00863 -0.503435 -2.56262 -0.96673
# sit22 -0.19751 -0.82598  0.95043 -0.355975 -1.03416 -0.81639
# sit23  1.12449 -1.04835  1.26462  0.058050  0.41186 -2.58219
# sit24 -0.71095 -0.31017  1.63401 -0.584319 -0.68485 -1.43034
# sit25 -1.27062  3.26167  2.58770  1.063926 -0.41080 -1.13480
# sit26 -0.36745 -0.64609  0.82520  1.474230  0.65214 -0.09029
# sit27  0.42922 -0.99844 -0.41774  1.613355  1.37172  0.68988
# sit28  0.17281 -0.78528  0.82779  1.140220 -0.80432  0.07893
# sit29  0.08876 -0.50977 -0.49963  0.339553 -0.16200 -1.39792
# sit30 -0.26803 -0.68678 -0.21135  1.478094  0.67243 -0.74592
# sit31  0.24377 -0.36626 -0.03696  1.202431  0.89901 -0.15902
# sit32  0.59548 -0.84623  0.64670  2.160433  0.72358 -0.12809
# sit33  0.34564 -1.16101  0.41088 -0.076596  1.00881 -0.33665
# sit34 -0.40358  0.24949  1.45462  0.014248  0.35284  0.41643
# sit35 -1.02083 -0.06386 -2.89872  0.273915  1.34563 -2.61325
# sit36 -0.89427 -0.15812  0.46603  0.637658  0.17110 -0.03891
# sit37 -1.07168 -0.39448 -0.92714  0.286255  0.23054  0.38283
# sit38 -0.57358  0.01451  0.21788 -0.156968  0.34197 -0.20637
# sit39 -1.04086  0.91284 -0.07083  0.005662  0.67781 -0.42624
# sit40  1.10831  0.26669 -0.11316  1.395040  0.40778  0.85849
# sit41  0.54205  0.17452 -0.85491  1.416742 -0.35596  0.24664
# sit42  2.32895  0.79885 -0.26787 -0.460618 -1.08841  0.34131
# sit43  1.05561  0.56690 -0.63159 -0.473762  0.33830 -0.44328
# sit44  0.79431  1.16875 -0.26928  0.075259 -0.82656 -0.28182
# sit45 -1.17485  1.73172  1.38066  0.101783  0.42103  1.10889
# sit46  1.29720  1.00034  0.36802  0.461472  0.35125 -0.87192
# sit47  0.40031  0.09785 -0.66421  0.246122  1.36286  1.13991
# sit48  1.44073 -0.33255  0.35560 -0.963413 -0.14761 -0.69625
# sit49  0.97644  1.25231 -1.54333  1.170056 -0.36134  0.02520
# sit50  1.89245  0.90984 -0.12505 -1.264293 -0.69799 -0.85333
# sit51  1.76191  1.34786 -0.69963 -0.708463 -0.90334  0.75547
# sit52  0.56020 -0.01453 -0.09843 -0.267693 -0.31589 -1.77905
# sit53  2.19000 -0.41610  1.71722 -3.339693  2.67044  1.30090
# sit54  1.42696  1.78011 -0.15122  1.606117 -1.98205  1.50670
plot(aa.ca2, display = "species")


plot(aa.ca2, type="n")
text(aa.ca2,display="species")
points(aa.ca2,col="blue")


#### Carnitine book ####
# read data
Carnitine_book <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Carnitine_book.csv", quote="")
   View(Carnitine_book)
dim(Carnitine_book)
Carnitine_only <- Carnitine_book[,10:49]
dim(Carnitine_only)
names(Carnitine_only)

#### Compute correlations ####
correlations2 <- cor(Carnitine_book$Spine.Age, Carnitine_only)

# Print correlations
print(correlations2)
# C2      C3_1         C3       C4_1         C4       C3OH
# [1,] 0.3402395 -0.126548 -0.2052054 -0.2383346 -0.1764019 -0.1193076
# C5_1         C5      C4OH       C6_1         C6      C5OH
# [1,] -0.1920974 -0.2457064 -0.163636 -0.4467556 -0.0382808 0.0850139
# C5_1DC       C5DC        C8    C5MDC        C9      C7DC     C10_2
# [1,] -0.2111345 0.05670399 0.1578173 0.159258 0.2244565 0.1220914 0.2661331
# C10_1       C10     C12_1        C12       C14_2     C14_1        C14
# [1,] 0.1897864 0.2484103 0.1068175 0.07959819 -0.03558301 0.0935537 0.05424027
# C12DC   C14_2OH    C14_1OH     C16_2     C16_1        C16    C16_2OH
# [1,] 0.2535054 0.1887444 0.03678913 0.2784666 0.1826252 0.03926562 0.02541022
# C16_1OH      C16OH     C18_2     C18_1        C18    C18_1OH
# [1,] -0.001632518 0.05298148 0.2056525 0.1416085 0.04720983 0.08718539
# C0_Average
# [1,]  0.2796395

#### Perform MANCOVA ####
manova_result2 <- manova(cbind(Carnitine_book$C2, Carnitine_book$C3_1,
                              Carnitine_book$C3OH, Carnitine_book$C4,
                              Carnitine_book$C4_1, Carnitine_book$C4OH,
                              Carnitine_book$C5, Carnitine_book$C5_1,
                              Carnitine_book$C5_1DC, Carnitine_book$C5DC,
                              Carnitine_book$C5MDC, Carnitine_book$C5OH,
                              Carnitine_book$C6, Carnitine_book$C6_1,
                              Carnitine_book$C7DC, Carnitine_book$C8,
                              Carnitine_book$C9, Carnitine_book$C10,
                              Carnitine_book$C10_1, Carnitine_book$C10_2,
                              Carnitine_book$C12, Carnitine_book$C12_1,
                              Carnitine_book$C12DC, Carnitine_book$C14,
                              Carnitine_book$C14_1, Carnitine_book$C14_1OH,
                              Carnitine_book$C14_2, Carnitine_book$C14_2OH,
                              Carnitine_book$C16, Carnitine_book$C16_1,
                              Carnitine_book$C16OH, Carnitine_book$C16_1OH,
                              Carnitine_book$C16_2, Carnitine_book$C16_2OH,
                              Carnitine_book$C18, Carnitine_book$C18_1,
                              Carnitine_book$C18_1OH, Carnitine_book$C18_2) 
                        ~ Carnitine_book$Spine.Age + Carnitine_book$Site)
# Summarize MANOVA results
summary(manova_result2)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Carnitine_book$Spine.Age  1 0.91685   3.4822     38     12 0.0119917 *  
#   Carnitine_book$Site       3 2.63393   2.6508    114     42 0.0002722 ***
#   Residuals                49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

# Extract coefficients
coefficients2 <- coef(manova_result2)
coefficients2
# [,1]          [,2]          [,3]
# (Intercept)                  10.0888393  0.0608727063  0.0273300629
# Carnitine_book$Spine.Age      0.7463222 -0.0005988484 -0.0001479047
# Carnitine_book$SiteMatheson   5.4325259  0.0006915675 -0.0029932128
# Carnitine_book$SiteRed River  0.2574222 -0.0105836852 -0.0019333717
# Carnitine_book$SiteSandy Bar -5.3931319 -0.0237026061 -0.0021884762
# [,4]          [,5]         [,6]
# (Intercept)                   0.395223715  0.0880296534  0.106061723
# Carnitine_book$Spine.Age     -0.002993218 -0.0003920505 -0.003739219
# Carnitine_book$SiteMatheson  -0.175397065 -0.0143921892  0.011673470
# Carnitine_book$SiteRed River -0.197155035 -0.0318654383 -0.027521164
# Carnitine_book$SiteSandy Bar -0.268846705 -0.0265382054 -0.049300260
# [,7]          [,8]         [,9]
# (Intercept)                   0.539734314  2.830463e-02  0.146530218
# Carnitine_book$Spine.Age     -0.005231734  3.400512e-05 -0.001195298
# Carnitine_book$SiteMatheson  -0.308111341 -3.332141e-03 -0.038920544
# Carnitine_book$SiteRed River -0.383418452 -1.004882e-02 -0.042108381
# Carnitine_book$SiteSandy Bar -0.407556089 -7.353557e-03 -0.043994901
# [,10]         [,11]        [,12]
# (Intercept)                   0.202168780  0.0285583312  0.168616733
# Carnitine_book$Spine.Age      0.004705982  0.0002528951  0.002235253
# Carnitine_book$SiteMatheson   0.010184161 -0.0014744391  0.007192612
# Carnitine_book$SiteRed River -0.079745809  0.0002440691 -0.015759475
# Carnitine_book$SiteSandy Bar -0.055586438  0.0004445905 -0.016562862
# [,13]        [,14]       [,15]        [,16]
# (Intercept)                   0.85891658  0.239688251 0.018677431  0.211810813
# Carnitine_book$Spine.Age     -0.00855104 -0.004976040 0.001324616  0.003771977
# Carnitine_book$SiteMatheson   0.03372493 -0.003350073 0.016255589 -0.019563698
# Carnitine_book$SiteRed River  0.05780999 -0.025650006 0.012774562  0.032756340
# Carnitine_book$SiteSandy Bar -0.11463188 -0.011292431 0.014347350 -0.023912881
# [,17]         [,18]        [,19]
# (Intercept)                   0.0217333547  0.1327246055  0.186974544
# Carnitine_book$Spine.Age      0.0005210493  0.0007855886  0.002194546
# Carnitine_book$SiteMatheson  -0.0007656089 -0.0022912359 -0.009424970
# Carnitine_book$SiteRed River  0.0014859757  0.0029061164 -0.023215880
# Carnitine_book$SiteSandy Bar -0.0029070164 -0.0004063073 -0.023449293
# [,20]         [,21]        [,22]
# (Intercept)                  0.056891697  3.460815e-02  0.057315488
# Carnitine_book$Spine.Age     0.002084469  7.133717e-06  0.001087028
# Carnitine_book$SiteMatheson  0.015217148 -1.457605e-03 -0.008420110
# Carnitine_book$SiteRed River 0.030783033  7.537172e-03 -0.011738490
# Carnitine_book$SiteSandy Bar 0.025422955 -2.477933e-03 -0.016595676
# [,23]         [,24]        [,25]
# (Intercept)                  0.0137913596  0.0603630700  0.097310695
# Carnitine_book$Spine.Age     0.0003918906  0.0004700416  0.001756206
# Carnitine_book$SiteMatheson  0.0008791011 -0.0146607304 -0.022166183
# Carnitine_book$SiteRed River 0.0064726168  0.0119958669  0.001880141
# Carnitine_book$SiteSandy Bar 0.0035293698 -0.0167189028 -0.031818735
# [,26]         [,27]        [,28]
# (Intercept)                   4.070768e-02  0.0192690339 0.0166418618
# Carnitine_book$Spine.Age     -2.226488e-05 -0.0002635317 0.0006976008
# Carnitine_book$SiteMatheson  -8.492527e-03 -0.0010625848 0.0004903455
# Carnitine_book$SiteRed River  9.057914e-03  0.0029899680 0.0102343442
# Carnitine_book$SiteSandy Bar -7.659245e-03 -0.0016566006 0.0034519109
# [,29]        [,30]         [,31]
# (Intercept)                   0.1269388889  0.100201295  0.0122957624
# Carnitine_book$Spine.Age     -0.0008166667  0.005117690  0.0000775112
# Carnitine_book$SiteMatheson   0.0080055556 -0.013747125 -0.0014121838
# Carnitine_book$SiteRed River  0.0508000000  0.088190058  0.0004252975
# Carnitine_book$SiteSandy Bar  0.0081833333  0.005058548 -0.0027680593
# [,32]         [,33]         [,34]
# (Intercept)                   0.0460929004  0.0110594391  0.0261771646
# Carnitine_book$Spine.Age     -0.0006873001  0.0004864044 -0.0003384997
# Carnitine_book$SiteMatheson  -0.0026794732 -0.0009324867 -0.0005409672
# Carnitine_book$SiteRed River  0.0129193602  0.0050168394  0.0103498656
# Carnitine_book$SiteSandy Bar  0.0012557667 -0.0002576903  0.0010906110
# [,35]       [,36]         [,37]
# (Intercept)                   0.0406804702 0.135340671  1.893164e-02
# Carnitine_book$Spine.Age     -0.0001758637 0.003601999  1.097409e-04
# Carnitine_book$SiteMatheson   0.0011563244 0.003776934  3.839731e-05
# Carnitine_book$SiteRed River  0.0184427639 0.107806935  5.208829e-03
# Carnitine_book$SiteSandy Bar  0.0123919546 0.015101556 -4.632470e-04
# [,38]
# (Intercept)                   0.018590335
# Carnitine_book$Spine.Age      0.001120473
# Carnitine_book$SiteMatheson  -0.002824726
# Carnitine_book$SiteRed River  0.011821152
# Carnitine_book$SiteSandy Bar -0.002549047

# Reshape your data to long format
Carnitines_long <- Carnitine_book %>%
  pivot_longer(cols = c(C2, C3_1,C3OH, C4, C4_1, C4OH, C5, C5_1,
                        C5_1DC, C5DC,
                        C5MDC, C5OH,
                        C6, C6_1,
                        C7DC, C8,
                        C9, C10,
                        C10_1, C10_2,
                        C12, C12_1,
                        C12DC, C14,
                        C14_1, C14_1OH,
                        C14_2, C14_2OH,
                        C16, C16_1,
                        C16OH, C16_1OH,
                        C16_2, C16_2OH,
                        C18, C18_1,
                        C18_1OH, C18_2),
               names_to = "Carnitines",
               values_to = "Concentration")

# Plot using ggplot2
library(ggplot2)

ggplot(data = Carnitines_long, aes(x = Spine.Age, y = Concentration, color = Site)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~Carnitines, scales = "free_y") +
  labs(title = "Relationship between Spine Age, Site, and Carnitine Concentration")

# as data.frame
carn_data.frame <- data.frame(Carnitine_only)
names(carn_data.frame)
dim(carn_data.frame)
# 54 27

# dataframe with just met data columns
carn_data_pca <- carn_data.frame %>%
  print()

#### Correlations plot ####

carn_cor <- cor(carn_data_pca)

summary(carn_cor)
# C2               C3_1                C3                C4_1         
# Min.   :0.07077   Min.   :-0.02872   Min.   :-0.11996   Min.   :-0.06577  
# 1st Qu.:0.30974   1st Qu.: 0.17057   1st Qu.: 0.07586   1st Qu.: 0.12227  
# Median :0.47357   Median : 0.23583   Median : 0.16928   Median : 0.18810  
# Mean   :0.41602   Mean   : 0.27177   Mean   : 0.22381   Mean   : 0.24810  
# 3rd Qu.:0.50554   3rd Qu.: 0.34246   3rd Qu.: 0.29330   3rd Qu.: 0.39628  
# Max.   :1.00000   Max.   : 1.00000   Max.   : 1.00000   Max.   : 1.00000  
# C4                C3OH              C5_1                C5          
# Min.   :-0.05129   Min.   :0.01279   Min.   :-0.12031   Min.   :-0.12575  
# 1st Qu.: 0.42655   1st Qu.:0.12016   1st Qu.: 0.04513   1st Qu.: 0.01529  
# Median : 0.54400   Median :0.16824   Median : 0.13816   Median : 0.11870  
# Mean   : 0.50516   Mean   :0.20467   Mean   : 0.20579   Mean   : 0.19751  
# 3rd Qu.: 0.59690   3rd Qu.:0.24150   3rd Qu.: 0.28357   3rd Qu.: 0.25488  
# Max.   : 1.00000   Max.   :1.00000   Max.   : 1.00000   Max.   : 1.00000  
# C4OH              C6_1                 C6               C5OH          
# Min.   :0.05115   Min.   :-0.008159   Min.   :0.06763   Min.   :-0.008159  
# 1st Qu.:0.24440   1st Qu.: 0.191465   1st Qu.:0.42617   1st Qu.: 0.154102  
# Median :0.46544   Median : 0.327378   Median :0.68091   Median : 0.194533  
# Mean   :0.41612   Mean   : 0.310329   Mean   :0.58940   Mean   : 0.227887  
# 3rd Qu.:0.53232   3rd Qu.: 0.397840   3rd Qu.:0.76166   3rd Qu.: 0.244638  
# Max.   :1.00000   Max.   : 1.000000   Max.   :1.00000   Max.   : 1.000000  
# C5_1DC              C5DC                C8              C5MDC         
# Min.   :-0.01482   Min.   :-0.03117   Min.   :0.06763   Min.   :-0.06456  
# 1st Qu.: 0.39760   1st Qu.: 0.35097   1st Qu.:0.43750   1st Qu.: 0.22732  
# Median : 0.49772   Median : 0.40787   Median :0.78210   Median : 0.51076  
# Mean   : 0.47185   Mean   : 0.42403   Mean   :0.62790   Mean   : 0.40623  
# 3rd Qu.: 0.54461   3rd Qu.: 0.47986   3rd Qu.:0.84125   3rd Qu.: 0.55982  
# Max.   : 1.00000   Max.   : 1.00000   Max.   :1.00000   Max.   : 1.00000  
# C9              C7DC              C10_2             C10_1        
# Min.   :0.1303   Min.   :-0.12031   Min.   :-0.1258   Min.   :0.05851  
# 1st Qu.:0.4213   1st Qu.: 0.02493   1st Qu.: 0.1785   1st Qu.:0.22036  
# Median :0.7844   Median : 0.07774   Median : 0.5778   Median :0.24995  
# Mean   :0.6250   Mean   : 0.08944   Mean   : 0.4431   Mean   :0.28233  
# 3rd Qu.:0.8645   3rd Qu.: 0.13184   3rd Qu.: 0.6659   3rd Qu.:0.31510  
# Max.   :1.0000   Max.   : 1.00000   Max.   : 1.0000   Max.   :1.00000  
# C10             C12_1              C12              C14_2       
# Min.   :0.0154   Min.   :0.02987   Min.   :0.03221   Min.   :0.0760  
# 1st Qu.:0.4162   1st Qu.:0.47967   1st Qu.:0.39176   1st Qu.:0.3963  
# Median :0.7687   Median :0.74671   Median :0.82469   Median :0.7559  
# Mean   :0.5994   Mean   :0.62575   Mean   :0.63929   Mean   :0.6313  
# 3rd Qu.:0.8439   3rd Qu.:0.80904   3rd Qu.:0.92166   3rd Qu.:0.8957  
# Max.   :1.0000   Max.   :1.00000   Max.   :1.00000   Max.   :1.0000  
# C14_1              C14              C12DC             C14_2OH        
# Min.   :0.06973   Min.   :0.06925   Min.   :-0.09428   Min.   :-0.04236  
# 1st Qu.:0.43001   1st Qu.:0.40004   1st Qu.: 0.21826   1st Qu.: 0.32875  
# Median :0.83503   Median :0.81753   Median : 0.71101   Median : 0.80264  
# Mean   :0.67107   Mean   :0.65911   Mean   : 0.53285   Mean   : 0.63199  
# 3rd Qu.:0.93226   3rd Qu.:0.94996   3rd Qu.: 0.80224   3rd Qu.: 0.93938  
# Max.   :1.00000   Max.   :1.00000   Max.   : 1.00000   Max.   : 1.00000  
# C14_1OH            C16_2             C16_1                C16         
# Min.   :0.08976   Min.   :-0.0557   Min.   :-0.007021   Min.   :0.02844  
# 1st Qu.:0.39864   1st Qu.: 0.2844   1st Qu.: 0.355819   1st Qu.:0.39675  
# Median :0.81100   Median : 0.7766   Median : 0.828562   Median :0.80244  
# Mean   :0.65700   Mean   : 0.6030   Mean   : 0.640844   Mean   :0.64116  
# 3rd Qu.:0.95033   3rd Qu.: 0.8912   3rd Qu.: 0.944138   3rd Qu.:0.93600  
# Max.   :1.00000   Max.   : 1.0000   Max.   : 1.000000   Max.   :1.00000  
# C16_2OH           C16_1OH            C16OH             C18_2        
# Min.   :0.03783   Min.   :0.06144   Min.   :0.02326   Min.   :0.01496  
# 1st Qu.:0.41092   1st Qu.:0.40387   1st Qu.:0.41105   1st Qu.:0.34269  
# Median :0.80773   Median :0.79002   Median :0.77672   Median :0.83064  
# Mean   :0.65632   Mean   :0.64961   Mean   :0.64307   Mean   :0.64859  
# 3rd Qu.:0.95248   3rd Qu.:0.93506   3rd Qu.:0.91748   3rd Qu.:0.95009  
# Max.   :1.00000   Max.   :1.00000   Max.   :1.00000   Max.   :1.00000  
# C18_1                C18              C18_1OH          C0_Average     
# Min.   :-0.009674   Min.   :-0.01104   Min.   :0.05228   Min.   :0.01117  
# 1st Qu.: 0.359742   1st Qu.: 0.38682   1st Qu.:0.39725   1st Qu.:0.29251  
# Median : 0.829898   Median : 0.77814   Median :0.80721   Median :0.48189  
# Mean   : 0.649463   Mean   : 0.62485   Mean   :0.65245   Mean   :0.42099  
# 3rd Qu.: 0.964931   3rd Qu.: 0.92585   3rd Qu.:0.94192   3rd Qu.:0.54321  
# Max.   : 1.000000   Max.   : 1.00000   Max.   :1.00000   Max.   :1.00000 
corrplot(carn_cor, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 60, 
         tl.cex = 1, cl.cex = 1)
dev.off()


#### PCA ####

# PCA with FactoMineR package

carn_pca_FM <- PCA(carn_data_pca, graph = FALSE)


#### Eigenvalues / Variances ####

# extract eigenvalues/varianes
get_eig(carn_pca_FM)
# eigenvalue variance.percent cumulative.variance.percent
# Dim.1  2.263695e+01     56.592369213                    56.59237
# Dim.2  4.988967e+00     12.472417553                    69.06479
# Dim.3  1.895176e+00      4.737939943                    73.80273
# Dim.4  1.483528e+00      3.708820650                    77.51155
# Dim.5  1.287992e+00      3.219979673                    80.73153
# Dim.6  1.207845e+00      3.019613320                    83.75114
# Dim.7  8.469295e-01      2.117323852                    85.86846
# Dim.8  7.494791e-01      1.873697774                    87.74216
# Dim.9  6.919937e-01      1.729984183                    89.47215
# Dim.10 6.194931e-01      1.548732868                    91.02088
# Dim.11 5.284162e-01      1.321040520                    92.34192
# Dim.12 4.628633e-01      1.157158234                    93.49908
# Dim.13 4.015538e-01      1.003884431                    94.50296
# Dim.14 3.468046e-01      0.867011493                    95.36997
# Dim.15 3.316164e-01      0.829040909                    96.19901
# Dim.16 2.617825e-01      0.654456268                    96.85347
# Dim.17 2.373848e-01      0.593461953                    97.44693
# Dim.18 1.761680e-01      0.440420084                    97.88735
# Dim.19 1.539630e-01      0.384907382                    98.27226
# Dim.20 1.389589e-01      0.347397155                    98.61966
# Dim.21 9.638396e-02      0.240959906                    98.86062
# Dim.22 8.261812e-02      0.206545309                    99.06716
# Dim.23 6.802450e-02      0.170061238                    99.23722
# Dim.24 5.979856e-02      0.149496410                    99.38672
# Dim.25 5.559813e-02      0.138995335                    99.52572
# Dim.26 3.804372e-02      0.095109303                    99.62082
# Dim.27 3.178670e-02      0.079466746                    99.70029
# Dim.28 2.186383e-02      0.054659576                    99.75495
# Dim.29 1.792189e-02      0.044804717                    99.79976
# Dim.30 1.744082e-02      0.043602041                    99.84336
# Dim.31 1.572161e-02      0.039304036                    99.88266
# Dim.32 1.413258e-02      0.035331438                    99.91799
# Dim.33 8.468063e-03      0.021170157                    99.93916
# Dim.34 7.231397e-03      0.018078492                    99.95724
# Dim.35 4.890095e-03      0.012225238                    99.96947
# Dim.36 4.467680e-03      0.011169201                    99.98064
# Dim.37 2.755202e-03      0.006888004                    99.98752
# Dim.38 2.090729e-03      0.005226824                    99.99275
# Dim.39 1.933174e-03      0.004832936                    99.99758
# Dim.40 9.662544e-04      0.002415636                   100.00000
corrplot(carn_cor, type = "upper", order = "hclust", 
         +          tl.col = "black", tl.srt = 60, 
         +          tl.cex = 1, cl.cex = 1)
carn_pca_FM <- PCA(carn_data_pca, graph = FALSE)
# extract eigenvalues/varianes
get_eig(carn_pca_FM)

fviz_screeplot(carn_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = Inf
)
fviz_screeplot(carn_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = 16
)

# extract the results for variables
var3 <- get_pca_var(carn_pca_FM)
var3
# Principal Component Analysis Results for variables
#   Name       Description                                    
# 1 "$coord"   "Coordinates for the variables"                
# 2 "$cor"     "Correlations between variables and dimensions"
# 3 "$cos2"    "Cos2 for the variables"                       
# 4 "$contrib" 

var3$coord
# Dim.1       Dim.2       Dim.3        Dim.4        Dim.5
# C2         0.5705240  0.08878494  0.37582068 -0.053118510  0.033320711
# C3_1       0.3009570  0.57064471  0.08180654  0.032796640  0.011333119
# C3         0.2085785  0.73753659  0.07593569  0.232794714 -0.335729789
# C4_1       0.2379540  0.72997203  0.04912729  0.051624563  0.199114372
# C4         0.6373766  0.67197554 -0.19422267  0.050476018 -0.178784582
# C3OH       0.2179220  0.39171028  0.02956060  0.481756315  0.155236229
# C5_1       0.1775164  0.76344802  0.15266421 -0.100130877 -0.178147175
# C5         0.1625366  0.84783400 -0.19346253 -0.003250965 -0.230632304
# C4OH       0.5777071  0.21648618 -0.33068590  0.040779246  0.077351378
# C6_1       0.3934419  0.33736197 -0.33074540  0.023584426  0.555348344
# C6         0.8280668  0.14723359  0.10554197 -0.073230113  0.071957539
# C5OH       0.2543685  0.27775588  0.65795984  0.348783928 -0.012408795
# C5_1DC     0.5962648  0.61372650 -0.27836925 -0.075621009 -0.025804516
# C5DC       0.5291722  0.52478323  0.16481548 -0.415295790  0.117541594
# C8         0.8995066  0.05107445  0.12367972 -0.083121051 -0.072907328
# C5MDC      0.5990714 -0.08901571  0.04947379 -0.384805808 -0.035312872
# C9         0.9054296 -0.03169274  0.05601607 -0.021645116  0.001930235
# C7DC       0.1043711 -0.10517994  0.18944539  0.508499007  0.518179154
# C10_2      0.6732497 -0.28087183  0.33073596 -0.237729164 -0.005091980
# C10_1      0.3439148  0.32063008  0.31624985 -0.401809978  0.507216434
# C10        0.8870782 -0.13078922  0.09400225 -0.202488264  0.032614871
# C12_1      0.8816240  0.16800489  0.02127086 -0.246639375  0.150279670
# C12        0.9510426 -0.13135164 -0.06339824 -0.057992182 -0.068766026
# C14_2      0.9198261 -0.04024529 -0.10715097  0.174345223  0.024097144
# C14_1      0.9747282 -0.01164996 -0.02779031  0.034778870 -0.060256142
# C14        0.9726928 -0.07656936 -0.14065989  0.054703143 -0.058203822
# C12DC      0.8218828 -0.35523670  0.07553913 -0.010348409 -0.151062469
# C14_2OH    0.9518170 -0.25094079  0.02372481  0.042478929 -0.060289682
# C14_1OH    0.9704861 -0.08744574 -0.15424386  0.068004566 -0.014093342
# C16_2      0.9127627 -0.27736346  0.08784088 -0.001487240 -0.094833720
# C16_1      0.9606953 -0.20421987 -0.01361691  0.007395946 -0.041432932
# C16        0.9545146 -0.14582993 -0.14602655  0.072354595  0.044071892
# C16_2OH    0.9719150 -0.13192509 -0.08918920  0.073165236  0.043061782
# C16_1OH    0.9581388 -0.09600861 -0.14895232  0.140394266  0.042450711
# C16OH      0.9411718 -0.02094882 -0.13753202  0.039574013 -0.099310948
# C18_2      0.9659669 -0.17719586  0.02226547  0.066011625 -0.083412648
# C18_1      0.9702809 -0.19445164 -0.03290288  0.074561155 -0.005260420
# C18        0.9340043 -0.19364421 -0.11190754  0.131770336  0.082080666
# C18_1OH    0.9660829 -0.12202434 -0.09292027  0.044028801  0.029087566
# C0_Average 0.5781520  0.02313829  0.65550447  0.176680857 -0.153147148
var3$cor
# Dim.1       Dim.2       Dim.3        Dim.4        Dim.5
# C2         0.5705240  0.08878494  0.37582068 -0.053118510  0.033320711
# C3_1       0.3009570  0.57064471  0.08180654  0.032796640  0.011333119
# C3         0.2085785  0.73753659  0.07593569  0.232794714 -0.335729789
# C4_1       0.2379540  0.72997203  0.04912729  0.051624563  0.199114372
# C4         0.6373766  0.67197554 -0.19422267  0.050476018 -0.178784582
# C3OH       0.2179220  0.39171028  0.02956060  0.481756315  0.155236229
# C5_1       0.1775164  0.76344802  0.15266421 -0.100130877 -0.178147175
# C5         0.1625366  0.84783400 -0.19346253 -0.003250965 -0.230632304
# C4OH       0.5777071  0.21648618 -0.33068590  0.040779246  0.077351378
# C6_1       0.3934419  0.33736197 -0.33074540  0.023584426  0.555348344
# C6         0.8280668  0.14723359  0.10554197 -0.073230113  0.071957539
# C5OH       0.2543685  0.27775588  0.65795984  0.348783928 -0.012408795
# C5_1DC     0.5962648  0.61372650 -0.27836925 -0.075621009 -0.025804516
# C5DC       0.5291722  0.52478323  0.16481548 -0.415295790  0.117541594
# C8         0.8995066  0.05107445  0.12367972 -0.083121051 -0.072907328
# C5MDC      0.5990714 -0.08901571  0.04947379 -0.384805808 -0.035312872
# C9         0.9054296 -0.03169274  0.05601607 -0.021645116  0.001930235
# C7DC       0.1043711 -0.10517994  0.18944539  0.508499007  0.518179154
# C10_2      0.6732497 -0.28087183  0.33073596 -0.237729164 -0.005091980
# C10_1      0.3439148  0.32063008  0.31624985 -0.401809978  0.507216434
# C10        0.8870782 -0.13078922  0.09400225 -0.202488264  0.032614871
# C12_1      0.8816240  0.16800489  0.02127086 -0.246639375  0.150279670
# C12        0.9510426 -0.13135164 -0.06339824 -0.057992182 -0.068766026
# C14_2      0.9198261 -0.04024529 -0.10715097  0.174345223  0.024097144
# C14_1      0.9747282 -0.01164996 -0.02779031  0.034778870 -0.060256142
# C14        0.9726928 -0.07656936 -0.14065989  0.054703143 -0.058203822
# C12DC      0.8218828 -0.35523670  0.07553913 -0.010348409 -0.151062469
# C14_2OH    0.9518170 -0.25094079  0.02372481  0.042478929 -0.060289682
# C14_1OH    0.9704861 -0.08744574 -0.15424386  0.068004566 -0.014093342
# C16_2      0.9127627 -0.27736346  0.08784088 -0.001487240 -0.094833720
# C16_1      0.9606953 -0.20421987 -0.01361691  0.007395946 -0.041432932
# C16        0.9545146 -0.14582993 -0.14602655  0.072354595  0.044071892
# C16_2OH    0.9719150 -0.13192509 -0.08918920  0.073165236  0.043061782
# C16_1OH    0.9581388 -0.09600861 -0.14895232  0.140394266  0.042450711
# C16OH      0.9411718 -0.02094882 -0.13753202  0.039574013 -0.099310948
# C18_2      0.9659669 -0.17719586  0.02226547  0.066011625 -0.083412648
# C18_1      0.9702809 -0.19445164 -0.03290288  0.074561155 -0.005260420
# C18        0.9340043 -0.19364421 -0.11190754  0.131770336  0.082080666
# C18_1OH    0.9660829 -0.12202434 -0.09292027  0.044028801  0.029087566
# C0_Average 0.5781520  0.02313829  0.65550447  0.176680857 -0.153147148
var3$cos2
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# C2         0.32549769 0.0078827652 0.1412411799 2.821576e-03 1.110270e-03
# C3_1       0.09057512 0.3256353838 0.0066923095 1.075620e-03 1.284396e-04
# C3         0.04350497 0.5439602184 0.0057662286 5.419338e-02 1.127145e-01
# C4_1       0.05662211 0.5328591615 0.0024134909 2.665096e-03 3.964653e-02
# C4         0.40624888 0.4515511304 0.0377224469 2.547828e-03 3.196393e-02
# C3OH       0.04749001 0.1534369464 0.0008738289 2.320891e-01 2.409829e-02
# C5_1       0.03151207 0.5828528780 0.0233063615 1.002619e-02 3.173642e-02
# C5         0.02641816 0.7188224868 0.0374277489 1.056878e-05 5.319126e-02
# C4OH       0.33374549 0.0468662649 0.1093531664 1.662947e-03 5.983236e-03
# C6_1       0.15479656 0.1138130976 0.1093925229 5.562252e-04 3.084118e-01
# C6         0.68569454 0.0216777307 0.0111391079 5.362649e-03 5.177887e-03
# C5OH       0.06470334 0.0771483307 0.4329111487 1.216502e-01 1.539782e-04
# C5_1DC     0.35553176 0.3766602128 0.0774894393 5.718537e-03 6.658730e-04
# C5DC       0.28002318 0.2753974341 0.0271641411 1.724706e-01 1.381603e-02
# C8         0.80911204 0.0026085994 0.0152966736 6.909109e-03 5.315478e-03
# C5MDC      0.35888654 0.0079237973 0.0024476562 1.480755e-01 1.246999e-03
# C9         0.81980282 0.0010044295 0.0031377997 4.685110e-04 3.725806e-06
# C7DC       0.01089333 0.0110628206 0.0358895540 2.585712e-01 2.685096e-01
# C10_2      0.45326515 0.0788889847 0.1093862763 5.651516e-02 2.592826e-05
# C10_1      0.11827740 0.1028036460 0.1000139705 1.614513e-01 2.572685e-01
# C10        0.78690770 0.0171058198 0.0088364223 4.100150e-02 1.063730e-03
# C12_1      0.77726089 0.0282256432 0.0004524493 6.083098e-02 2.258398e-02
# C12        0.90448208 0.0172532543 0.0040193370 3.363093e-03 4.728766e-03
# C14_2      0.84608009 0.0016196836 0.0114813309 3.039626e-02 5.806723e-04
# C14_1      0.95009502 0.0001357217 0.0007723013 1.209570e-03 3.630803e-03
# C14        0.94613122 0.0058628666 0.0197852042 2.992434e-03 3.387685e-03
# C12DC      0.67549130 0.1261931100 0.0057061598 1.070896e-04 2.281987e-02
# C14_2OH    0.90595552 0.0629712817 0.0005628668 1.804459e-03 3.634846e-03
# C14_1OH    0.94184332 0.0076467574 0.0237911668 4.624621e-03 1.986223e-04
# C16_2      0.83313573 0.0769304884 0.0077160195 2.211883e-06 8.993434e-03
# C16_1      0.92293553 0.0417057553 0.0001854202 5.470002e-05 1.716688e-03
# C16        0.91109804 0.0212663686 0.0213237531 5.235187e-03 1.942332e-03
# C16_2OH    0.94461884 0.0174042298 0.0079547134 5.353152e-03 1.854317e-03
# C16_1OH    0.91802999 0.0092176531 0.0221867941 1.971055e-02 1.802063e-03
# C16OH      0.88580437 0.0004388531 0.0189150572 1.566103e-03 9.862664e-03
# C18_2      0.93309200 0.0313983731 0.0004957509 4.357535e-03 6.957670e-03
# C18_1      0.94144496 0.0378114408 0.0010825998 5.559366e-03 2.767202e-05
# C18        0.87236395 0.0374980804 0.0125232974 1.736342e-02 6.737236e-03
# C18_1OH    0.93331625 0.0148899406 0.0086341765 1.938535e-03 8.460865e-04
# C0_Average 0.33425974 0.0005353806 0.4296861050 3.121613e-02 2.345405e-02
var3$contrib
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# C2         1.43790450  0.158003956  7.452668333 1.901936e-01 8.620161e-02
# C3_1       0.40012071  6.527110371  0.353123380 7.250415e-02 9.972080e-03
# C3         0.19218569 10.903263464  0.304258215 3.653006e+00 8.751180e+00
# C4_1       0.25013137 10.680751330  0.127349171 1.796458e-01 3.078166e+00
# C4         1.79462748  9.050994494  1.990445602 1.717411e-01 2.481687e+00
# C3OH       0.20978983  3.075525368  0.046108063 1.564440e+01 1.870997e+00
# C5_1       0.13920637 11.682836858  1.229772948 6.758343e-01 2.464023e+00
# C5         0.11670373 14.408242903  1.974895701 7.124081e-04 4.129782e+00
# C4OH       1.47433965  0.939398170  5.770079807 1.120941e-01 4.645399e-01
# C6_1       0.68382258  2.281295850  5.772156476 3.749340e-02 2.394517e+01
# C6         3.02909452  0.434513410  0.587761138 3.614794e-01 4.020124e-01
# C5OH       0.28583066  1.546378848 22.842794225 8.200061e+00 1.195490e-02
# C5_1DC     1.57058172  7.549863754  4.088772771 3.854687e-01 5.169854e-02
# C5DC       1.23701829  5.520129377  1.433330806 1.162570e+01 1.072680e+00
# C8         3.57429830  0.052287365  0.807137376 4.657214e-01 4.126950e-01
# C5MDC      1.58540163  0.158826412  0.129151920 9.981307e+00 9.681730e-02
# C9         3.62152542  0.020133016  0.165567721 3.158086e-02 2.892724e-04
# C7DC       0.04812189  0.221745714  1.893732004 1.742948e+01 2.084715e+01
# C10_2      2.00232449  1.581268915  5.771826872 3.809510e+00 2.013076e-03
# C10_1      0.52249714  2.060619875  5.277292012 1.088292e+01 1.997439e+01
# C10        3.47620938  0.342872979  0.466258671 2.763783e+00 8.258824e-02
# C12_1      3.43359404  0.565761271  0.023873735 4.100426e+00 1.753426e+00
# C12        3.99560087  0.345828190  0.212082519 2.266956e-01 3.671426e-01
# C14_2      3.73760677  0.032465310  0.605818722 2.048917e+00 4.508354e-02
# C14_1      4.19709861  0.002720436  0.040750900 8.153332e-02 2.818964e-01
# C14        4.17958830  0.117516643  1.043977154 2.017106e-01 2.630207e-01
# C12DC      2.98402111  2.529443659  0.301088651 7.218573e-03 1.771740e+00
# C14_2OH    4.00210986  1.262210824  0.029699976 1.216330e-01 2.822103e-01
# C14_1OH    4.16064627  0.153273361  1.255353967 3.117312e-01 1.542108e-02
# C16_2      3.68042431  1.542012366  0.407140003 1.490961e-04 6.982524e-01
# C16_1      4.07712005  0.835959732  0.009783798 3.687157e-03 1.332841e-01
# C16        4.02482724  0.426267974  1.125159531 3.528876e-01 1.508031e-01
# C16_2OH    4.17290729  0.348854376  0.419734817 3.608392e-01 1.439696e-01
# C16_1OH    4.05544953  0.184760754  1.170698361 1.328627e+00 1.399126e-01
# C16OH      3.91309103  0.008796472  0.998063368 1.055661e-01 7.657396e-01
# C18_2      4.12198682  0.629356197  0.026158571 2.937278e-01 5.401952e-01
# C18_1      4.15888651  0.757901197  0.057123972 3.747395e-01 2.148463e-03
# C18        3.85371723  0.751620130  0.660798658 1.170414e+00 5.230806e-01
# C18_1OH    4.12297745  0.298457387  0.455587061 1.306706e-01 6.569036e-02
# C0_Average 1.47661137  0.010731292 22.672623026 2.104181e+00 1.820978e+00
#### graph of variables default plot ####
fviz_pca_var(carn_pca_FM, col.var = "black")
# plot aka variable correlation plot
# positively correlated: variables grouped together 
# negatively correlated: variables positioned on opposite sides of the origin (opposed quadrants)
# distance between variables and the origin measures the quality of the variables on the factor map. 
# variables that are away from the origin are well represented on the factor map
fviz_pca_var(carn_pca_FM, col.var = "black", axes = c(2,3))
fviz_pca_var(carn_pca_FM, col.var = "black", axes = c(3,4))
fviz_pca_var(carn_pca_FM, col.var = "black", axes = c(4,5))

fviz_pca_var(carn_pca_FM, col.var = "black", axes = c(1,3))

#### Quality of representation ####
#### Contributions of variables to PCs ####

# contributions of variables in a given principal component are expressed in percentage.
# Variables that are correlated with PC1 and PC2 are the most important in explaining the variability in the data set.
# Variables that do not correlate with any PC or correlate with the last dimensions are variables with 
# low contribution and might be removed to simplify the overall analysis.

head(var3$contrib) # contributions of variables to the PCs
# The larger the value of the contribution, the more the variable contributes to the component.
# visualize cos2 as bar graph
fviz_cos2(carn_pca_FM, choice = "var", axes = 1:2)

# Color by cos2 values: quality on the factor map
fviz_pca_var(carn_pca_FM, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

# Color by cos2 values: quality on the factor map
fviz_pca_var(carn_pca_FM, col.var = "cos2", axes = 2:3,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

variables_PCA<- fviz_pca_var(carn_pca_FM, col.var = "cos2",
                             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                             repel = TRUE # Avoid text overlapping
)

# Adjust transparancy by cos2 values: quality on the factor map
fviz_pca_var(carn_pca_FM, alpha.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

#### Color by a custom continuous variable ####
# Age

fviz_pca_ind(carn_pca_FM, col.ind = AA_data.frame$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

fviz_pca_var(carn_pca_FM, col.var = AA_data.frame$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

indyear1_2<- fviz_pca_ind(AA_pca_FM, col.ind = AA_data.frame$Spine.Age,
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Age") 
ggsave("indyear1_2.pdf")

fviz_pca_ind(AA_pca_FM, col.ind = AA_data.frame$Year, axes = c(2,3),
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Year")  
indyear2_3<- fviz_pca_ind(AA_pca_FM, col.ind = DM_data.frame$Year, axes = c(2,3),
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Year") 
ggsave("indyear2_3.pdf")

#### phospholipids correlation analysis ####


# Load the car package
library(car)
# Example data: three dependent variables (Y1, Y2, Y3), one independent variable (X), and one covariate (C)
set.seed(123)
Y1 <- rnorm(100)
Y2 <- rnorm(100)
Y3 <- rnorm(100)
X <- factor(rep(1:2, each = 50))
C <- rnorm(100)

#### load phospholipid data ####
Phosphatidylcholines <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Phosphatidylcholines.csv", quote="")
  View(Phosphatidylcholines)
dim(Phosphatidylcholines)
head(Phosphatidylcholines)
names(Phosphatidylcholines)
# [1] "ID"              "Site"            "TL"             
# [4] "FL"              "W"               "K"              
# [7] "Sex"             "Scale.Age"       "Spine.Age"      
# [10] "x14_1SMOH"       "x16_1SM"         "x16_0SM"        
# [13] "x16_1SMOH"       "x18_1SM"         "PC32_2AA"       
# [16] "x18_0SM"         "x20_2SM"         "PC36_0AE"       
# [19] "PC36_6AA"        "PC36_0AA"        "x22_2SMOH"      
# [22] "x22_1SMOH"       "PC38_6AA"        "PC38_0AA"       
# [25] "PC40_6AE"        "x24_1SMOH"       "PC40_6AA"       
# [28] "PC40_2AA"        "PC401AA"         "Choline_Average"
Phospha<- Phosphatidylcholines[1:54,]
dim(Phospha)
PTC <- Phosphatidylcholines[1:54,10:30]
dim(PTC)
#### Perform MANCOVA ####
manova_result3 <- manova(cbind(Phospha$x14_1SMOH, Phospha$x16_1SM,Phospha$x16_0SM,        
                               Phospha$x16_1SMOH, Phospha$x18_1SM, Phospha$PC32_2AA,       
                               Phospha$x18_0SM, Phospha$x20_2SM, Phospha$PC36_0AE,       
                               Phospha$PC36_6AA, Phospha$PC36_0AA, Phospha$x22_2SMOH,     
                               Phospha$x22_1SMOH, Phospha$PC38_6AA, Phospha$PC38_0AA,       
                               Phospha$PC40_6AE, Phospha$x24_1SMOH, Phospha$PC40_6AA,       
                               Phospha$PC40_2AA, Phospha$PC401AA, 
                               Phospha$Choline_Average) 
                         ~ Phospha$Spine.Age + Phospha$Site)
# Summarize MANOVA results
summary(manova_result3)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Phosphatidylcholines$Spine.Age  1 0.78549   5.0568     21     29 3.984e-05 ***
#   Phosphatidylcholines$Site       3 1.92453   2.6416     63     93 1.019e-05 ***
#   Residuals                      49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# Extract coefficients
coefficients3 <- coef(manova_result3)
coefficients3
# [,1]        [,2]       [,3]       [,4]        [,5]      [,6]
# (Intercept)                         5.4837320 12.35677323 11.2918985 12.4495915  2.93101182 19.657064
# Phosphatidylcholines$Spine.Age     -0.1027777 -0.04076104 -0.1393313 -0.4154313  0.06574445  1.203095
# Phosphatidylcholines$SiteMatheson  -0.1145542 -4.20741974 -3.3278453 -3.3084787 -0.55113482  2.573721
# Phosphatidylcholines$SiteRed River -0.9239314 -5.88848468 -4.6434063 -3.8686466 -0.65041557  8.936929
# Phosphatidylcholines$SiteSandy Bar -0.7972585 -6.05906632 -4.9342340 -3.4732607 -0.46747482 11.258468
# [,7]        [,8]       [,9]       [,10]      [,11]      [,12]
# (Intercept)                        7.3994572  7.04966392 22.2075396  96.2826203 181.461143 15.1199485
# Phosphatidylcholines$Spine.Age     0.6061731  0.28428464 -0.4138631  -0.8892074  -5.439511 -0.4258161
# Phosphatidylcholines$SiteMatheson  0.1238613 -0.01928312 -6.8497899 -11.2735886 -67.442943 -3.0675887
# Phosphatidylcholines$SiteRed River 1.8799661  0.39688914 -6.9056914  -6.5633696 -70.528485 -4.3389286
# Phosphatidylcholines$SiteSandy Bar 3.6214668  0.05566067 -7.6388634  -9.2829486 -76.236547 -4.7498746
# [,13]       [,14]      [,15]     [,16]       [,17]      [,18]
# (Intercept)                         5.92141108 762.9657963  88.174284 81.300762 11.18775566  75.833360
# Phosphatidylcholines$Spine.Age     -0.08376491   0.1664258  -1.676043 -0.569254 -0.03926668   7.547012
# Phosphatidylcholines$SiteMatheson  -1.00924048 -86.4044130 -21.394855 -4.481130  0.56235558 -11.232418
# Phosphatidylcholines$SiteRed River -1.24924563 -85.6682760 -27.725050 -9.039347  0.92071338 -20.825211
# Phosphatidylcholines$SiteSandy Bar -1.72374503 -19.2165908 -28.657366 -5.111246  0.20537778 -23.951459
# [,19]       [,20]     [,21]
# (Intercept)                         3.067508559  2.55299741 20.619449
# Phosphatidylcholines$Spine.Age     -0.023131878  0.01628672  2.558771
# Phosphatidylcholines$SiteMatheson   0.007555546  0.12238702  7.314051
# Phosphatidylcholines$SiteRed River -0.181644658  0.11671582 17.707766
# Phosphatidylcholines$SiteSandy Bar -0.276429374 -0.21018669 32.926243
# Extract coefficients for the ith dependent variable
coeffs3 <- coefficients3[, i]

# Plot the relationship
ggplot(data = data.frame(X, Y = coeffs3[1] + coeffs3[2] * as.numeric(X) 
                         + coeffs[3] * C),
       aes(x = as.numeric(X), y = Y)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "X", y = paste0("Y", i)) +
  ggtitle(paste0("Effect of X on Y", i))


# trying to plot
# Load necessary packages
library(tidyr)
library(dplyr)

# Reshape your data to long format
PC18_long <- Phospha %>%
  pivot_longer(cols = c(x14_1SMOH,x16_1SM,x16_0SM,       
                        x16_1SMOH,x18_1SM,PC32_2AA,      
                        x18_0SM,x20_2SM,PC36_0AE,      
                        PC36_6AA,PC36_0AA,x22_2SMOH,     
                        x22_1SMOH,PC38_6AA,PC38_0AA,      
                        PC40_6AE,x24_1SMOH,PC40_6AA,      
                        PC40_2AA,PC401AA,Choline_Average),
               names_to = "Phosphatidylcholines",
               values_to = "Concentration")


# trying to plot
# Load necessary packages
library(tidyr)
library(dplyr)

# Reshape your data to long format
Amino_Acids18_long <- Amino_Acids18 %>%
  pivot_longer(cols = c(Serine, Asparagine, Glutamine, Tryptophan, Lysine, Arginine_Average,
                        Glutamate_Average, Glycine_Average, Histidine_Average, Isoleucine_Average,
                        Leucine, Methionine, Phenylalanine_Average, Proline, Threonine_Average,
                        Tyrosine_Average, Alanine, Aspartate),
               names_to = "Amino_Acid",
               values_to = "Concentration")
# Plot using ggplot2
library(ggplot2)

ggplot(data = PC18_long, aes(x = Spine.Age, y = Concentration, color = Site)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~"Phosphatidylcholines", scales = "free_y") +
  labs(title = "Relationship between Spine Age, Site, and Choline Metabolite Concentration")

library(ggplot2)
library(tidyr)

# Assuming Amino_Acids18 is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets
ggplot(PC18_long, aes(x = Spine.Age, y = Concentration)) +
  geom_bar(stat = "identity") +
  facet_wrap(~ Phosphocholines, scales = "free") +
  theme_minimal() +
  labs(x = "Phosphocholines/Sphingomyelins", y = "Concentration")

library(ggplot2)
library(tidyr)

# Assuming Amino_Acids18_long is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets
ggplot(PC18_long, aes(x = Spine.Age, y = Concentration)) +
  geom_point() +  # Change to the appropriate geom for your data
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "Age", y = "Concentration")

library(ggplot2)
library(tidyr)

# Assuming Amino_Acids18_long is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets and color by location
ggplot(PC18_long, aes(x = Spine.Age, y = Concentration, color = Site)) +
  geom_point() +  # Change to the appropriate geom for your data
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "Age", y = "Concentration", color = "Location")

library(ggplot2)
library(tidyr)

# Assuming Amino_Acids18_long is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets, color by location, and regression lines
PC18PLOT <-ggplot(PC18_long, aes(x = Spine.Age, y = Concentration, color = Site)) +
  geom_point() +  # Change to the appropriate geom for your data
  geom_smooth(method = "lm", se = FALSE, aes(group = Site)) +  # Add regression lines
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "Age", y = "Concentration", color = "Site")
ggsave("PC18PLOT.pdf")
ggsave("PC18PLOT.png")

#### PCA ####      
#### load packages ####

library(tidyverse)
library(corrplot)
library(FactoMineR)
library(factoextra)
library(sjstats)
library(performance)
library(forestmodel)
library(emmeans)
library(pwr)
# as data.frame
PC18_data.frame <- data.frame(PTC)
names(PC18_data.frame)
dim(PC18_data.frame)
# 54 21

# dataframe with just met data columns
PC_data_pca <- PC18_data.frame %>%
  print()

dim(PC_data_pca) 
#60 21
#### Correlations plot ####

PC_cor <- cor(PC_data_pca)

# summary(PC_cor)
# x14_1SMOH           x16_1SM           x16_0SM          x16_1SMOH           x18_1SM      
# Min.   :-0.02821   Min.   :-0.2374   Min.   :-0.2564   Min.   :-0.26024   Min.   :0.2225  
# 1st Qu.: 0.43118   1st Qu.: 0.3419   1st Qu.: 0.3185   1st Qu.: 0.06417   1st Qu.:0.4772  
# Median : 0.64722   Median : 0.4924   Median : 0.5139   Median : 0.41364   Median :0.6466  
# Mean   : 0.57109   Mean   : 0.4953   Mean   : 0.5087   Mean   : 0.39529   Mean   :0.5860  
# 3rd Qu.: 0.75354   3rd Qu.: 0.7753   3rd Qu.: 0.7944   3rd Qu.: 0.72001   3rd Qu.:0.6889  
# Max.   : 1.00000   Max.   : 1.0000   Max.   : 1.0000   Max.   : 1.00000   Max.   :1.0000  
# PC32_2AA           x18_0SM            x20_2SM            PC36_0AE          PC36_6AA     
# Min.   :-0.19180   Min.   :-0.16756   Min.   :-0.01752   Min.   :-0.1639   Min.   :0.1702  
# 1st Qu.: 0.03204   1st Qu.: 0.06581   1st Qu.: 0.29942   1st Qu.: 0.3803   1st Qu.:0.5869  
# Median : 0.46180   Median : 0.47748   Median : 0.66578   Median : 0.6194   Median :0.6472  
# Mean   : 0.38087   Mean   : 0.39397   Mean   : 0.55773   Mean   : 0.5535   Mean   :0.6605  
# 3rd Qu.: 0.62346   3rd Qu.: 0.58687   3rd Qu.: 0.79799   3rd Qu.: 0.8219   3rd Qu.:0.7960  
# Max.   : 1.00000   Max.   : 1.00000   Max.   : 1.00000   Max.   : 1.0000   Max.   :1.0000  
# PC36_0AA         x22_2SMOH         x22_1SMOH           PC38_6AA         PC38_0AA       
# Min.   :-0.2715   Min.   :-0.1789   Min.   :-0.01552   Min.   :0.1866   Min.   :-0.09387  
# 1st Qu.: 0.1599   1st Qu.: 0.4523   1st Qu.: 0.62032   1st Qu.:0.5720   1st Qu.: 0.59868  
# Median : 0.4403   Median : 0.6739   Median : 0.73279   Median :0.6647   Median : 0.77411  
# Mean   : 0.4228   Mean   : 0.5764   Mean   : 0.67731   Mean   :0.6541   Mean   : 0.65483  
# 3rd Qu.: 0.7377   3rd Qu.: 0.8430   3rd Qu.: 0.82133   3rd Qu.:0.7589   3rd Qu.: 0.80415  
# Max.   : 1.0000   Max.   : 1.0000   Max.   : 1.00000   Max.   :1.0000   Max.   : 1.00000  
# PC40_6AE        x24_1SMOH         PC40_6AA          PC40_2AA          PC401AA       
# Min.   :0.1820   Min.   :0.2011   Min.   :-0.1342   Min.   :0.08242   Min.   :0.06417  
# 1st Qu.:0.5305   1st Qu.:0.3803   1st Qu.: 0.2188   1st Qu.:0.49240   1st Qu.:0.38400  
# Median :0.6871   Median :0.5534   Median : 0.5097   Median :0.66578   Median :0.60305  
# Mean   :0.6662   Mean   :0.5521   Mean   : 0.4612   Mean   :0.63221   Mean   :0.58240  
# 3rd Qu.:0.8213   3rd Qu.:0.7247   3rd Qu.: 0.6963   3rd Qu.:0.81303   3rd Qu.:0.76328  
# Max.   :1.0000   Max.   :1.0000   Max.   : 1.0000   Max.   :1.00000   Max.   :1.00000  
# Choline_Average  
# Min.   :-0.2715  
# 1st Qu.:-0.1639  
# Median : 0.1702  
# Mean   : 0.1211  
# 3rd Qu.: 0.2833  
# Max.   : 1.0000   
Phoscorplot<- corrplot(PC_cor, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 60, 
         tl.cex = 1, cl.cex = 1)
ggsave("Phoscorplot.pdf")
ggsave("Phoscorplot.png")
dev.off()


#### PCA ####

# PCA with FactoMineR package

PC_pca_FM <- PCA(PC_data_pca, graph = FALSE)


#### Eigenvalues / Variances ####

# extract eigenvalues/varianes
get_eig(PC_pca_FM)
corrplot(PC_cor, type = "upper", order = "hclust", 
         +          tl.col = "black", tl.srt = 60, 
         +          tl.cex = 1, cl.cex = 1)
PC_pca_FM <- PCA(PC_data_pca, graph = FALSE)
# extract eigenvalues/varianes
get_eig(PC_pca_FM)
# eigenvalue variance.percent cumulative.variance.percent
# Dim.1  11.834600261      56.35523934                    56.35524
# Dim.2   4.953314535      23.58721207                    79.94245
# Dim.3   0.917724297       4.37011570                    84.31257
# Dim.4   0.829004864       3.94764221                    88.26021
# Dim.5   0.648498030       3.08808586                    91.34830
# Dim.6   0.481235641       2.29159829                    93.63989
# Dim.7   0.313536480       1.49303086                    95.13292
# Dim.8   0.267859835       1.27552302                    96.40845
# Dim.9   0.172115848       0.81959927                    97.22805
# Dim.10  0.152244578       0.72497418                    97.95302
# Dim.11  0.121370608       0.57795527                    98.53098
# Dim.12  0.076112573       0.36244082                    98.89342
# Dim.13  0.055434190       0.26397233                    99.15739
# Dim.14  0.045478911       0.21656625                    99.37396
# Dim.15  0.040382007       0.19229527                    99.56625
# Dim.16  0.026976523       0.12845963                    99.69471
# Dim.17  0.022830143       0.10871497                    99.80343
# Dim.18  0.015123797       0.07201808                    99.87544
# Dim.19  0.013020203       0.06200097                    99.93744
# Dim.20  0.006978134       0.03322921                    99.97067
# Dim.21  0.006158542       0.02932639                   100.00000
fviz_screeplot(PC_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = Inf
)

phos_screeplot<- fviz_screeplot(PC_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = Inf
)
ggsave("phos_screeplot.pdf")
ggsave("phos_screeplot.png")
fviz_screeplot(PC_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = 16
)

# extract the results for variables
var4 <- get_pca_var(PC_pca_FM)
var4
# Principal Component Analysis Results for variables
#   Name       Description                                    
# 1 "$coord"   "Coordinates for the variables"                
# 2 "$cor"     "Correlations between variables and dimensions"
# 3 "$cos2"    "Cos2 for the variables"                       
# 4 "$contrib" "contributions of the variables"
#### graph of variables default plot ####
var4$coord #  "Coordinates for the variables" 
# Dim.1      Dim.2         Dim.3        Dim.4        Dim.5
# x14_1SMOH       0.80480192 -0.2773314 -0.2247628019  0.224439133  0.191277426
# x16_1SM         0.71012983 -0.5375898  0.1126643933 -0.156664923  0.339808226
# x16_0SM         0.72931266 -0.5627289  0.1253872123 -0.139302207  0.268793506
# x16_1SMOH       0.57211852 -0.7034312  0.2052793167  0.230029953 -0.142350417
# x18_1SM         0.78067799  0.3293272  0.3563923349 -0.187924973  0.147326246
# PC32_2AA        0.47338240  0.7794562  0.2031160335  0.006980527 -0.157983950
# x18_0SM         0.48657574  0.7551973  0.3006474230  0.014221677  0.005236863
# x20_2SM         0.73092541  0.6233690  0.0870793884 -0.044199777  0.061621787
# PC36_0AE        0.78536108 -0.4901975  0.1970924582  0.011624554 -0.177737543
# PC36_6AA        0.90274258  0.2096062  0.0118858387  0.071107326 -0.253371482
# PC36_0AA        0.61164484 -0.6597036  0.2525549594  0.064248227 -0.256515885
# x22_2SMOH       0.82378223 -0.4729131 -0.0466967348  0.025920917  0.125184977
# x22_1SMOH       0.94756447 -0.1776770 -0.0502597293 -0.037770869  0.107579906
# PC38_6AA        0.89279132  0.2071670 -0.0477323986  0.085892702 -0.230196383
# PC38_0AA        0.92365314 -0.2985325 -0.0005335868  0.010872492 -0.080937789
# PC40_6AE        0.91604057  0.1815660 -0.1960517971  0.090834068 -0.068501003
# x24_1SMOH       0.75080341  0.2931032 -0.3663020872  0.235142990  0.076104593
# PC40_6AA        0.60485780  0.5838661  0.0945977471 -0.364016901  0.057386558
# PC40_2AA        0.87933530  0.1183945 -0.2963979714 -0.058184385 -0.083461708
# PC401AA         0.79722939  0.3969879 -0.3099576897 -0.203271310  0.025005543
# Choline_Average 0.09375146  0.6024240  0.2348702929  0.620144528  0.289303182
var4$cor    # "Correlations between variables and dimensions"
# Dim.1      Dim.2         Dim.3        Dim.4        Dim.5
# x14_1SMOH       0.80480192 -0.2773314 -0.2247628019  0.224439133  0.191277426
# x16_1SM         0.71012983 -0.5375898  0.1126643933 -0.156664923  0.339808226
# x16_0SM         0.72931266 -0.5627289  0.1253872123 -0.139302207  0.268793506
# x16_1SMOH       0.57211852 -0.7034312  0.2052793167  0.230029953 -0.142350417
# x18_1SM         0.78067799  0.3293272  0.3563923349 -0.187924973  0.147326246
# PC32_2AA        0.47338240  0.7794562  0.2031160335  0.006980527 -0.157983950
# x18_0SM         0.48657574  0.7551973  0.3006474230  0.014221677  0.005236863
# x20_2SM         0.73092541  0.6233690  0.0870793884 -0.044199777  0.061621787
# PC36_0AE        0.78536108 -0.4901975  0.1970924582  0.011624554 -0.177737543
# PC36_6AA        0.90274258  0.2096062  0.0118858387  0.071107326 -0.253371482
# PC36_0AA        0.61164484 -0.6597036  0.2525549594  0.064248227 -0.256515885
# x22_2SMOH       0.82378223 -0.4729131 -0.0466967348  0.025920917  0.125184977
# x22_1SMOH       0.94756447 -0.1776770 -0.0502597293 -0.037770869  0.107579906
# PC38_6AA        0.89279132  0.2071670 -0.0477323986  0.085892702 -0.230196383
# PC38_0AA        0.92365314 -0.2985325 -0.0005335868  0.010872492 -0.080937789
# PC40_6AE        0.91604057  0.1815660 -0.1960517971  0.090834068 -0.068501003
# x24_1SMOH       0.75080341  0.2931032 -0.3663020872  0.235142990  0.076104593
# PC40_6AA        0.60485780  0.5838661  0.0945977471 -0.364016901  0.057386558
# PC40_2AA        0.87933530  0.1183945 -0.2963979714 -0.058184385 -0.083461708
# PC401AA         0.79722939  0.3969879 -0.3099576897 -0.203271310  0.025005543
# Choline_Average 0.09375146  0.6024240  0.2348702929  0.620144528  0.289303182
var4$cos2   # "Cos2 for the variables" 
# Dim.1      Dim.2        Dim.3        Dim.4        Dim.5
# x14_1SMOH       0.647706125 0.07691270 5.051832e-02 5.037292e-02 3.658705e-02
# x16_1SM         0.504284369 0.28900275 1.269327e-02 2.454390e-02 1.154696e-01
# x16_0SM         0.531896951 0.31666384 1.572195e-02 1.940510e-02 7.224995e-02
# x16_1SMOH       0.327319598 0.49481539 4.213960e-02 5.291378e-02 2.026364e-02
# x18_1SM         0.609458120 0.10845644 1.270155e-01 3.531580e-02 2.170502e-02
# PC32_2AA        0.224090893 0.60755204 4.125612e-02 4.872776e-05 2.495893e-02
# x18_0SM         0.236755953 0.57032295 9.038887e-02 2.022561e-04 2.742474e-05
# x20_2SM         0.534251959 0.38858892 7.582820e-03 1.953620e-03 3.797245e-03
# PC36_0AE        0.616792022 0.24029361 3.884544e-02 1.351303e-04 3.159063e-02
# PC36_6AA        0.814944163 0.04393476 1.412732e-04 5.056252e-03 6.419711e-02
# PC36_0AA        0.374109405 0.43520883 6.378401e-02 4.127835e-03 6.580040e-02
# x22_2SMOH       0.678617164 0.22364684 2.180585e-03 6.718939e-04 1.567128e-02
# x22_1SMOH       0.897878423 0.03156910 2.526040e-03 1.426639e-03 1.157344e-02
# PC38_6AA        0.797076343 0.04291816 2.278382e-03 7.377556e-03 5.299037e-02
# PC38_0AA        0.853135131 0.08912164 2.847149e-07 1.182111e-04 6.550926e-03
# PC40_6AE        0.839130317 0.03296621 3.843631e-02 8.250828e-03 4.692387e-03
# x24_1SMOH       0.563705765 0.08590947 1.341772e-01 5.529223e-02 5.791909e-03
# PC40_6AA        0.365852954 0.34089963 8.948734e-03 1.325083e-01 3.293217e-03
# PC40_2AA        0.773230566 0.01401726 8.785176e-02 3.385423e-03 6.965857e-03
# PC401AA         0.635574704 0.15759937 9.607377e-02 4.131923e-02 6.252772e-04
# Choline_Average 0.008789336 0.36291465 5.516405e-02 3.845792e-01 8.369633e-02
var4$contrib #"contributions of the variables"
# Dim.1      Dim.2        Dim.3        Dim.4        Dim.5
# x14_1SMOH       5.47298693  1.5527523 5.504738e+00  6.076312269  5.641814147
# x16_1SM         4.26110183  5.8345326 1.383124e+00  2.960645861 17.805702616
# x16_0SM         4.49442262  6.3929685 1.713146e+00  2.340770933 11.141120780
# x16_1SMOH       2.76578499  9.9895815 4.591749e+00  6.382806846  3.124703601
# x18_1SM         5.14979895  2.1895730 1.384027e+01  4.260022694  3.346968180
# PC32_2AA        1.89352312 12.2655655 4.495481e+00  0.005877862  3.848728498
# x18_0SM         2.00054035 11.5139659 9.849240e+00  0.024397454  0.004228963
# x20_2SM         4.51432196  7.8450281 8.262634e-01  0.235658487  0.585544508
# PC36_0AE        5.21176895  4.8511680 4.232800e+00  0.016300297  4.871353925
# PC36_6AA        6.88611482  0.8869769 1.539386e-02  0.609918239  9.899352779
# PC36_0AA        3.16114948  8.7862142 6.950236e+00  0.497926470 10.146584269
# x22_2SMOH       5.73417901  4.5150946 2.376079e-01  0.081048249  2.416549903
# x22_1SMOH       7.58689270  0.6373328 2.752505e-01  0.172090490  1.784652490
# PC38_6AA        6.73513533  0.8664534 2.482643e-01  0.889929190  8.171246834
# PC38_0AA        7.20882085  1.7992325 3.102401e-05  0.014259395  1.010168946
# PC40_6AE        7.09048298  0.6655384 4.188219e+00  0.995268942  0.723577749
# x24_1SMOH       4.76320072  1.7343835 1.462065e+01  6.669710648  0.893126705
# PC40_6AA        3.09138412  6.8822527 9.751005e-01 15.984020136  0.507822211
# PC40_2AA        6.53364329  0.2829875 9.572783e+00  0.408371863  1.074152341
# PC401AA         5.37047885  3.1816952 1.046870e+01  4.984195776  0.096419286
# Choline_Average 0.07426813  7.3267031 6.010962e+00 46.390467900 12.906181268

#### graph of variables default plot ####

fviz_pca_var(PC_pca_FM, col.var = "black")
phosplot1<- fviz_pca_var(PC_pca_FM, col.var = "black")

ggsave("phosplot1.png")

# plot aka variable correlation plot
# positively correlated: variables grouped together 
# negatively correlated: variables positioned on opposite sides of the origin (opposed quadrants)
# distance between variables and the origin measures the quality of the variables on the factor map. 
# variables that are away from the origin are well represented on the factor map
fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(2,3))
phosplot2<- fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(2,3))
ggsave("phosplot2.png")

fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(3,4))
phosplot3<- fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(3,4))
ggsave("phosplot3.png")
fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(4,5))
phosplot4<-fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(4,5))
ggsave("phosplot4.png")

fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(1,3))
phosplot5<-fviz_pca_var(PC_pca_FM, col.var = "black", axes = c(1,3))
ggsave("phosplot5.png")

#### Quality of representation ####
#### Contributions of variables to PCs ####

# contributions of variables in a given principal component are expressed in percentage.
# Variables that are correlated with PC1 and PC2 are the most important in explaining the variability in the data set.
# Variables that do not correlate with any PC or correlate with the last dimensions are variables with 
# low contribution and might be removed to simplify the overall analysis.

head(var4$contrib) # contributions of variables to the PCs
# The larger the value of the contribution, the more the variable contributes to the component.
# visualize cos2 as bar graph
fviz_cos2(PC_pca_FM, choice = "var", axes = 1:2)
phosbargraph<- fviz_cos2(PC_pca_FM, choice = "var", axes = 1:2)
ggsave("phosbargraoh.png")
# Color by cos2 values: quality on the factor map
fviz_pca_var(PC_pca_FM, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)
phos_var_pca_1_2<- fviz_pca_var(PC_pca_FM, col.var = "cos2",
                                gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                                repel = TRUE # Avoid text overlapping
)
ggsave("phos_var_pca_1_2.png")
# Color by cos2 values: quality on the factor map
fviz_pca_var(PC_pca_FM, col.var = "cos2", axes = 2:3,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)
phos_var_pca_2_3<- fviz_pca_var(PC_pca_FM, col.var = "cos2", axes = 2:3,
                                gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                                repel = TRUE # Avoid text overlapping
)
ggsave("phos_var_pca_2_3.png")

phos_variables_PCA<- fviz_pca_var(PC_pca_FM, col.var = "cos2",
                             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                             repel = TRUE # Avoid text overlapping
)
ggsave("phos_variables_PCA.png")
# Adjust transparancy by cos2 values: quality on the factor map
fviz_pca_var(PC_pca_FM, alpha.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)
phos_var_pva_transparency_cos2 <-fviz_pca_var(PC_pca_FM, alpha.var = "cos2",
                                              gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                                              repel = TRUE # Avoid text overlapping
)
ggsave("phos_var_pva_transparency_cos2.png")
#### Color by a custom continuous variable ####
# Age

fviz_pca_ind(PC_pca_FM, col.ind = Phospha$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

fviz_pca_var(PC_pca_FM, col.var = Phospha$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

phos_indyear1_2PC<- fviz_pca_ind(PC_pca_FM, col.ind = Phospha$Spine.Age,
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Age") 
ggsave("phos_indyear1_2PC.pdf")
indyear1_2PC


#### Correspondence analysis trying the aas ####
# normalize
PC_transformed <- decostand(PTC, "normalize")
PC.ca2 <- cca(PC_transformed)
PC.ca2
# Call: cca(X = PC_transformed)
# 
# Inertia Rank
# Total          0.0513     
# Unconstrained  0.0513   20
# Inertia is scaled Chi-square 
# 
# Eigenvalues for unconstrained axes:
#   CA1      CA2      CA3      CA4      CA5      CA6      CA7      CA8 
# 0.027014 0.011162 0.006012 0.002264 0.001925 0.001158 0.000559 0.000438 
# (Showing 8 of 20 unconstrained eigenvalues)
summary(PC.ca2)
# Call:
#   cca(X = PC_transformed) 
# 
# Partitioning of scaled Chi-square:
#   Inertia Proportion
# Total          0.0513          1
# Unconstrained  0.0513          1
# 
# Eigenvalues, and their contribution to the scaled Chi-square 
# 
# Importance of components:
#   CA1     CA2      CA3      CA4      CA5      CA6
# Eigenvalue            0.02701 0.01116 0.006012 0.002264 0.001925 0.001158
# Proportion Explained  0.52664 0.21760 0.117213 0.044145 0.037534 0.022583
# Cumulative Proportion 0.52664 0.74424 0.861451 0.905596 0.943130 0.965713
# CA7       CA8       CA9      CA10      CA11
# Eigenvalue            0.0005587 0.0004384 0.0002518 0.0001388 0.0001056
# Proportion Explained  0.0108919 0.0085467 0.0049097 0.0027055 0.0020592
# Cumulative Proportion 0.9766054 0.9851520 0.9900618 0.9927673 0.9948265
# CA12      CA13      CA14      CA15      CA16
# Eigenvalue            7.867e-05 5.391e-05 3.739e-05 3.345e-05 2.461e-05
# Proportion Explained  1.534e-03 1.051e-03 7.289e-04 6.521e-04 4.798e-04
# Cumulative Proportion 9.964e-01 9.974e-01 9.981e-01 9.988e-01 9.993e-01
# CA17      CA18      CA19      CA20
# Eigenvalue            0.0000141 1.308e-05 5.642e-06 4.525e-06
# Proportion Explained  0.0002749 2.550e-04 1.100e-04 8.822e-05
# Cumulative Proportion 0.9995468 9.998e-01 9.999e-01 1.000e+00
# 
# Scaling 2 for species and site scores
# * Species are scaled proportional to eigenvalues
# * Sites are unscaled: weighted dispersion equal on all dimensions
# 
# 
# Species scores
# 
# CA1       CA2      CA3       CA4        CA5       CA6
# x14_1SMOH        0.071664  0.102116  0.04594 -0.058191 -0.0533139 -0.144387
# x16_1SM          0.180816  0.042619 -0.09672 -0.057986 -0.0416232 -0.188483
# x16_0SM          0.196964  0.046753 -0.08915 -0.026077 -0.0416429 -0.170801
# x16_1SMOH        0.329187  0.150929  0.02101  0.060744  0.0280037 -0.112222
# x18_1SM         -0.043305  0.019154 -0.07326 -0.058457  0.1101516 -0.073078
# PC32_2AA        -0.223353  0.006765  0.04813  0.012548  0.1693643 -0.057729
# x18_0SM         -0.206078  0.032715  0.01934  0.009909  0.1592140 -0.098136
# x20_2SM         -0.167069 -0.009353 -0.05579 -0.095352  0.0697235  0.032324
# PC36_0AE         0.230446  0.061871 -0.08235  0.007316  0.0184732 -0.028655
# PC36_6AA         0.008643 -0.011048  0.04881 -0.085203  0.0777691  0.057800
# PC36_0AA         0.439339  0.092764 -0.11112  0.045048  0.0341059  0.025996
# x22_2SMOH        0.198550  0.069743 -0.02130 -0.114477 -0.0351949 -0.111241
# x22_1SMOH        0.082236  0.028574 -0.04997 -0.113790 -0.0006123 -0.072045
# PC38_6AA        -0.005068 -0.026829  0.04720  0.024825 -0.0132885  0.001120
# PC38_0AA         0.183891 -0.006933 -0.03812 -0.109784 -0.0223591 -0.008160
# PC40_6AE        -0.009046 -0.022032  0.01895 -0.087208 -0.0557341  0.009785
# x24_1SMOH       -0.056362  0.017228  0.03331 -0.116740 -0.0452422 -0.030394
# PC40_6AA        -0.217400 -0.132892 -0.19193  0.012937 -0.0060288  0.007045
# PC40_2AA        -0.014194  0.027669 -0.01373 -0.045114 -0.0207313 -0.072133
# PC401AA         -0.087566 -0.008553 -0.03433 -0.065646 -0.0187449 -0.062635
# Choline_Average -0.316220  0.439517 -0.04397  0.005437 -0.0293489  0.019041
# 
# 
# Site scores (weighted averages of species scores)
# 
# CA1      CA2       CA3       CA4      CA5      CA6
# 1  -1.91792  1.60337 -0.729933 -0.076640  0.41975  1.22801
# 2   0.18885 -0.08485  1.748834  0.838881 -0.65623  1.46757
# 3   0.58414  0.48991  1.281660 -0.873884 -0.46778  0.19983
# 4  -1.61122 -1.13141 -1.182524  0.494167  1.83332 -0.26800
# 5  -1.34631 -0.71734 -0.610394  0.127517  0.22571  0.95237
# 6  -0.99739 -0.73226  1.153497  1.172254  1.40549  0.11159
# 7  -0.92267 -1.22472  0.421006  1.333493 -0.98208 -0.08463
# 8  -1.06632 -0.97863 -0.420225 -0.484010  0.98795 -0.07247
# 9  -1.51035 -0.49480 -0.553810 -0.245591  1.70086 -0.32893
# 10 -1.30995 -0.31500 -0.970779  0.164258 -1.11704 -1.27270
# 11 -1.59326  1.17217 -0.077747  0.082742  0.36981  0.42680
# 12 -0.12026  0.77545  0.751735 -1.633412 -0.24230  1.61555
# 13  0.88959  0.47566  1.049687 -1.177828  2.30854  0.89175
# 14  1.13533  0.66997  0.657335  1.346870  0.26267 -0.63157
# 15  0.67247 -0.08026  1.487998  0.748283 -0.64968 -0.16448
# 16 -1.32515 -0.54018 -0.001314  0.773847 -0.92789  0.78418
# 17 -0.11479  1.21013  2.026822  0.054537  2.05372 -2.10568
# 18  0.17506  1.03201  1.508137  1.267813 -1.55759  1.17026
# 19  0.84516  1.15885  0.934906  1.468378  0.81315 -1.50304
# 20  0.15671  0.12957  1.723771 -0.253737 -0.81766  1.06006
# 21 -1.17284  0.37046  0.760354  0.340198  1.62958 -0.06956
# 22 -1.59736  1.26175  0.045263  0.316907 -1.39970  1.47115
# 23  0.31333 -0.48525  1.411547 -1.081391  0.74763 -0.33083
# 24 -0.73387 -0.09915  0.426342  1.601874  1.33721  0.12816
# 25  0.12234 -1.22361 -0.024280 -0.217250  0.95718  0.83984
# 26  0.44873 -0.60589 -0.084060  2.488632 -0.42041 -0.23512
# 27  0.12092 -1.38115  0.361511 -0.618581  0.72176  1.71647
# 28  0.30006  0.05597  0.181719 -1.680984 -0.30096  0.51811
# 29 -1.03245  3.79935 -1.431838  0.073276 -0.42319 -0.34492
# 30  0.03863  2.40359  0.058751 -1.360808 -1.01688 -0.28536
# 31  0.13981  0.29075  0.735506 -2.403437  0.03979 -1.13257
# 32  0.30674 -0.42675  0.863904 -1.444961 -0.75545  0.75363
# 33 -1.08130  0.04593 -1.189254 -0.583800 -0.60250 -0.47171
# 34 -0.90513 -1.26069  0.206123  0.337337 -0.01185 -0.96522
# 35 -0.07795 -0.38214  1.369374  0.608294 -1.34084 -2.53894
# 36 -0.77795 -1.87099  0.145704 -0.369521 -1.35001  0.52554
# 37 -1.03448 -0.32102 -0.928437 -0.631524 -0.03787 -2.09731
# 38  0.38375 -0.29592 -0.975838  1.927638 -1.77223 -0.75967
# 39 -0.72593 -0.62029 -0.008393 -0.654831 -1.33087 -0.76466
# 40  1.53044  0.65449 -1.163683  1.406087  0.23106  0.80772
# 41  1.00336 -0.42420 -0.348725 -0.008408 -0.02825  0.24551
# 42  1.07463 -0.32622 -0.010119  0.266037  1.11139  0.38852
# 43  0.75552 -1.04922  0.411378 -1.885496 -1.32879 -1.65193
# 44  1.08267 -0.42322 -0.372132  0.914876  0.02516  0.13150
# 45  1.29811 -0.03953  0.519168  0.378027  0.11706  0.70033
# 46  1.87279  0.54226 -0.728340  0.600780 -0.29215 -1.10361
# 47  0.50676 -0.32469  0.460439 -0.052043 -0.88815 -0.03583
# 48  0.35598 -0.57278 -1.625693  0.068056 -0.50720  0.42222
# 49  1.18120  0.70320 -0.334454  0.622360  0.19011  0.34250
# 50  0.49909 -0.70928 -0.855429 -1.064422 -0.94935  0.71138
# 51  0.53015 -0.74536 -0.864333 -0.835740 -0.06000 -1.67582
# 52  1.15817 -0.74380 -1.356282  0.013413  0.17545  1.74715
# 53  1.52727  0.39408 -2.607032 -0.506871  0.34955  0.29398
# 54  1.47034  0.16709 -1.338548 -0.520343  1.64071 -0.64285
plot(PC.ca2, display = "species")
phos_ca_species<-plot(PC.ca2, display = "species")
ggsave("phos_ca_species.png")
plot(PC.ca2, type="n")
text(PC.ca2,display="species")
points(PC.ca2,col="blue")

#### lysophospholipids analysis ####
Lysophospholipids <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Lysophospholipids.csv", quote="")
View(Lysophospholipids)
names(Lysophospholipids)
column_names <- names(Lysophospholipids)

# Print the column names
print(column_names)
Lysophospholipids$LYSOC26_1
#### Perform MANCOVA lyso ####
manova_result4 <- manova(cbind(Lysophospholipids$LYSOC14_0,
                               Lysophospholipids$LYSOC16_1, 
                               Lysophospholipids$LYSOC16_0,
                               Lysophospholipids$LYSOC17_0, 
                               Lysophospholipids$LYSOC18_2, 
                               Lysophospholipids$LYSOC18_1, 
                               Lysophospholipids$LYSOC18_0, 
                               Lysophospholipids$LYSOC20_4,
                               Lysophospholipids$LYSOC20_3,
                               Lysophospholipids$LYSOC24_0,
                               Lysophospholipids$LYSOC26_1,
                               Lysophospholipids$LYSOC26_0, 
                               Lysophospholipids$LYSOC28_1,
                               Lysophospholipids$LYSOC28_0) 
                         ~ Lysophospholipids$Spine.Age + Lysophospholipids$Site)
# Summarize MANOVA results
summary(manova_result4)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Lysophospholipids$Spine.Age  1 0.60591   3.9536     14     36 0.0004352 ***
#   Lysophospholipids$Site       3 1.10864   1.5910     42    114 0.0279532 *  
#   Residuals                   49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# Extract coefficients
coefficients4 <- coef(manova_result4)
coefficients4

# Reshape your data to long format
lyso18_long <- Lysophospholipids %>%
  pivot_longer(cols = c(LYSOC14_0,
                        LYSOC16_1, 
                        LYSOC16_0,
                        LYSOC17_0, 
                        LYSOC18_2, 
                        LYSOC18_1, 
                        LYSOC18_0, 
                        LYSOC20_4,
                        LYSOC20_3,
                        LYSOC24_0,
                        LYSOC26_1,
                        LYSOC26_0, 
                        LYSOC28_1,
                        LYSOC28_0),
               names_to = "Lysophospholipids",
               values_to = "Concentration")
# Plot using ggplot2
library(ggplot2)


# Example plot using ggplot2 with facets, color by location, and regression lines
lys18PLOT <-ggplot(lyso18_long, aes(x = Spine.Age, y = Concentration, color = Site)) +
  geom_point() +  # Change to the appropriate geom for your data
  geom_smooth(method = "lm", se = FALSE, aes(group = Site)) +  # Add regression lines
  facet_wrap(~ Lysophospholipids, scales = "free") +
  theme_minimal() +
  labs(x = "Age", y = "Concentration", color = "Site")
ggsave("lys18PLOT.pdf")
ggsave("lys18PLOT.png")

lys18PLOT


#### PCA lyso ####
dim(Lysophospholipids)
lyso18_data.frame <- data.frame(Lysophospholipids[,10:23])
names(lyso18_data.frame)
dim(lyso18_data.frame)
# 54 21

# dataframe with just met data columns
lyso_data_pca <- lyso18_data.frame %>%
  print()

dim(lyso_data_pca) 
#60 21
#### Correlations plot ####

lyso_cor <- cor(lyso_data_pca)

lyso_cor
# LYSOC14_0  LYSOC16_1  LYSOC16_0 LYSOC17_0 LYSOC18_2 LYSOC18_1 LYSOC18_0
# LYSOC14_0 1.0000000 0.83199900 0.80631287 0.8539243 0.6511887 0.6886374 0.4827952
# LYSOC16_1 0.8319990 1.00000000 0.85340667 0.8763429 0.6031389 0.5958808 0.2958889
# LYSOC16_0 0.8063129 0.85340667 1.00000000 0.8526515 0.4740136 0.5026367 0.3109810
# LYSOC17_0 0.8539243 0.87634292 0.85265146 1.0000000 0.5761475 0.5642660 0.3137862
# LYSOC18_2 0.6511887 0.60313886 0.47401365 0.5761475 1.0000000 0.9111146 0.7328276
# LYSOC18_1 0.6886374 0.59588075 0.50263670 0.5642660 0.9111146 1.0000000 0.8505661
# LYSOC18_0 0.4827952 0.29588890 0.31098098 0.3137862 0.7328276 0.8505661 1.0000000
# LYSOC20_4 0.3211490 0.27218028 0.06593617 0.1778867 0.6111966 0.5401914 0.4401687
# LYSOC20_3 0.4742875 0.20743674 0.20349122 0.4304893 0.3645590 0.3773631 0.4308913
# LYSOC24_0 0.3961212 0.17124488 0.27149075 0.4432091 0.2353449 0.2593819 0.2761937
# LYSOC26_1 0.4591675 0.24143734 0.17144091 0.4331945 0.4932677 0.4696037 0.4124363
# LYSOC26_0 0.4966495 0.25480990 0.33155135 0.5247856 0.3524790 0.3553251 0.3021140
# LYSOC28_1 0.5370578 0.29137335 0.22118310 0.5065735 0.4596140 0.4218488 0.3678261
# LYSOC28_0 0.3632407 0.08897578 0.10560702 0.3699150 0.3205842 0.2771307 0.2575217
# LYSOC20_4 LYSOC20_3  LYSOC24_0 LYSOC26_1  LYSOC26_0 LYSOC28_1  LYSOC28_0
# LYSOC14_0  0.32114902 0.4742875  0.3961212 0.4591675 0.49664948 0.5370578 0.36324072
# LYSOC16_1  0.27218028 0.2074367  0.1712449 0.2414373 0.25480990 0.2913733 0.08897578
# LYSOC16_0  0.06593617 0.2034912  0.2714908 0.1714409 0.33155135 0.2211831 0.10560702
# LYSOC17_0  0.17788665 0.4304893  0.4432091 0.4331945 0.52478564 0.5065735 0.36991502
# LYSOC18_2  0.61119660 0.3645590  0.2353449 0.4932677 0.35247895 0.4596140 0.32058421
# LYSOC18_1  0.54019142 0.3773631  0.2593819 0.4696037 0.35532511 0.4218488 0.27713067
# LYSOC18_0  0.44016874 0.4308913  0.2761937 0.4124363 0.30211396 0.3678261 0.25752173
# LYSOC20_4  1.00000000 0.1535794 -0.0575427 0.2441072 0.01166202 0.4055096 0.12209730
# LYSOC20_3  0.15357941 1.0000000  0.3812340 0.4266790 0.36543936 0.5292829 0.38967041
# LYSOC24_0 -0.05754270 0.3812340  1.0000000 0.8420170 0.92678182 0.7112483 0.89075105
# LYSOC26_1  0.24410716 0.4266790  0.8420170 1.0000000 0.85608245 0.8306397 0.89395293
# LYSOC26_0  0.01166202 0.3654394  0.9267818 0.8560825 1.00000000 0.7331524 0.90321136
# LYSOC28_1  0.40550960 0.5292829  0.7112483 0.8306397 0.73315240 1.0000000 0.81146116
# LYSOC28_0  0.12209730 0.3896704  0.8907511 0.8939529 0.90321136 0.8114612 1.00000000

 
corrplot(lyso_cor, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 60, 
         tl.cex = 1, cl.cex = 1)
lyscorplot<- corrplot(lyso_cor, type = "upper", order = "hclust", 
                      tl.col = "black", tl.srt = 60, 
                      tl.cex = 1, cl.cex = 1)

save("lyscorplot.png")
#### PCA ####
  
# PCA with FactoMineR package

lyso_pca_FM <- PCA(lyso_data_pca, graph = FALSE)


#### Eigenvalues / Variances ####

# extract eigenvalues/varianes
get_eig(lyso_pca_FM)
# eigenvalue variance.percent cumulative.variance.percent
# Dim.1  7.14889322       51.0635230                    51.06352
# Dim.2  2.77840440       19.8457457                    70.90927
# Dim.3  1.70889494       12.2063924                    83.11566
# Dim.4  0.78597547        5.6141105                    88.72977
# Dim.5  0.69595573        4.9711124                    93.70088
# Dim.6  0.23592607        1.6851862                    95.38607
# Dim.7  0.15118231        1.0798736                    96.46594
# Dim.8  0.13017787        0.9298420                    97.39579
# Dim.9  0.11075976        0.7911411                    98.18693
# Dim.10 0.07618688        0.5441920                    98.73112
# Dim.11 0.05547233        0.3962310                    99.12735
# Dim.12 0.04925216        0.3518011                    99.47915
# Dim.13 0.04319047        0.3085033                    99.78765
# Dim.14 0.02972840        0.2123457                   100.00000

fviz_screeplot(lyso_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = Inf
)

lyso_scree-plot<- fviz_screeplot(lyso_pca_FM, addlabels = TRUE, 
                                 ggtheme = theme_classic(),
                                 main = "",
                                 font.x = c(14, "bold"), font.y = c(14, "bold"),
                                 font.tickslab = 12,
                                 barfill = "#99d8c9", barcolor = "#66c2a4",
                                 font.submain = 16,
                                 ncp = Inf
)
save("lyso_scree-plot.png")
fviz_screeplot(lyso_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = 16
)
lyso_scree_plot2<- fviz_screeplot(lyso_pca_FM, addlabels = TRUE, 
                                  ggtheme = theme_classic(),
                                  main = "",
                                  font.x = c(14, "bold"), font.y = c(14, "bold"),
                                  font.tickslab = 12,
                                  barfill = "#99d8c9", barcolor = "#66c2a4",
                                  font.submain = 16,
                                  ncp = 16
)
save("lyso_scree_plot2.png")
# extract the results for variables
var5 <- get_pca_var(lyso_pca_FM)
var5
# Principal Component Analysis Results for variables
#   Name       Description                                    
# 1 "$coord"   "Coordinates for the variables"                
# 2 "$cor"     "Correlations between variables and dimensions"
# 3 "$cos2"    "Cos2 for the variables"                       
# 4 "$contrib" "contributions of the variables"
#### graph of variables default plot ####
var5$coord #

# Dim.1       Dim.2       Dim.3        Dim.4       Dim.5
# LYSOC14_0 0.8468572  0.33935160 -0.23685025  0.043887106  0.10455004
# LYSOC16_1 0.6668464  0.57029604 -0.37847133 -0.150257131  0.08803224
# LYSOC16_0 0.6297442  0.48886419 -0.53052475 -0.013131915 -0.10089706
# LYSOC17_0 0.8079102  0.28794630 -0.43900719  0.005935978  0.12659597
# LYSOC18_2 0.7753506  0.37967360  0.36101647 -0.086873548 -0.11332538
# LYSOC18_1 0.7794901  0.40329775  0.35271867  0.023622357 -0.25394375
# LYSOC18_0 0.6399814  0.24008570  0.50927166  0.251208963 -0.38307216
# LYSOC20_4 0.4021662  0.31050571  0.63918177 -0.358247237  0.38930991
# LYSOC20_3 0.5707935 -0.09987329  0.11578878  0.721242533  0.34196295
# LYSOC24_0 0.6999679 -0.62414801 -0.18850482 -0.010542943 -0.16393503
# LYSOC26_1 0.7958002 -0.50836234  0.12025422 -0.121300355 -0.03430450
# LYSOC26_0 0.7682127 -0.54172618 -0.18036153 -0.082075831 -0.15953503
# LYSOC28_1 0.7926125 -0.39299807  0.12866765 -0.083449665  0.32401905
# LYSOC28_0 0.7001532 -0.67034884  0.01517816 -0.114001903  0.00145308
var5$cor
# Dim.1       Dim.2       Dim.3        Dim.4       Dim.5
# LYSOC14_0 0.8468572  0.33935160 -0.23685025  0.043887106  0.10455004
# LYSOC16_1 0.6668464  0.57029604 -0.37847133 -0.150257131  0.08803224
# LYSOC16_0 0.6297442  0.48886419 -0.53052475 -0.013131915 -0.10089706
# LYSOC17_0 0.8079102  0.28794630 -0.43900719  0.005935978  0.12659597
# LYSOC18_2 0.7753506  0.37967360  0.36101647 -0.086873548 -0.11332538
# LYSOC18_1 0.7794901  0.40329775  0.35271867  0.023622357 -0.25394375
# LYSOC18_0 0.6399814  0.24008570  0.50927166  0.251208963 -0.38307216
# LYSOC20_4 0.4021662  0.31050571  0.63918177 -0.358247237  0.38930991
# LYSOC20_3 0.5707935 -0.09987329  0.11578878  0.721242533  0.34196295
# LYSOC24_0 0.6999679 -0.62414801 -0.18850482 -0.010542943 -0.16393503
# LYSOC26_1 0.7958002 -0.50836234  0.12025422 -0.121300355 -0.03430450
# LYSOC26_0 0.7682127 -0.54172618 -0.18036153 -0.082075831 -0.15953503
# LYSOC28_1 0.7926125 -0.39299807  0.12866765 -0.083449665  0.32401905
# LYSOC28_0 0.7001532 -0.67034884  0.01517816 -0.114001903  0.00145308
var5$cos2
# Dim.1       Dim.2        Dim.3        Dim.4        Dim.5
# LYSOC14_0 0.7171672 0.115159510 0.0560980424 1.926078e-03 1.093071e-02
# LYSOC16_1 0.4446841 0.325237578 0.1432405459 2.257721e-02 7.749676e-03
# LYSOC16_0 0.3965778 0.238988199 0.2814565065 1.724472e-04 1.018022e-02
# LYSOC17_0 0.6527189 0.082913071 0.1927273128 3.523584e-05 1.602654e-02
# LYSOC18_2 0.6011686 0.144152040 0.1303328901 7.547013e-03 1.284264e-02
# LYSOC18_1 0.6076049 0.162649078 0.1244104632 5.580157e-04 6.448743e-02
# LYSOC18_0 0.4095762 0.057641146 0.2593576281 6.310594e-02 1.467443e-01
# LYSOC20_4 0.1617376 0.096413798 0.4085533394 1.283411e-01 1.515622e-01
# LYSOC20_3 0.3258052 0.009974674 0.0134070415 5.201908e-01 1.169387e-01
# LYSOC24_0 0.4899550 0.389560737 0.0355340685 1.111536e-04 2.687469e-02
# LYSOC26_1 0.6332980 0.258432265 0.0144610781 1.471378e-02 1.176799e-03
# LYSOC26_0 0.5901507 0.293467255 0.0325302820 6.736442e-03 2.545143e-02
# LYSOC28_1 0.6282346 0.154447481 0.0165553635 6.963847e-03 1.049883e-01
# LYSOC28_0 0.4902145 0.449367571 0.0002303765 1.299643e-02 2.111440e-06
var5$contrib
# Dim.1      Dim.2       Dim.3        Dim.4        Dim.5
# LYSOC14_0 10.031863  4.1448074  3.28270868  0.245055746 1.570604e+00
# LYSOC16_1  6.220321 11.7059121  8.38205689  2.872507655 1.113530e+00
# LYSOC16_0  5.547401  8.6016348 16.47008837  0.021940530 1.462768e+00
# LYSOC17_0  9.130349  2.9841974 11.27789126  0.004483071 2.302810e+00
# LYSOC18_2  8.409254  5.1883031  7.62673510  0.960209790 1.845324e+00
# LYSOC18_1  8.499286  5.8540462  7.28017038  0.070996584 9.266024e+00
# LYSOC18_0  5.729225  2.0746132 15.17692061  8.028996585 2.108529e+01
# LYSOC20_4  2.262415  3.4701139 23.90745798 16.328891734 2.177756e+01
# LYSOC20_3  4.557422  0.3590073  0.78454451 66.184100442 1.680260e+01
# LYSOC24_0  6.853579 14.0210236  2.07935945  0.014142126 3.861552e+00
# LYSOC26_1  8.858686  9.3014633  0.84622394  1.872040129 1.690911e-01
# LYSOC26_0  8.255134 10.5624384  1.90358583  0.857080455 3.657047e+00
# LYSOC28_1  8.787858  5.5588553  0.96877597  0.886013217 1.508549e+01
# LYSOC28_0  6.857208 16.1735840  0.01348102  1.653541937 3.033871e-04

#### graph of variables default plot lyso ####

fviz_pca_var(lyso_pca_FM, col.var = "black")
lyso1<- fviz_pca_var(lyso_pca_FM, col.var = "black")
save("lyso1.png")
# plot aka variable correlation plot
# positively correlated: variables grouped together 
# negatively correlated: variables positioned on opposite sides of the origin (opposed quadrants)
# distance between variables and the origin measures the quality of the variables on the factor map. 
# variables that are away from the origin are well represented on the factor map
fviz_pca_var(lyso_pca_FM, col.var = "black", axes = c(2,3))
lyso2<- fviz_pca_var(lyso_pca_FM, col.var = "black",axes = c(2,3))
save("lyso2.png")

fviz_pca_var(lyso_pca_FM, col.var = "black", axes = c(3,4))
lyso3<- fviz_pca_var(lyso_pca_FM, col.var = "black",axes = c(3,4))
save("lyso3.png")

fviz_pca_var(lyso_pca_FM, col.var = "black", axes = c(4,5))
lyso4<- fviz_pca_var(lyso_pca_FM, col.var = "black",axes = c(4,5))
save("lyso4.png")

fviz_pca_var(lyso_pca_FM, col.var = "black", axes = c(1,3))

#### Quality of representation ####
#### Contributions of variables to PCs ####

# contributions of variables in a given principal component are expressed in percentage.
# Variables that are correlated with PC1 and PC2 are the most important in explaining the variability in the data set.
# Variables that do not correlate with any PC or correlate with the last dimensions are variables with 
# low contribution and might be removed to simplify the overall analysis.
# contributions of variables to the PCs
# The larger the value of the contribution, the more the variable contributes to the component.
# visualize cos2 as bar graph
fviz_cos2(lyso_pca_FM, choice = "var", axes = 1:2)

# Color by cos2 values: quality on the factor map
fviz_pca_var(lyso_pca_FM, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

# Color by cos2 values: quality on the factor map
fviz_pca_var(lyso_pca_FM, col.var = "cos2", axes = 2:3,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

variables5_PCA<- fviz_pca_var(lyso_pca_FM, col.var = "cos2",
                             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                             repel = TRUE # Avoid text overlapping
)
variables5_PCA
# Adjust transparancy by cos2 values: quality on the factor map
fviz_pca_var(lyso_pca_FM, alpha.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

#### Color by a custom continuous variable ####
# Age

fviz_pca_ind(lyso_pca_FM, col.ind = Phospha$Spine.Age,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Age")  

#### correlation analysis FL ####

#### Compute correlations FL ####
correlationsFL <- cor(Amino_Acids18$FL, num_amino)

# Print correlations
print(correlationsFL)
# Serine Asparagine Glutamine Tryptophan    Lysine Arginine_Average
# [1,] 0.6009596 -0.2010011 0.2919843 0.05031348 0.4947476        0.5490666
# Glutamate_Average Glycine_Average Histidine_Average Isoleucine_Average   Leucine
# [1,]         0.4020331       0.5075164        0.09505531         0.07558305 0.2867163
# Methionine Phenylalanine_Average    Proline Threonine_Average Tyrosine_Average
# [1,]  0.4448718             0.3942967 -0.1049786         0.3475866        0.3590063
# Valine_Average    Alanine  Aspartate
# [1,]     0.09183021 0.09910765 0.02349854
library(car)

#### Amino Acids Perform MANCOVA ####
manova_resultFL<- manova(cbind(Amino_Acids18$Serine, Amino_Acids18$Asparagine, 
                               Amino_Acids18$Glutamine, Amino_Acids18$Tryptophan,
                               Amino_Acids18$Lysine, Amino_Acids18$Arginine_Average,
                               Amino_Acids18$Glutamate_Average, Amino_Acids18$Glycine_Average,
                               Amino_Acids18$Histidine_Average, Amino_Acids18$Isoleucine_Average,
                               Amino_Acids18$Leucine, Amino_Acids18$Methionine,
                               Amino_Acids18$Phenylalanine_Average, Amino_Acids18$Proline,
                               Amino_Acids18$Threonine_Average, Amino_Acids18$Tyrosine_Average,
                               Amino_Acids18$Alanine, Amino_Acids18$Aspartate)  ~ Amino_Acids18$FL + Amino_Acids18$Site)
# Summarize MANOVA results
summary(manova_resultFL)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Amino_Acids18$FL    1 0.76359   5.7420     18     32 9.431e-06 ***
#   Amino_Acids18$Site  3 2.04177   4.0248     54    102 7.185e-10 ***
#   Residuals          49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1       
# Extract coefficients
coefficientsFL <- coef(manova_resultFL)
coefficientsFL
# [,1]        [,2]         [,3]         [,4]
# (Intercept)                 -43.6241934  52.4979511   3.51804929  24.75283465
# Amino_Acids18$FL              0.2862336  -0.0244573   0.04874009   0.01095957
# Amino_Acids18$SiteMatheson  -11.2847907 -31.5006787 -14.78700554 -16.25039640
# Amino_Acids18$SiteRed River  27.2777404 -39.6157104  -5.32475237 -12.65883700
# Amino_Acids18$SiteSandy Bar  11.9427174 -38.1795205 -14.35201450 -17.42921905
# [,5]        [,6]        [,7]         [,8]
# (Intercept)                 -55.6601814 -46.9533185  30.0342686  102.9881285
# Amino_Acids18$FL              0.1366509   0.1957346   0.1703018    0.8460872
# Amino_Acids18$SiteMatheson   11.5095440  13.4593751 -42.0038120 -141.3039492
# Amino_Acids18$SiteRed River  22.1089255  24.7032885 -17.1541491  -23.3735761
# Amino_Acids18$SiteSandy Bar  34.6824663  22.2148580 -35.1879230  -85.4320951
# [,9]        [,10]       [,11]        [,12]
# (Intercept)                  49.60517012  111.8914692   7.0642843  -1.02568914
# Amino_Acids18$FL              0.01468924    0.1135251   0.3214508   0.07580897
# Amino_Acids18$SiteMatheson   -6.01572435 -100.4155649 -64.3293080 -14.66091673
# Amino_Acids18$SiteRed River  -5.91740007  -98.2064625 -61.2101658  -6.06777715
# Amino_Acids18$SiteSandy Bar -22.72897378  -89.8288667 -17.4009140 -11.33122770
# [,13]         [,14]       [,15]       [,16]
# (Intercept)                  26.0222869 132.286394856  34.0703429 -12.7998695
# Amino_Acids18$FL              0.1210469  -0.001647761   0.1956744   0.2012749
# Amino_Acids18$SiteMatheson  -38.4459509 -80.370514035   2.2055339 -50.3354917
# Amino_Acids18$SiteRed River -14.6240545 -91.173115729 -20.0070204 -22.4373358
# Amino_Acids18$SiteSandy Bar -29.8251574 -83.380810845 -45.9305677 -47.5243237
# [,17]         [,18]
# (Intercept)                 229.4432636  17.815022246
# Amino_Acids18$FL              0.0982835   0.007115284
# Amino_Acids18$SiteMatheson   -9.4499077  -8.168612056
# Amino_Acids18$SiteRed River  15.9995017 -12.701520588
# Amino_Acids18$SiteSandy Bar -48.7276855 -15.038607549
# Reshape your data to long format
Amino_Acids18_long <- Amino_Acids18 %>%
pivot_longer(cols = c(Serine, Asparagine, Glutamine, Tryptophan, Lysine, Arginine_Average,
                                Glutamate_Average, Glycine_Average, Histidine_Average, Isoleucine_Average,
                                Leucine, Methionine, Phenylalanine_Average, Proline, Threonine_Average,
                                Tyrosine_Average, Alanine, Aspartate),
                       names_to = "Amino_Acid",
                       values_to = "Concentration")
        
# Plot using ggplot2
        
        
ggplot(data = Amino_Acids18_long, aes(x = FL, y = Concentration, color = Site)) +
          geom_point() +
          geom_smooth(method = "lm", se = FALSE) +
          facet_wrap(~Amino_Acid, scales = "free_y") +
          labs(title = "Relationship between Fork Length, Site, and Amino Acid Concentration")
        
        
        

#### FL Compute correlations Carnitines ####
correlationsCFL <- cor(Carnitine_book$FL, Carnitine_only)

# Print correlations
print(correlationsCFL)
#C2        C3_1         C3       C4_1         C4       C3OH
# [1,] 0.3799869 -0.06969024 -0.1331719 -0.2279919 -0.1450002 -0.1455589
# C5_1         C5       C4OH       C6_1          C6      C5OH
# [1,] -0.0530221 -0.2077195 -0.1364356 -0.3601744 -0.05203432 0.1071554
# C5_1DC       C5DC        C8    C5MDC        C9       C7DC     C10_2
# [1,] -0.1517193 0.07146401 0.1213146 0.222465 0.2195445 0.05760186 0.2874442
# C10_1       C10     C12_1       C12       C14_2     C14_1        C14
# [1,] 0.2004984 0.2764728 0.1374464 0.1040009 -0.07105483 0.1261562 0.07742114
# C12DC   C14_2OH    C14_1OH     C16_2     C16_1        C16    C16_2OH
# [1,] 0.3121473 0.2123942 0.04542568 0.2802805 0.1602683 0.04062809 0.03341544
# C16_1OH      C16OH     C18_2     C18_1        C18    C18_1OH
# [1,] -0.007551621 0.08857781 0.2000688 0.1181948 0.03008532 0.08353118
# C0_Average
# [1,]   0.376303
#### FL Perform MANCOVA ####
manova_resultCFL <- manova(cbind(Carnitine_book$C2, Carnitine_book$C3_1,
                                 Carnitine_book$C3OH, Carnitine_book$C4,
                                 Carnitine_book$C4_1, Carnitine_book$C4OH,
                                 Carnitine_book$C5, Carnitine_book$C5_1,
                                 Carnitine_book$C5_1DC, Carnitine_book$C5DC,
                                 Carnitine_book$C5MDC, Carnitine_book$C5OH,
                                 Carnitine_book$C6, Carnitine_book$C6_1,
                                 Carnitine_book$C7DC, Carnitine_book$C8,
                                 Carnitine_book$C9, Carnitine_book$C10,
                                 Carnitine_book$C10_1, Carnitine_book$C10_2,
                                 Carnitine_book$C12, Carnitine_book$C12_1,
                                 Carnitine_book$C12DC, Carnitine_book$C14,
                                 Carnitine_book$C14_1, Carnitine_book$C14_1OH,
                                 Carnitine_book$C14_2, Carnitine_book$C14_2OH,
                                 Carnitine_book$C16, Carnitine_book$C16_1,
                                 Carnitine_book$C16OH, Carnitine_book$C16_1OH,
                                 Carnitine_book$C16_2, Carnitine_book$C16_2OH,
                                 Carnitine_book$C18, Carnitine_book$C18_1,
                                 Carnitine_book$C18_1OH, Carnitine_book$C18_2) 
                           ~ Carnitine_book$FL + Carnitine_book$Site)
# Summarize MANOVA results
summary(manova_resultCFL)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Carnitine_book$FL    1 0.90854   3.1371     38     12   0.01858 *  
#   Carnitine_book$Site  3 2.66908   2.9715    114     42 6.509e-05 ***
#   Residuals           49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

# Extract coefficients
coefficientsCFL<- coef(manova_resultCFL)
coefficientsCFL
# (Intercept)                   3.11409836  6.395491e-02  2.968882e-02
# Carnitine_book$FL             0.02459665 -1.445118e-05 -6.927176e-06
# Carnitine_book$SiteMatheson   5.76355730  2.511856e-04 -2.990941e-03
# Carnitine_book$SiteRed River  1.41090129 -1.177455e-02 -2.058922e-03
# Carnitine_book$SiteSandy Bar -4.97054142 -2.400434e-02 -2.286730e-03
# [,4]          [,5]          [,6]
# (Intercept)                   0.4526491117  1.014895e-01  0.1335967710
# Carnitine_book$FL            -0.0001605573 -3.351205e-05 -0.0001076586
# Carnitine_book$SiteMatheson  -0.1746775730 -1.388520e-02  0.0094999101
# Carnitine_book$SiteRed River -0.1986733584 -3.143770e-02 -0.0340822064
# Carnitine_book$SiteSandy Bar -0.2709790491 -2.690571e-02 -0.0513074539
# [,7]          [,8]          [,9]
# (Intercept)                   0.6580953025  2.761189e-02  1.567515e-01
# Carnitine_book$FL            -0.0003184458  1.908853e-06 -3.739802e-05
# Carnitine_book$SiteMatheson  -0.3056033908 -3.343119e-03 -3.951671e-02
# Carnitine_book$SiteRed River -0.3841740187 -1.003582e-02 -4.405595e-02
# Carnitine_book$SiteSandy Bar -0.4115503506 -7.328733e-03 -4.465761e-02
# [,10]         [,11]         [,12]
# (Intercept)                   1.952118e-01  2.500649e-02  1.521940e-01
# Carnitine_book$FL             7.727344e-05  1.083277e-05  6.427841e-05
# Carnitine_book$SiteMatheson   1.484482e-02 -1.444870e-03  8.494527e-03
# Carnitine_book$SiteRed River -6.856579e-02  5.095280e-04 -1.183344e-02
# Carnitine_book$SiteSandy Bar -5.347171e-02  6.054405e-04 -1.536354e-02
# [,13]         [,14]        [,15]
# (Intercept)                   0.9106808689  0.2687023511 1.977883e-02
# Carnitine_book$FL            -0.0002226476 -0.0001272331 1.531916e-05
# Carnitine_book$SiteMatheson   0.0279755462 -0.0067728261 1.778011e-02
# Carnitine_book$SiteRed River  0.0416235745 -0.0351862327 1.624431e-02
# Carnitine_book$SiteSandy Bar -0.1190555984 -0.0138502249 1.489714e-02
# [,16]         [,17]         [,18]
# (Intercept)                   0.1877167502  1.728387e-02  1.238959e-01
# Carnitine_book$FL             0.0001008617  1.628951e-05  2.901642e-05
# Carnitine_book$SiteMatheson  -0.0171151586 -5.053064e-04 -2.046143e-03
# Carnitine_book$SiteRed River  0.0397634117  2.335600e-03  3.963376e-03
# Carnitine_book$SiteSandy Bar -0.0219427999 -2.618221e-03  6.060490e-05
# [,19]        [,20]        [,21]
# (Intercept)                   1.781624e-01 2.634177e-02  0.028931212
# Carnitine_book$FL             4.773887e-05 9.196658e-05  0.000012028
# Carnitine_book$SiteMatheson  -7.638565e-03 1.537231e-02 -0.001844393
# Carnitine_book$SiteRed River -1.858982e-02 3.283661e-02  0.006956194
# Carnitine_book$SiteSandy Bar -2.238042e-02 2.676767e-02 -0.002390558
# [,22]        [,23]         [,24]
# (Intercept)                   5.001968e-02 5.927875e-03  4.105702e-02
# Carnitine_book$FL             2.980728e-05 2.174634e-05  4.683923e-05
# Carnitine_book$SiteMatheson  -7.738961e-03 7.609211e-04 -1.548882e-02
# Carnitine_book$SiteRed River -9.756326e-03 6.635000e-03  1.114867e-02
# Carnitine_book$SiteSandy Bar -1.602270e-02 3.813674e-03 -1.623123e-02
# [,25]         [,26]         [,27]
# (Intercept)                   6.823689e-02  3.389946e-02  2.087134e-02
# Carnitine_book$FL             8.449364e-05  1.401459e-05 -6.876409e-06
# Carnitine_book$SiteMatheson  -2.226726e-02 -8.990083e-03 -1.239287e-03
# Carnitine_book$SiteRed River  3.258419e-03  8.283134e-03  2.491862e-03
# Carnitine_book$SiteSandy Bar -3.063624e-02 -7.567630e-03 -1.793038e-03
# [,28]        [,29]        [,30]
# (Intercept)                  4.980083e-03 0.1106775124  0.041090337
# Carnitine_book$FL            3.380027e-05 0.0000233096  0.000192383
# Carnitine_book$SiteMatheson  4.423376e-04 0.0059825625 -0.012261464
# Carnitine_book$SiteRed River 1.076989e-02 0.0470165247  0.094909041
# Carnitine_book$SiteSandy Bar 3.923300e-03 0.0080758323  0.008123951
# [,31]         [,32]         [,33]
# (Intercept)                   9.845719e-03  0.0465083241  5.132890e-03
# Carnitine_book$FL             6.181926e-06 -0.0000100231  1.893311e-05
# Carnitine_book$SiteMatheson  -1.497749e-03 -0.0034019027 -8.127214e-04
# Carnitine_book$SiteRed River  3.630007e-04  0.0112231598  5.622891e-03
# Carnitine_book$SiteSandy Bar -2.698537e-03  0.0009558367  3.823840e-05
# [,34]        [,35]        [,36]
# (Intercept)                   2.317941e-02 3.781172e-02 0.0854542712
# Carnitine_book$FL             1.794953e-06 3.688939e-06 0.0001528147
# Carnitine_book$SiteMatheson  -1.119353e-03 7.646858e-04 0.0042469262
# Carnitine_book$SiteRed River  9.176560e-03 1.769482e-02 0.1116620338
# Carnitine_book$SiteSandy Bar  9.904621e-04 1.235940e-02 0.0173821130
# [,37]         [,38]
# (Intercept)                   1.607737e-02  5.587607e-03
# Carnitine_book$FL             7.460680e-06  4.224858e-05
# Carnitine_book$SiteMatheson  -4.003315e-05 -2.503687e-03
# Carnitine_book$SiteRed River  5.185474e-03  1.328579e-02
# Carnitine_book$SiteSandy Bar -3.739445e-04 -1.876999e-03
# Reshape your data to long format
Carnitines_long <- Carnitine_book %>%
  pivot_longer(cols = c(C2, C3_1,C3OH, C4, C4_1, C4OH, C5, C5_1,
                        C5_1DC, C5DC,
                        C5MDC, C5OH,
                        C6, C6_1,
                        C7DC, C8,
                        C9, C10,
                        C10_1, C10_2,
                        C12, C12_1,
                        C12DC, C14,
                        C14_1, C14_1OH,
                        C14_2, C14_2OH,
                        C16, C16_1,
                        C16OH, C16_1OH,
                        C16_2, C16_2OH,
                        C18, C18_1,
                        C18_1OH, C18_2),
               names_to = "Carnitines",
               values_to = "Concentration")

# Plot using ggplot2


ggplot(data = Carnitines_long, aes(x = FL, y = Concentration, color = Site)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~Carnitines, scales = "free_y") +
  labs(title = "Relationship between FL, Site, and Carnitine Concentration")

#### phospholipids correlation analysis ####

#### load phospholipid and lyso data ####
Phosphatidylcholines <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Phosphatidylcholines.csv", quote="")
View(Phosphatidylcholines)
dim(Phosphatidylcholines)
head(Phosphatidylcholines)
names(Phosphatidylcholines)
# [1] "ID"              "Site"            "TL"             
# [4] "FL"              "W"               "K"              
# [7] "Sex"             "Scale.Age"       "Spine.Age"      
# [10] "x14_1SMOH"       "x16_1SM"         "x16_0SM"        
# [13] "x16_1SMOH"       "x18_1SM"         "PC32_2AA"       
# [16] "x18_0SM"         "x20_2SM"         "PC36_0AE"       
# [19] "PC36_6AA"        "PC36_0AA"        "x22_2SMOH"      
# [22] "x22_1SMOH"       "PC38_6AA"        "PC38_0AA"       
# [25] "PC40_6AE"        "x24_1SMOH"       "PC40_6AA"       
# [28] "PC40_2AA"        "PC401AA"         "Choline_Average"
Phospha<- Phosphatidylcholines[1:54,]
dim(Phospha)
PTC <- Phosphatidylcholines[1:54,10:30]
dim(PTC)
#### Perform MANCOVA ####
manova_resultPHFL <- manova(cbind(Phospha$x14_1SMOH, Phospha$x16_1SM,Phospha$x16_0SM,        
                               Phospha$x16_1SMOH, Phospha$x18_1SM, Phospha$PC32_2AA,       
                               Phospha$x18_0SM, Phospha$x20_2SM, Phospha$PC36_0AE,       
                               Phospha$PC36_6AA, Phospha$PC36_0AA, Phospha$x22_2SMOH,     
                               Phospha$x22_1SMOH, Phospha$PC38_6AA, Phospha$PC38_0AA,       
                               Phospha$PC40_6AE, Phospha$x24_1SMOH, Phospha$PC40_6AA,       
                               Phospha$PC40_2AA, Phospha$PC401AA, 
                               Phospha$Choline_Average) 
                         ~ Phospha$FL + Phospha$Site)
# Summarize MANOVA results
summary(manova_resultPHFL)
# Df  Pillai approx F num Df den Df    Pr(>F)    
# Phospha$FL    1 0.86112   8.5624     21     29 1.620e-07 ***
#   Phospha$Site  3 1.95867   2.7766     63     93 3.793e-06 ***
#   Residuals    49                                             
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# Extract coefficients
coefficientsPHFL <- coef(manova_resultPHFL)
coefficientsPHFL
# [,1]         [,2]         [,3]        [,4]
# (Intercept)            6.450334562 12.933422945 12.643404654 17.06090865
# Phospha$FL            -0.003400073 -0.001754771 -0.004695778 -0.01522362
# Phospha$SiteMatheson  -0.159717598 -4.211895580 -3.386212950 -3.44207907
# Phospha$SiteRed River -1.082136353 -5.930830508 -4.853538625 -4.43380110
# Phospha$SiteSandy Bar -0.855544958 -6.085053713 -5.013861274 -3.71931800
# [,5]        [,6]       [,7]        [,8]
# (Intercept)            2.593759836 14.40530713 4.22892485 4.769383998
# Phospha$FL             0.001584151  0.02705583 0.01473436 0.008577808
# Phospha$SiteMatheson  -0.502709264  3.52382060 0.56611034 0.132980472
# Phospha$SiteRed River -0.519557720 11.42863074 3.08005489 0.875994023
# Phospha$SiteSandy Bar -0.434365332 11.85069452 3.92764729 0.211038734
# [,9]        [,10]       [,11]      [,12]
# (Intercept)           27.33758296 108.37402971 244.4326312 19.0157292
# Phospha$FL            -0.01629311  -0.03725418  -0.2047822 -0.0138578
# Phospha$SiteMatheson  -6.94562111 -11.40516837 -69.0120615 -3.2622755
# Phospha$SiteRed River -7.41213913  -7.53867338 -77.6548529 -5.0058786
# Phospha$SiteSandy Bar -7.89195577  -9.84261400 -79.4968454 -4.9897418
# [,13]        [,14]        [,15]        [,16]
# (Intercept)            6.759643164 789.49733183 104.24919896  84.37465110
# Phospha$FL            -0.002877123  -0.05355417  -0.05610255  -0.01403972
# Phospha$SiteMatheson  -1.042543143 -84.37836868 -22.10966240  -4.88973981
# Phospha$SiteRed River -1.372861775 -82.44729386 -30.27203874 -10.15616588
# Phospha$SiteSandy Bar -1.771998334 -19.53956504 -29.61250467  -5.40021182
# [,17]      [,18]         [,19]         [,20]
# (Intercept)           10.653495374  10.172983  3.3164675570  2.3288134746
# Phospha$FL             0.000600276   0.238491 -0.0008312659  0.0006880602
# Phospha$SiteMatheson   0.482297541  -7.546436 -0.0004261414  0.1246081414
# Phospha$SiteRed River  0.764926146  -8.647021 -0.2139371192  0.1342927092
# Phospha$SiteSandy Bar  0.196530839 -19.750453 -0.2900142789 -0.1998954854
# [,21]
# (Intercept)           -0.7028417
# Phospha$FL             0.0788842
# Phospha$SiteMatheson   8.6290626
# Phospha$SiteRed River 21.9358467
# Phospha$SiteSandy Bar 34.3366150

# Reshape your data to long format
PC18_long <- Phospha %>%
  pivot_longer(cols = c(x14_1SMOH,x16_1SM,x16_0SM,       
                        x16_1SMOH,x18_1SM,PC32_2AA,      
                        x18_0SM,x20_2SM,PC36_0AE,      
                        PC36_6AA,PC36_0AA,x22_2SMOH,     
                        x22_1SMOH,PC38_6AA,PC38_0AA,      
                        PC40_6AE,x24_1SMOH,PC40_6AA,      
                        PC40_2AA,PC401AA,Choline_Average),
               names_to = "Phosphatidylcholines",
               values_to = "Concentration")


# trying to plot


ggplot(data = PC18_long, aes(x = FL, y = Concentration, color = Site)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~"Phosphatidylcholines", scales = "free_y") +
  labs(title = "Relationship between Fork Length, Site, and Choline Metabolite Concentration")


# Assuming is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets
ggplot(PC18_long, aes(x = FL, y = Concentration)) +
  geom_bar(stat = "identity") +
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "Phosphocholines/Sphingomyelins", y = "Concentration")

# Assuming Amino_Acids18_long is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets
ggplot(PC18_long, aes(x = FL, y = Concentration)) +
  geom_point() +  # Change to the appropriate geom for your data
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "FL", y = "Concentration")



# Assuming Amino_Acids18_long is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets and color by location
ggplot(PC18_long, aes(x = FL, y = Concentration, color = Site)) +
  geom_point() +  # Change to the appropriate geom for your data
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "FL", y = "Concentration", color = "Location")


# Assuming is your dataset after reshaping to long format
# Check if your dataset is indeed in long format
# If not, reshape it using pivot_longer as you've described in your code

# Example plot using ggplot2 with facets, color by location, and regression lines
PC18PLOTFL <-ggplot(PC18_long, aes(x = FL, y = Concentration, color = Site)) +
  geom_point() +  # Change to the appropriate geom for your data
  geom_smooth(method = "lm", se = FALSE, aes(group = Site)) +  # Add regression lines
  facet_wrap(~ Phosphatidylcholines, scales = "free") +
  theme_minimal() +
  labs(x = "FL", y = "Concentration", color = "Site")
ggsave("PC18PLOTFL.pdf")
ggsave("PC18PLOT.png")

#### Walleye PCR ####
#### Mike's Data ####
Walleye_PCR_17 <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Walleye_PCR_17.csv", quote="")
Walleye_PCR_18 <- read.csv("C:/Users/user/Desktop/Chapter 2 Analysis/Walleye_PCR_18.csv", quote="")

summary(Walleye_PCR_17)
#    ID            Site            Total_Length    Fork_Length   
# Min.   :  1.0   Length:67          Min.   :482.0   Min.   :452.0  
# 1st Qu.: 19.5   Class :character   1st Qu.:556.5   1st Qu.:522.5  
# Median :161.0   Mode  :character   Median :627.0   Median :594.0  
# Mean   :127.1                      Mean   :620.4   Mean   :587.8  
# 3rd Qu.:187.5                      3rd Qu.:673.5   3rd Qu.:639.0  
# Max.   :205.0                      Max.   :755.0   Max.   :713.0  
# Weight_Kg           K              Tel_Ct          Ef1_Ct     
# Min.   :1.000   Min.   :0.7413   Min.   :12.06   Min.   :18.25  
# 1st Qu.:1.700   1st Qu.:0.8797   1st Qu.:12.85   1st Qu.:18.66  
# Median :2.310   Median :0.9904   Median :13.16   Median :18.84  
# Mean   :2.506   Mean   :0.9956   Mean   :13.13   Mean   :18.81  
# 3rd Qu.:3.225   3rd Qu.:1.1018   3rd Qu.:13.44   3rd Qu.:18.94  
# Max.   :4.750   Max.   :1.3233   Max.   :13.94   Max.   :19.45  
# PanX2_Ct     EF1a_TS_Ratio    Panx2_TS_Ratio   Mean_TS_Ratio   
# Min.   :22.06   Min.   :0.5778   Min.   :0.5497   Min.   :0.5638  
# 1st Qu.:22.42   1st Qu.:0.8646   1st Qu.:0.8512   1st Qu.:0.8639  
# Median :22.58   Median :1.0674   Median :1.0682   Median :1.0442  
# Mean   :22.56   Mean   :1.1916   Mean   :1.1549   Mean   :1.1732  
# 3rd Qu.:22.70   3rd Qu.:1.3762   3rd Qu.:1.3274   3rd Qu.:1.3267  
# Max.   :23.14   Max.   :2.6925   Max.   :2.5920   Max.   :2.6169  
# CV          
# Min.   : 0.02726  
# 1st Qu.: 2.12217  
# Median : 4.23317  
# Mean   : 5.18851  
# 3rd Qu.: 7.65196  
# Max.   :18.21896  

one.way1 <- aov(Mean_TS_Ratio ~ Fork_Length, data = Walleye_PCR_17)

summary(one.way1)
#Df Sum Sq Mean Sq F value Pr(>F)
# Fork_Length  1  0.168  0.1683   0.825  0.367
# Residuals   65 13.261  0.2040 


attach(Walleye_PCR_17)
# Create a scatterplot to visualize the relationship
plot(Fork_Length, Mean_TS_Ratio, pch=16)
plot(Walleye_PCR_17$Fork_Length, Walleye_PCR_17$Mean_TS_Ratio, 
     col=as.factor (Walleye_PCR_17$Site)) 
library(ggpubr)
# Scatter plot by group
ggplot(Walleye_PCR_17, aes(x = Fork_Length, y = Mean_TS_Ratio, color = Site)) +
  geom_point() +
stat_cor(method = "pearson", label.x = 650, label.y = 2.5) +
  theme_classic()

ggplot(Walleye_PCR_17, aes(x = Fork_Length, y = Mean_TS_Ratio, color = Site)) +
  geom_point() +
  stat_cor(method = "pearson", label.x = 650, label.y = 2.5) +
  scale_color_brewer(palette = "Set1") +  # Change the color palette
  theme_classic()

ggplot(Walleye_PCR_17, aes(x = Fork_Length, y = Mean_TS_Ratio, color = Site)) +
  geom_point() +
  stat_cor(method = "pearson", label.x = 650, label.y = 2.5) +
  theme_classic() +
  theme(plot.background = element_rect(fill = "white"))  # Change the plot background to white

# Calculate the correlation coefficient
correlation_coefficient17 <- cor(Walleye_PCR_17$Fork_Length, Walleye_PCR_17$Mean_TS_Ratio)

# Create the scatterplot
ggplot(Walleye_PCR_17, aes(x = Fork_Length, y = Mean_TS_Ratio, color = Site)) +
  geom_point() +
  geom_text(x = 650, y = 2.5, label = paste("R =", round(correlation_coefficient17, 3))) +
  labs(y = "Mean T/S Ratio", x = "Fork Length (mm)",
       title = "Relationship between Mean T/S Ratio and Fork-Length Walleye 2017") +
  theme_classic()


# another code

library(ggpubr)  # Load the ggpubr package

ggplot(Walleye_PCR_17, aes(x = Fork_Length, y = Mean_TS_Ratio, color = Site)) +
  geom_point() +
  stat_cor(p.accuracy = 0.001, r.accuracy = 0.01, label.x = 630) +  # Add correlation coefficient
  labs(y = "Mean T/S Ratio", x = "Fork-Length (mm)",
       title = "Mean T/S Ratio vs. Fork_Length Walleye 2017") +
  #scale_color_brewer(palette = "Set1") +  # Change the color palette
  theme_classic()

ggplot(Walleye_PCR_17, aes(x = Fork_Length, y = Mean_TS_Ratio, color = Site)) +
  geom_point() +
  stat_cor(p.accuracy = 0.001, r.accuracy = 0.01, label.x = 630) + # Add correlation coefficient
  scale_color_brewer(palette = "Set1") +
  labs(y = "Mean T/S Ratio", x = "Fork-Length (mm)",
       title = "Mean T/S Ratio vs. Fork_Length Walleye 2017") +
  #scale_color_brewer(palette = "Set1") +  # Change the color palette
  theme_classic()


ggplot(Walleye_PCR_17, aes(x = Site, y = Mean_TS_Ratio, fill= Site)) +
  geom_bar(stat = "identity")
# Perform the correlation test
cor.test(Fork_Length, Mean_TS_Ratio)
# Pearson's product-moment correlation
# 
# data:  Fork_Length and Mean_TS_Ratio
# t = -0.90832, df = 65, p-value = 0.3671
# alternative hypothesis: true correlation is not equal to 0
# 95 percent confidence interval:
#  -0.3429415  0.1317975
# sample estimates:
#        cor 
# -0.1119555 
# Print the results
print(correlation_result)

one.way2 <- aov(Mean_TS_Ratio ~ Site, data = Walleye_PCR_17)

summary(one.way2)
# Df Sum Sq Mean Sq F value Pr(>F)
# Site         4  0.499  0.1247   0.598  0.665
# Residuals   62 12.930  0.2086  

ggplot(Walleye_PCR_17, aes(x=Site, y=Mean_TS_Ratio)) + 
  geom_boxplot()

p <- ggplot(Walleye_PCR_17, aes(x=Site, y=Mean_TS_Ratio, fill = Site)) + 
  geom_boxplot() + theme_classic()
p

#### 2018 Jen data ####
summary(Walleye_PCR_18)
# ID            Site               Sex                 Age        
# Min.   :206.0   Length:80          Length:80          Min.   : 3.000  
# 1st Qu.:237.8   Class :character   Class :character   1st Qu.: 5.000  
# Median :279.5   Mode  :character   Mode  :character   Median : 7.000  
# Mean   :274.4                                         Mean   : 7.414  
# 3rd Qu.:320.2                                         3rd Qu.: 8.750  
# Max.   :355.0                                         Max.   :15.000  
# NA's   :10      
#   Total_length    Fork_length        Weight      Condition_factor
#  Min.   :373.0   Min.   :350.0   Min.   :0.500   Min.   :0.7391  
#  1st Qu.:432.2   1st Qu.:404.5   1st Qu.:0.750   1st Qu.:0.9261  
#  Median :480.0   Median :450.0   Median :1.100   Median :1.0150  
#  Mean   :518.9   Mean   :490.9   Mean   :1.691   Mean   :1.0217  
#  3rd Qu.:617.8   3rd Qu.:592.5   3rd Qu.:2.513   3rd Qu.:1.0798  
#  Max.   :740.0   Max.   :703.0   Max.   :4.850   Max.   :1.4816  
#                                                                  
#  EF1a_TS_ratio    PanX2_TS_ratio   Mean_TS_ratio   
#  Min.   :0.6004   Min.   :0.6490   Min.   :0.6369  
#  1st Qu.:0.8670   1st Qu.:0.8606   1st Qu.:0.8836  
#  Median :1.0316   Median :1.0602   Median :1.0624  
#  Mean   :1.2103   Mean   :1.1877   Mean   :1.1990  
#  3rd Qu.:1.2933   3rd Qu.:1.3134   3rd Qu.:1.3364  
#  Max.   :9.8965   Max.   :8.6905   Max.   :9.2935  

one.way3 <- aov(Mean_TS_ratio ~ Fork_length, data = Walleye_PCR_18)

summary(one.way3)
# Df Sum Sq Mean Sq F value Pr(>F)
# Fork_length  1  0.134  0.1340   1.802  0.183
# Residuals   77  5.729  0.0744               
# 1 observation deleted due to missingness


attach(Walleye_PCR_18)
# Create a scatterplot to visualize the relationship
plot(Fork_length, Mean_TS_ratio, pch=16)
plot(Walleye_PCR_18$Fork_length, Walleye_PCR_18$Mean_TS_ratio, 
     col=as.factor (Walleye_PCR_18$Site)) 

# Scatter plot by group
ggplot(Walleye_PCR_18, aes(x = Fork_length, y = Mean_TS_ratio, color = Site)) +
  geom_point() +theme_classic()


 ggplot(Walleye_PCR_18, aes(x = Site, y = Mean_TS_ratio, fill= Site)) +
  geom_bar(stat = "identity") + theme_classic() 

# Perform the correlation test
cor.test(Fork_length, Mean_TS_ratio)
# Pearson's product-moment correlation
# 
# data:  Fork_length and Mean_TS_ratio
# t = -1.3422, df = 77, p-value = 0.1835
# alternative hypothesis: true correlation is not equal to 0
# 95 percent confidence interval:
#  -0.36026554  0.07232903
# sample estimates:
#        cor 
# -0.1511995 
print(correlation_result)

one.way4 <- aov(Mean_TS_ratio ~ Site, data = Walleye_PCR_18)

summary(one.way4)
# Df Sum Sq Mean Sq F value Pr(>F)
# Site         3  0.235 0.07845   1.046  0.377
# Residuals   75  5.627 0.07503               
# 1 observation deleted due to missingness

ggplot(Walleye_PCR_18, aes(x=Site, y=Mean_TS_ratio)) + 
  geom_boxplot()

p2 <- ggplot(Walleye_PCR_18, aes(x=Site, y=Mean_TS_ratio, fill = Site)) + 
  geom_boxplot() + theme_classic()
p2

cor.test(Age, Mean_TS_ratio)
# Pearson's product-moment correlation
# 
# data:  Age and Mean_TS_ratio
# t = -1.658, df = 67, p-value = 0.102
# alternative hypothesis: true correlation is not equal to 0
# 95 percent confidence interval:
#  -0.41566998  0.04004223
# sample estimates:
#        cor 
# -0.1985199 

# Scatter plot by group
ggplot(Walleye_PCR_18, aes(x = Age, y = Mean_TS_ratio, color = Site)) +
  geom_point() + theme_classic()
ggplot(Walleye_PCR_18, aes(x = Fork_length, y = Mean_TS_ratio, color = Site)) +
  geom_point() +
  stat_cor(p.accuracy = 0.001, r.accuracy = 0.01, label.x = 630) + # Add correlation coefficient
  scale_color_brewer(palette = "Set1") +
  labs(y = "Mean T/S Ratio", x = "Fork-Length (mm)",
       title = "Mean T/S Ratio vs. Fork Length Walleye 2018") +
  #scale_color_brewer(palette = "Set1") +  # Change the color palette
  theme_classic()

# bar plot
ggplot(Walleye_PCR_18, aes(x = Site, y = Mean_TS_ratio, fill= Site)) +
  geom_bar(stat = "identity")

ggplot(Walleye_PCR_17, aes(x=Site, y=Mean_TS_Ratio)) + 
  geom_boxplot()

p3 <- ggplot(Walleye_PCR_18, aes(x=Site, y=Mean_TS_ratio, fill = Site)) + 
  geom_boxplot() +  theme_classic()
p3

# age graph

# Scatter plot by group
ggplot(Walleye_PCR_18, aes(x = Age, y = Mean_TS_ratio, color = Site)) +
  geom_point() + theme_classic()


ggplot(Walleye_PCR_18, aes(x = Age, y = Mean_TS_ratio, color = Site)) +
  geom_point() +
  stat_cor(p.accuracy = 0.001, r.accuracy = 0.01, label.x = 10) + # Add correlation coefficient
  scale_color_brewer(palette = "Set1") +
  labs(y = "Mean T/S Ratio", x = "Age (yr)",
       title = "Mean T/S Ratio vs. Fork Length Walleye 2018") +
  #scale_color_brewer(palette = "Set1") +  # Change the color palette
  theme_classic()
library(ggpubr)
